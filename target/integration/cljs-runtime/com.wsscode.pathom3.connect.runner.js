goog.provide('com.wsscode.pathom3.connect.runner');
cljs.spec.alpha.def_impl(new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","attribute-errors","com.wsscode.pathom3.connect.runner/attribute-errors",723532527),cljs.core.list(new cljs.core.Symbol("cljs.spec.alpha","map-of","cljs.spec.alpha/map-of",153715093,null),new cljs.core.Keyword("com.wsscode.pathom3.attribute","attribute","com.wsscode.pathom3.attribute/attribute",1003469786),new cljs.core.Symbol("cljs.core","any?","cljs.core/any?",-2068111842,null)),cljs.spec.alpha.every_impl.cljs$core$IFn$_invoke$arity$4(cljs.core.list(new cljs.core.Symbol("cljs.spec.alpha","tuple","cljs.spec.alpha/tuple",-415901908,null),new cljs.core.Keyword("com.wsscode.pathom3.attribute","attribute","com.wsscode.pathom3.attribute/attribute",1003469786),new cljs.core.Symbol(null,"any?","any?",-318999933,null)),cljs.spec.alpha.tuple_impl.cljs$core$IFn$_invoke$arity$2(new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword("com.wsscode.pathom3.attribute","attribute","com.wsscode.pathom3.attribute/attribute",1003469786),new cljs.core.Symbol("cljs.core","any?","cljs.core/any?",-2068111842,null)], null),new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword("com.wsscode.pathom3.attribute","attribute","com.wsscode.pathom3.attribute/attribute",1003469786),cljs.core.any_QMARK_], null)),new cljs.core.PersistentArrayMap(null, 7, [new cljs.core.Keyword(null,"into","into",-150836029),cljs.core.PersistentArrayMap.EMPTY,new cljs.core.Keyword("cljs.spec.alpha","kind-form","cljs.spec.alpha/kind-form",-1047104697),new cljs.core.Symbol("cljs.core","map?","cljs.core/map?",-1390345523,null),new cljs.core.Keyword("cljs.spec.alpha","cpred","cljs.spec.alpha/cpred",-693471218),(function (G__83422){
return cljs.core.map_QMARK_(G__83422);
}),new cljs.core.Keyword(null,"kind","kind",-717265803),cljs.core.map_QMARK_,new cljs.core.Keyword("cljs.spec.alpha","kfn","cljs.spec.alpha/kfn",672643897),(function (i__11949__auto__,v__11950__auto__){
return cljs.core.nth.cljs$core$IFn$_invoke$arity$2(v__11950__auto__,(0));
}),new cljs.core.Keyword("cljs.spec.alpha","conform-all","cljs.spec.alpha/conform-all",45201917),true,new cljs.core.Keyword("cljs.spec.alpha","describe","cljs.spec.alpha/describe",1883026911),cljs.core.list(new cljs.core.Symbol("cljs.spec.alpha","map-of","cljs.spec.alpha/map-of",153715093,null),new cljs.core.Keyword("com.wsscode.pathom3.attribute","attribute","com.wsscode.pathom3.attribute/attribute",1003469786),new cljs.core.Symbol("cljs.core","any?","cljs.core/any?",-2068111842,null))], null),null));
cljs.spec.alpha.def_impl(new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","choose-path","com.wsscode.pathom3.connect.runner/choose-path",-251774625),new cljs.core.Symbol("cljs.core","fn?","cljs.core/fn?",71876239,null),cljs.core.fn_QMARK_);
cljs.spec.alpha.def_impl(new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","batch-error?","com.wsscode.pathom3.connect.runner/batch-error?",-244618920),new cljs.core.Symbol("cljs.core","boolean?","cljs.core/boolean?",1400713761,null),cljs.core.boolean_QMARK_);
cljs.spec.alpha.def_impl(new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","batch-hold","com.wsscode.pathom3.connect.runner/batch-hold",-364021743),cljs.core.list(new cljs.core.Symbol("cljs.spec.alpha","keys","cljs.spec.alpha/keys",1109346032,null)),cljs.spec.alpha.map_spec_impl(cljs.core.PersistentHashMap.fromArrays([new cljs.core.Keyword(null,"req-un","req-un",1074571008),new cljs.core.Keyword(null,"opt-un","opt-un",883442496),new cljs.core.Keyword(null,"gfn","gfn",791517474),new cljs.core.Keyword(null,"pred-exprs","pred-exprs",1792271395),new cljs.core.Keyword(null,"keys-pred","keys-pred",858984739),new cljs.core.Keyword(null,"opt-keys","opt-keys",1262688261),new cljs.core.Keyword(null,"req-specs","req-specs",553962313),new cljs.core.Keyword(null,"req","req",-326448303),new cljs.core.Keyword(null,"req-keys","req-keys",514319221),new cljs.core.Keyword(null,"opt-specs","opt-specs",-384905450),new cljs.core.Keyword(null,"pred-forms","pred-forms",172611832),new cljs.core.Keyword(null,"opt","opt",-794706369)],[null,null,null,new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [(function (G__83424){
return cljs.core.map_QMARK_(G__83424);
})], null),(function (G__83424){
return cljs.core.map_QMARK_(G__83424);
}),cljs.core.PersistentVector.EMPTY,cljs.core.PersistentVector.EMPTY,null,cljs.core.PersistentVector.EMPTY,cljs.core.PersistentVector.EMPTY,new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [cljs.core.list(new cljs.core.Symbol("cljs.core","fn","cljs.core/fn",-1065745098,null),new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Symbol(null,"%","%",-950237169,null)], null),cljs.core.list(new cljs.core.Symbol("cljs.core","map?","cljs.core/map?",-1390345523,null),new cljs.core.Symbol(null,"%","%",-950237169,null)))], null),null])));
cljs.spec.alpha.def_impl(new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","batch-pending*","com.wsscode.pathom3.connect.runner/batch-pending*",898520706),new cljs.core.Symbol("cljs.core","any?","cljs.core/any?",-2068111842,null),cljs.core.any_QMARK_);
cljs.spec.alpha.def_impl(new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","batch-waiting*","com.wsscode.pathom3.connect.runner/batch-waiting*",-950834195),new cljs.core.Symbol("cljs.core","any?","cljs.core/any?",-2068111842,null),cljs.core.any_QMARK_);
cljs.spec.alpha.def_impl(new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","batch-run-duration-ms","com.wsscode.pathom3.connect.runner/batch-run-duration-ms",-591544025),new cljs.core.Symbol("cljs.core","number?","cljs.core/number?",-811857295,null),cljs.core.number_QMARK_);
cljs.spec.alpha.def_impl(new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","batch-run-finish-ms","com.wsscode.pathom3.connect.runner/batch-run-finish-ms",-1912626285),new cljs.core.Symbol("cljs.core","number?","cljs.core/number?",-811857295,null),cljs.core.number_QMARK_);
cljs.spec.alpha.def_impl(new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","batch-run-start-ms","com.wsscode.pathom3.connect.runner/batch-run-start-ms",-1710202816),new cljs.core.Symbol("cljs.core","number?","cljs.core/number?",-811857295,null),cljs.core.number_QMARK_);
cljs.spec.alpha.def_impl(new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","compute-plan-run-duration-ms","com.wsscode.pathom3.connect.runner/compute-plan-run-duration-ms",-404774312),new cljs.core.Symbol("cljs.core","number?","cljs.core/number?",-811857295,null),cljs.core.number_QMARK_);
cljs.spec.alpha.def_impl(new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","compute-plan-run-start-ms","com.wsscode.pathom3.connect.runner/compute-plan-run-start-ms",1143271592),new cljs.core.Symbol("cljs.core","number?","cljs.core/number?",-811857295,null),cljs.core.number_QMARK_);
cljs.spec.alpha.def_impl(new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","compute-plan-run-finish-ms","com.wsscode.pathom3.connect.runner/compute-plan-run-finish-ms",-1603607227),new cljs.core.Symbol("cljs.core","number?","cljs.core/number?",-811857295,null),cljs.core.number_QMARK_);
cljs.spec.alpha.def_impl(new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","mutation-run-duration-ms","com.wsscode.pathom3.connect.runner/mutation-run-duration-ms",979834),new cljs.core.Symbol("cljs.core","number?","cljs.core/number?",-811857295,null),cljs.core.number_QMARK_);
cljs.spec.alpha.def_impl(new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","mutation-run-start-ms","com.wsscode.pathom3.connect.runner/mutation-run-start-ms",2017573501),new cljs.core.Symbol("cljs.core","number?","cljs.core/number?",-811857295,null),cljs.core.number_QMARK_);
cljs.spec.alpha.def_impl(new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","mutation-run-finish-ms","com.wsscode.pathom3.connect.runner/mutation-run-finish-ms",394220236),new cljs.core.Symbol("cljs.core","number?","cljs.core/number?",-811857295,null),cljs.core.number_QMARK_);
cljs.spec.alpha.def_impl(new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","env","com.wsscode.pathom3.connect.runner/env",-1421599428),new cljs.core.Symbol("cljs.core","map?","cljs.core/map?",-1390345523,null),cljs.core.map_QMARK_);
cljs.spec.alpha.def_impl(new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","graph-run-duration-ms","com.wsscode.pathom3.connect.runner/graph-run-duration-ms",-1215124488),new cljs.core.Symbol("cljs.core","number?","cljs.core/number?",-811857295,null),cljs.core.number_QMARK_);
cljs.spec.alpha.def_impl(new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","graph-run-start-ms","com.wsscode.pathom3.connect.runner/graph-run-start-ms",-954308936),new cljs.core.Symbol("cljs.core","number?","cljs.core/number?",-811857295,null),cljs.core.number_QMARK_);
cljs.spec.alpha.def_impl(new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","graph-run-finish-ms","com.wsscode.pathom3.connect.runner/graph-run-finish-ms",-1109337048),new cljs.core.Symbol("cljs.core","number?","cljs.core/number?",-811857295,null),cljs.core.number_QMARK_);
cljs.spec.alpha.def_impl(new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","map-container?","com.wsscode.pathom3.connect.runner/map-container?",905687545),new cljs.core.Symbol("cljs.core","boolean?","cljs.core/boolean?",1400713761,null),cljs.core.boolean_QMARK_);
cljs.spec.alpha.def_impl(new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","merge-attribute","com.wsscode.pathom3.connect.runner/merge-attribute",-5247203),new cljs.core.Symbol("cljs.core","fn?","cljs.core/fn?",71876239,null),cljs.core.fn_QMARK_);
cljs.spec.alpha.def_impl(new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","node-error","com.wsscode.pathom3.connect.runner/node-error",890120380),new cljs.core.Symbol("cljs.core","any?","cljs.core/any?",-2068111842,null),cljs.core.any_QMARK_);
cljs.spec.alpha.def_impl(new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","node-run-duration-ms","com.wsscode.pathom3.connect.runner/node-run-duration-ms",-1113275696),new cljs.core.Symbol("cljs.core","number?","cljs.core/number?",-811857295,null),cljs.core.number_QMARK_);
cljs.spec.alpha.def_impl(new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","node-run-start-ms","com.wsscode.pathom3.connect.runner/node-run-start-ms",-2130582528),new cljs.core.Symbol("cljs.core","number?","cljs.core/number?",-811857295,null),cljs.core.number_QMARK_);
cljs.spec.alpha.def_impl(new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","node-run-finish-ms","com.wsscode.pathom3.connect.runner/node-run-finish-ms",1292429944),new cljs.core.Symbol("cljs.core","number?","cljs.core/number?",-811857295,null),cljs.core.number_QMARK_);
cljs.spec.alpha.def_impl(new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","node-resolver-input","com.wsscode.pathom3.connect.runner/node-resolver-input",-1558799633),new cljs.core.Symbol("cljs.core","map?","cljs.core/map?",-1390345523,null),cljs.core.map_QMARK_);
cljs.spec.alpha.def_impl(new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","node-resolver-output","com.wsscode.pathom3.connect.runner/node-resolver-output",800199202),new cljs.core.Symbol("cljs.core","map?","cljs.core/map?",-1390345523,null),cljs.core.map_QMARK_);
cljs.spec.alpha.def_impl(new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","node-run-stats","com.wsscode.pathom3.connect.runner/node-run-stats",-2036346899),new cljs.core.Symbol("cljs.core","map?","cljs.core/map?",-1390345523,null),cljs.core.map_QMARK_);
cljs.spec.alpha.def_impl(new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","node-run-stats*","com.wsscode.pathom3.connect.runner/node-run-stats*",453579030),new cljs.core.Symbol("cljs.core","any?","cljs.core/any?",-2068111842,null),cljs.core.any_QMARK_);
cljs.spec.alpha.def_impl(new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","nodes-with-error","com.wsscode.pathom3.connect.runner/nodes-with-error",-1230963295),new cljs.core.Keyword("com.wsscode.pathom3.connect.planner","node-id-set","com.wsscode.pathom3.connect.planner/node-id-set",146448050),new cljs.core.Keyword("com.wsscode.pathom3.connect.planner","node-id-set","com.wsscode.pathom3.connect.planner/node-id-set",146448050));
cljs.spec.alpha.def_impl(new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","resolver-cache*","com.wsscode.pathom3.connect.runner/resolver-cache*",334664084),new cljs.core.Symbol("cljs.core","any?","cljs.core/any?",-2068111842,null),cljs.core.any_QMARK_);
cljs.spec.alpha.def_impl(new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","resolver-run-duration-ms","com.wsscode.pathom3.connect.runner/resolver-run-duration-ms",-1533273691),new cljs.core.Symbol("cljs.core","number?","cljs.core/number?",-811857295,null),cljs.core.number_QMARK_);
cljs.spec.alpha.def_impl(new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","resolver-run-start-ms","com.wsscode.pathom3.connect.runner/resolver-run-start-ms",213921287),new cljs.core.Symbol("cljs.core","number?","cljs.core/number?",-811857295,null),cljs.core.number_QMARK_);
cljs.spec.alpha.def_impl(new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","resolver-run-finish-ms","com.wsscode.pathom3.connect.runner/resolver-run-finish-ms",375193860),new cljs.core.Symbol("cljs.core","number?","cljs.core/number?",-811857295,null),cljs.core.number_QMARK_);
cljs.spec.alpha.def_impl(new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","run-stats","com.wsscode.pathom3.connect.runner/run-stats",1718909061),new cljs.core.Symbol("cljs.core","map?","cljs.core/map?",-1390345523,null),cljs.core.map_QMARK_);
cljs.spec.alpha.def_impl(new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","run-stats-omit-resolver-io?","com.wsscode.pathom3.connect.runner/run-stats-omit-resolver-io?",743939109),new cljs.core.Symbol("cljs.core","boolean?","cljs.core/boolean?",1400713761,null),cljs.core.boolean_QMARK_);
cljs.spec.alpha.def_impl(new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","source-node-id","com.wsscode.pathom3.connect.runner/source-node-id",-124882568),new cljs.core.Keyword("com.wsscode.pathom3.connect.planner","node-id","com.wsscode.pathom3.connect.planner/node-id",1696523707),new cljs.core.Keyword("com.wsscode.pathom3.connect.planner","node-id","com.wsscode.pathom3.connect.planner/node-id",1696523707));
cljs.spec.alpha.def_impl(new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","taken-paths","com.wsscode.pathom3.connect.runner/taken-paths",-1349641664),cljs.core.list(new cljs.core.Symbol("cljs.spec.alpha","coll-of","cljs.spec.alpha/coll-of",1019430407,null),new cljs.core.Keyword("com.wsscode.pathom3.connect.planner","node-id","com.wsscode.pathom3.connect.planner/node-id",1696523707),new cljs.core.Keyword(null,"kind","kind",-717265803),new cljs.core.Symbol("cljs.core","vector?","cljs.core/vector?",-1550392028,null)),cljs.spec.alpha.every_impl.cljs$core$IFn$_invoke$arity$4(new cljs.core.Keyword("com.wsscode.pathom3.connect.planner","node-id","com.wsscode.pathom3.connect.planner/node-id",1696523707),new cljs.core.Keyword("com.wsscode.pathom3.connect.planner","node-id","com.wsscode.pathom3.connect.planner/node-id",1696523707),new cljs.core.PersistentArrayMap(null, 5, [new cljs.core.Keyword("cljs.spec.alpha","kind-form","cljs.spec.alpha/kind-form",-1047104697),new cljs.core.Symbol("cljs.core","vector?","cljs.core/vector?",-1550392028,null),new cljs.core.Keyword("cljs.spec.alpha","cpred","cljs.spec.alpha/cpred",-693471218),(function (G__83437){
return cljs.core.vector_QMARK_(G__83437);
}),new cljs.core.Keyword(null,"kind","kind",-717265803),cljs.core.vector_QMARK_,new cljs.core.Keyword("cljs.spec.alpha","conform-all","cljs.spec.alpha/conform-all",45201917),true,new cljs.core.Keyword("cljs.spec.alpha","describe","cljs.spec.alpha/describe",1883026911),cljs.core.list(new cljs.core.Symbol("cljs.spec.alpha","coll-of","cljs.spec.alpha/coll-of",1019430407,null),new cljs.core.Keyword("com.wsscode.pathom3.connect.planner","node-id","com.wsscode.pathom3.connect.planner/node-id",1696523707),new cljs.core.Keyword(null,"kind","kind",-717265803),new cljs.core.Symbol("cljs.core","vector?","cljs.core/vector?",-1550392028,null))], null),null));
cljs.spec.alpha.def_impl(new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","success-path","com.wsscode.pathom3.connect.runner/success-path",1003623091),new cljs.core.Keyword("com.wsscode.pathom3.connect.planner","node-id","com.wsscode.pathom3.connect.planner/node-id",1696523707),new cljs.core.Keyword("com.wsscode.pathom3.connect.planner","node-id","com.wsscode.pathom3.connect.planner/node-id",1696523707));
cljs.spec.alpha.def_impl(new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","root-query","com.wsscode.pathom3.connect.runner/root-query",1906324752),new cljs.core.Symbol("cljs.core","vector?","cljs.core/vector?",-1550392028,null),cljs.core.vector_QMARK_);
cljs.spec.alpha.def_impl(new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","unsupported-batch?","com.wsscode.pathom3.connect.runner/unsupported-batch?",-826939500),new cljs.core.Symbol("cljs.core","boolean?","cljs.core/boolean?",1400713761,null),cljs.core.boolean_QMARK_);
cljs.spec.alpha.def_impl(new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","wrap-batch-resolver-error","com.wsscode.pathom3.connect.runner/wrap-batch-resolver-error",176601916),new cljs.core.Symbol("cljs.core","fn?","cljs.core/fn?",71876239,null),cljs.core.fn_QMARK_);
cljs.spec.alpha.def_impl(new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","wrap-merge-attribute","com.wsscode.pathom3.connect.runner/wrap-merge-attribute",-520029320),new cljs.core.Symbol("cljs.core","fn?","cljs.core/fn?",71876239,null),cljs.core.fn_QMARK_);
cljs.spec.alpha.def_impl(new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","wrap-mutate","com.wsscode.pathom3.connect.runner/wrap-mutate",-1277033248),new cljs.core.Symbol("cljs.core","fn?","cljs.core/fn?",71876239,null),cljs.core.fn_QMARK_);
cljs.spec.alpha.def_impl(new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","wrap-resolve","com.wsscode.pathom3.connect.runner/wrap-resolve",-1315168003),new cljs.core.Symbol("cljs.core","fn?","cljs.core/fn?",71876239,null),cljs.core.fn_QMARK_);
cljs.spec.alpha.def_impl(new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","wrap-resolver-error","com.wsscode.pathom3.connect.runner/wrap-resolver-error",-1230614515),new cljs.core.Symbol("cljs.core","fn?","cljs.core/fn?",71876239,null),cljs.core.fn_QMARK_);
cljs.spec.alpha.def_impl(new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","wrap-mutation-error","com.wsscode.pathom3.connect.runner/wrap-mutation-error",-1155458602),new cljs.core.Symbol("cljs.core","fn?","cljs.core/fn?",71876239,null),cljs.core.fn_QMARK_);
cljs.spec.alpha.def_impl(new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","wrap-run-graph!","com.wsscode.pathom3.connect.runner/wrap-run-graph!",-170975775),new cljs.core.Symbol("cljs.core","fn?","cljs.core/fn?",71876239,null),cljs.core.fn_QMARK_);
cljs.spec.alpha.def_impl(new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","process-run-start-ms","com.wsscode.pathom3.connect.runner/process-run-start-ms",-360009927),new cljs.core.Symbol("cljs.core","number?","cljs.core/number?",-811857295,null),cljs.core.number_QMARK_);
cljs.spec.alpha.def_impl(new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","process-run-finish-ms","com.wsscode.pathom3.connect.runner/process-run-finish-ms",-1288047429),new cljs.core.Symbol("cljs.core","number?","cljs.core/number?",-811857295,null),cljs.core.number_QMARK_);
cljs.spec.alpha.def_impl(new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","process-run-duration-ms","com.wsscode.pathom3.connect.runner/process-run-duration-ms",2453785),new cljs.core.Symbol("cljs.core","number?","cljs.core/number?",-811857295,null),cljs.core.number_QMARK_);
cljs.spec.alpha.def_impl(new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","node-run-return","com.wsscode.pathom3.connect.runner/node-run-return",-741031913),cljs.core.list(new cljs.core.Symbol("com.fulcrologic.guardrails.core","?","com.fulcrologic.guardrails.core/?",1513394117,null),cljs.core.list(new cljs.core.Symbol("cljs.spec.alpha","keys","cljs.spec.alpha/keys",1109346032,null),new cljs.core.Keyword(null,"opt","opt",-794706369),new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","batch-hold","com.wsscode.pathom3.connect.runner/batch-hold",-364021743)], null))),cljs.spec.alpha.nilable_impl(cljs.core.list(new cljs.core.Symbol("cljs.spec.alpha","keys","cljs.spec.alpha/keys",1109346032,null),new cljs.core.Keyword(null,"opt","opt",-794706369),new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","batch-hold","com.wsscode.pathom3.connect.runner/batch-hold",-364021743)], null)),cljs.spec.alpha.map_spec_impl(cljs.core.PersistentHashMap.fromArrays([new cljs.core.Keyword(null,"req-un","req-un",1074571008),new cljs.core.Keyword(null,"opt-un","opt-un",883442496),new cljs.core.Keyword(null,"gfn","gfn",791517474),new cljs.core.Keyword(null,"pred-exprs","pred-exprs",1792271395),new cljs.core.Keyword(null,"keys-pred","keys-pred",858984739),new cljs.core.Keyword(null,"opt-keys","opt-keys",1262688261),new cljs.core.Keyword(null,"req-specs","req-specs",553962313),new cljs.core.Keyword(null,"req","req",-326448303),new cljs.core.Keyword(null,"req-keys","req-keys",514319221),new cljs.core.Keyword(null,"opt-specs","opt-specs",-384905450),new cljs.core.Keyword(null,"pred-forms","pred-forms",172611832),new cljs.core.Keyword(null,"opt","opt",-794706369)],[null,null,null,new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [(function (G__83444){
return cljs.core.map_QMARK_(G__83444);
})], null),(function (G__83444){
return cljs.core.map_QMARK_(G__83444);
}),new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","batch-hold","com.wsscode.pathom3.connect.runner/batch-hold",-364021743)], null),cljs.core.PersistentVector.EMPTY,null,cljs.core.PersistentVector.EMPTY,new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","batch-hold","com.wsscode.pathom3.connect.runner/batch-hold",-364021743)], null),new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [cljs.core.list(new cljs.core.Symbol("cljs.core","fn","cljs.core/fn",-1065745098,null),new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Symbol(null,"%","%",-950237169,null)], null),cljs.core.list(new cljs.core.Symbol("cljs.core","map?","cljs.core/map?",-1390345523,null),new cljs.core.Symbol(null,"%","%",-950237169,null)))], null),new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","batch-hold","com.wsscode.pathom3.connect.runner/batch-hold",-364021743)], null)])),null));
/**
 * Check if all requirements from the node are present in the current entity.
 */
com.wsscode.pathom3.connect.runner.all_requires_ready_QMARK_ = (function com$wsscode$pathom3$connect$runner$all_requires_ready_QMARK_(env,p__83450){
var map__83451 = p__83450;
var map__83451__$1 = cljs.core.__destructure_map(map__83451);
var expects = cljs.core.get.cljs$core$IFn$_invoke$arity$2(map__83451__$1,new cljs.core.Keyword("com.wsscode.pathom3.connect.planner","expects","com.wsscode.pathom3.connect.planner/expects",2018136040));
var entity = com.wsscode.pathom3.entity_tree.entity(env);
return cljs.core.every_QMARK_((function (p1__83449_SHARP_){
return cljs.core.contains_QMARK_(entity,p1__83449_SHARP_);
}),cljs.core.keys(expects));
});


com.wsscode.pathom3.connect.runner.union_key_on_data_QMARK_ = (function com$wsscode$pathom3$connect$runner$union_key_on_data_QMARK_(p__83457,m){
var map__83458 = p__83457;
var map__83458__$1 = cljs.core.__destructure_map(map__83458);
var union_key = cljs.core.get.cljs$core$IFn$_invoke$arity$2(map__83458__$1,new cljs.core.Keyword(null,"union-key","union-key",1529707234));
return cljs.core.contains_QMARK_(m,union_key);
});
/**
 * Check if ast children is a union type. If so, makes a decision to choose a path and
 *   return that AST.
 */
com.wsscode.pathom3.connect.runner.pick_union_entry = (function com$wsscode$pathom3$connect$runner$pick_union_entry(ast,m){
if(com.wsscode.pathom3.format.eql.union_children_QMARK_(ast)){
return cljs.core.some((function (ast_SINGLEQUOTE_){
if(com.wsscode.pathom3.connect.runner.union_key_on_data_QMARK_(ast_SINGLEQUOTE_,m)){
return com.wsscode.pathom3.format.eql.union__GT_root(ast_SINGLEQUOTE_);
} else {
return null;
}
}),com.wsscode.pathom3.format.eql.union_children(ast));
} else {
return ast;
}
});
com.wsscode.pathom3.connect.runner.process_map_subquery = (function com$wsscode$pathom3$connect$runner$process_map_subquery(env,ast,m){
if(((cljs.core.map_QMARK_(m)) && (cljs.core.not(com.wsscode.pathom3.connect.operation.final_value_QMARK_(m))))){
var cache_tree_STAR_ = com.wsscode.pathom3.entity_tree.create_entity(m);
var ast__$1 = com.wsscode.pathom3.connect.runner.pick_union_entry(ast,m);
return (com.wsscode.pathom3.connect.runner.run_graph_BANG_.cljs$core$IFn$_invoke$arity$3 ? com.wsscode.pathom3.connect.runner.run_graph_BANG_.cljs$core$IFn$_invoke$arity$3(env,ast__$1,cache_tree_STAR_) : com.wsscode.pathom3.connect.runner.run_graph_BANG_.call(null,env,ast__$1,cache_tree_STAR_));
} else {
return m;
}
});
com.wsscode.pathom3.connect.runner.process_sequence_subquery = (function com$wsscode$pathom3$connect$runner$process_sequence_subquery(env,ast,s){
if(cljs.core.truth_(com.wsscode.pathom3.connect.operation.final_value_QMARK_(s))){
return s;
} else {
return cljs.core.into.cljs$core$IFn$_invoke$arity$3(cljs.core.empty(s),cljs.core.map_indexed.cljs$core$IFn$_invoke$arity$1((function (p1__83461_SHARP_,p2__83462_SHARP_){
return com.wsscode.pathom3.connect.runner.process_map_subquery(com.wsscode.pathom3.path.append_path(env,p1__83461_SHARP_),ast,p2__83462_SHARP_);
})),(function (){var G__83463 = s;
if(com.wsscode.misc.coll.coll_append_at_head_QMARK_(s)){
return cljs.core.reverse(G__83463);
} else {
return G__83463;
}
})());
}
});
/**
 * Build a new map where the values are replaced with the map process of the subquery.
 */
com.wsscode.pathom3.connect.runner.process_map_container_subquery = (function com$wsscode$pathom3$connect$runner$process_map_container_subquery(env,ast,m){
if(cljs.core.truth_(com.wsscode.pathom3.connect.operation.final_value_QMARK_(m))){
return m;
} else {
return cljs.core.into.cljs$core$IFn$_invoke$arity$3(cljs.core.PersistentArrayMap.EMPTY,cljs.core.map.cljs$core$IFn$_invoke$arity$1((function (x){
return com.wsscode.misc.coll.make_map_entry(cljs.core.key(x),com.wsscode.pathom3.connect.runner.process_map_subquery(com.wsscode.pathom3.path.append_path(env,cljs.core.key(x)),ast,cljs.core.val(x)));
})),m);
}
});
/**
 * Check if the map should be processed as a map-container, this means the sub-query
 *   should apply to the map values instead of the map itself.
 * 
 *   This can be dictated by adding the ::pcr/map-container? meta data on the value, or
 *   requested by the query as part of the param.
 */
com.wsscode.pathom3.connect.runner.process_map_container_QMARK_ = (function com$wsscode$pathom3$connect$runner$process_map_container_QMARK_(ast,v){
var or__4223__auto__ = new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","map-container?","com.wsscode.pathom3.connect.runner/map-container?",905687545).cljs$core$IFn$_invoke$arity$1(cljs.core.meta(v));
if(cljs.core.truth_(or__4223__auto__)){
return or__4223__auto__;
} else {
return new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","map-container?","com.wsscode.pathom3.connect.runner/map-container?",905687545).cljs$core$IFn$_invoke$arity$1(new cljs.core.Keyword(null,"params","params",710516235).cljs$core$IFn$_invoke$arity$1(ast));
}
});
com.wsscode.pathom3.connect.runner.normalize_ast_recursive_query = (function com$wsscode$pathom3$connect$runner$normalize_ast_recursive_query(p__83464,graph,k){
var map__83465 = p__83464;
var map__83465__$1 = cljs.core.__destructure_map(map__83465);
var ast = map__83465__$1;
var query = cljs.core.get.cljs$core$IFn$_invoke$arity$2(map__83465__$1,new cljs.core.Keyword(null,"query","query",-1288509510));
var children = ((cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(new cljs.core.Symbol(null,"...","...",-1926939749,null),query))?cljs.core.vec(cljs.core.vals(new cljs.core.Keyword("com.wsscode.pathom3.connect.planner","index-ast","com.wsscode.pathom3.connect.planner/index-ast",905845713).cljs$core$IFn$_invoke$arity$1(graph))):((cljs.core.pos_int_QMARK_(query))?cljs.core.vec(cljs.core.vals(cljs.core.update_in.cljs$core$IFn$_invoke$arity$3(new cljs.core.Keyword("com.wsscode.pathom3.connect.planner","index-ast","com.wsscode.pathom3.connect.planner/index-ast",905845713).cljs$core$IFn$_invoke$arity$1(graph),new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [k,new cljs.core.Keyword(null,"query","query",-1288509510)], null),cljs.core.dec))):new cljs.core.Keyword(null,"children","children",-940561982).cljs$core$IFn$_invoke$arity$1(ast)
));
return cljs.core.assoc.cljs$core$IFn$_invoke$arity$3(ast,new cljs.core.Keyword(null,"children","children",-940561982),children);
});
/**
 * Get AST entry and pulls recursive query when needed.
 */
com.wsscode.pathom3.connect.runner.entry_ast = (function com$wsscode$pathom3$connect$runner$entry_ast(graph,k){
return com.wsscode.pathom3.connect.runner.normalize_ast_recursive_query(com.wsscode.pathom3.connect.planner.entry_ast(graph,k),graph,k);
});
com.wsscode.pathom3.connect.runner.process_attr_subquery = (function com$wsscode$pathom3$connect$runner$process_attr_subquery(p__83466,entity,k,v){
var map__83467 = p__83466;
var map__83467__$1 = cljs.core.__destructure_map(map__83467);
var env = map__83467__$1;
var graph = cljs.core.get.cljs$core$IFn$_invoke$arity$2(map__83467__$1,new cljs.core.Keyword("com.wsscode.pathom3.connect.planner","graph","com.wsscode.pathom3.connect.planner/graph",-1915509744));
var map__83468 = com.wsscode.pathom3.connect.runner.entry_ast(graph,k);
var map__83468__$1 = cljs.core.__destructure_map(map__83468);
var ast = map__83468__$1;
var children = cljs.core.get.cljs$core$IFn$_invoke$arity$2(map__83468__$1,new cljs.core.Keyword(null,"children","children",-940561982));
var env__$1 = com.wsscode.pathom3.path.append_path(env,k);
if(cljs.core.truth_(children)){
if(cljs.core.map_QMARK_(v)){
if(cljs.core.truth_(com.wsscode.pathom3.connect.runner.process_map_container_QMARK_(ast,v))){
return com.wsscode.pathom3.connect.runner.process_map_container_subquery(env__$1,ast,v);
} else {
return com.wsscode.pathom3.connect.runner.process_map_subquery(env__$1,ast,v);
}
} else {
if(com.wsscode.misc.coll.collection_QMARK_(v)){
return com.wsscode.pathom3.connect.runner.process_sequence_subquery((function (){var G__83469 = env__$1;
if((!(cljs.core.vector_QMARK_(v)))){
return cljs.core.assoc.cljs$core$IFn$_invoke$arity$3(G__83469,new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","unsupported-batch?","com.wsscode.pathom3.connect.runner/unsupported-batch?",-826939500),true);
} else {
return G__83469;
}
})(),ast,v);
} else {
return v;

}
}
} else {
var temp__5751__auto__ = cljs.core.find(entity,k);
if(cljs.core.truth_(temp__5751__auto__)){
var x = temp__5751__auto__;
return cljs.core.val(x);
} else {
return v;
}
}
});
/**
 * Specialized merge versions that work on entity data.
 */
com.wsscode.pathom3.connect.runner.merge_entity_data = (function com$wsscode$pathom3$connect$runner$merge_entity_data(env,entity,new_data){
return cljs.core.reduce_kv((function (out,k,v){
if(com.wsscode.misc.refs.kw_identical_QMARK_(v,new cljs.core.Keyword("com.wsscode.pathom3.connect.operation","unknown-value","com.wsscode.pathom3.connect.operation/unknown-value",1340287052))){
return out;
} else {
return com.wsscode.pathom3.plugin.run_with_plugins.cljs$core$IFn$_invoke$arity$7(env,new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","wrap-merge-attribute","com.wsscode.pathom3.connect.runner/wrap-merge-attribute",-520029320),(function (env__$1,m,k__$1,v__$1){
return cljs.core.assoc.cljs$core$IFn$_invoke$arity$3(m,k__$1,com.wsscode.pathom3.connect.runner.process_attr_subquery(env__$1,entity,k__$1,v__$1));
}),env,out,k,v);
}
}),entity,new_data);
});
/**
 * This function gets the map returned from the resolver and merge the data in the
 *   current cache-tree.
 */
com.wsscode.pathom3.connect.runner.merge_resolver_response_BANG_ = (function com$wsscode$pathom3$connect$runner$merge_resolver_response_BANG_(env,response){
if(cljs.core.map_QMARK_(response)){
com.wsscode.pathom3.entity_tree.swap_entity_BANG_.cljs$core$IFn$_invoke$arity$3(env,(function (p1__83470_SHARP_,p2__83471_SHARP_){
return com.wsscode.pathom3.connect.runner.merge_entity_data(env,p1__83470_SHARP_,p2__83471_SHARP_);
}),response);
} else {
}

return env;
});
/**
 * Process the idents from the Graph, this will add the ident data into the child.
 * 
 *   If there is ident data already, it gets merged with the ident value.
 */
com.wsscode.pathom3.connect.runner.process_idents_BANG_ = (function com$wsscode$pathom3$connect$runner$process_idents_BANG_(env,idents){
var seq__83473 = cljs.core.seq(idents);
var chunk__83474 = null;
var count__83475 = (0);
var i__83476 = (0);
while(true){
if((i__83476 < count__83475)){
var k = chunk__83474.cljs$core$IIndexed$_nth$arity$2(null,i__83476);
com.wsscode.pathom3.entity_tree.swap_entity_BANG_.cljs$core$IFn$_invoke$arity$2(env,((function (seq__83473,chunk__83474,count__83475,i__83476,k){
return (function (p1__83472_SHARP_){
return cljs.core.assoc.cljs$core$IFn$_invoke$arity$3(p1__83472_SHARP_,k,com.wsscode.pathom3.connect.runner.process_attr_subquery(env,cljs.core.PersistentArrayMap.EMPTY,k,cljs.core.assoc.cljs$core$IFn$_invoke$arity$3(cljs.core.get.cljs$core$IFn$_invoke$arity$2(p1__83472_SHARP_,k),cljs.core.first(k),cljs.core.second(k))));
});})(seq__83473,chunk__83474,count__83475,i__83476,k))
);


var G__83705 = seq__83473;
var G__83706 = chunk__83474;
var G__83707 = count__83475;
var G__83708 = (i__83476 + (1));
seq__83473 = G__83705;
chunk__83474 = G__83706;
count__83475 = G__83707;
i__83476 = G__83708;
continue;
} else {
var temp__5753__auto__ = cljs.core.seq(seq__83473);
if(temp__5753__auto__){
var seq__83473__$1 = temp__5753__auto__;
if(cljs.core.chunked_seq_QMARK_(seq__83473__$1)){
var c__4649__auto__ = cljs.core.chunk_first(seq__83473__$1);
var G__83709 = cljs.core.chunk_rest(seq__83473__$1);
var G__83710 = c__4649__auto__;
var G__83711 = cljs.core.count(c__4649__auto__);
var G__83712 = (0);
seq__83473 = G__83709;
chunk__83474 = G__83710;
count__83475 = G__83711;
i__83476 = G__83712;
continue;
} else {
var k = cljs.core.first(seq__83473__$1);
com.wsscode.pathom3.entity_tree.swap_entity_BANG_.cljs$core$IFn$_invoke$arity$2(env,((function (seq__83473,chunk__83474,count__83475,i__83476,k,seq__83473__$1,temp__5753__auto__){
return (function (p1__83472_SHARP_){
return cljs.core.assoc.cljs$core$IFn$_invoke$arity$3(p1__83472_SHARP_,k,com.wsscode.pathom3.connect.runner.process_attr_subquery(env,cljs.core.PersistentArrayMap.EMPTY,k,cljs.core.assoc.cljs$core$IFn$_invoke$arity$3(cljs.core.get.cljs$core$IFn$_invoke$arity$2(p1__83472_SHARP_,k),cljs.core.first(k),cljs.core.second(k))));
});})(seq__83473,chunk__83474,count__83475,i__83476,k,seq__83473__$1,temp__5753__auto__))
);


var G__83713 = cljs.core.next(seq__83473__$1);
var G__83714 = null;
var G__83715 = (0);
var G__83716 = (0);
seq__83473 = G__83713;
chunk__83474 = G__83714;
count__83475 = G__83715;
i__83476 = G__83716;
continue;
}
} else {
return null;
}
}
break;
}
});
/**
 * Runs the next node associated with the node, in case it exists.
 */
com.wsscode.pathom3.connect.runner.run_next_node_BANG_ = (function com$wsscode$pathom3$connect$runner$run_next_node_BANG_(p__83477,p__83478){
var map__83479 = p__83477;
var map__83479__$1 = cljs.core.__destructure_map(map__83479);
var env = map__83479__$1;
var graph = cljs.core.get.cljs$core$IFn$_invoke$arity$2(map__83479__$1,new cljs.core.Keyword("com.wsscode.pathom3.connect.planner","graph","com.wsscode.pathom3.connect.planner/graph",-1915509744));
var map__83480 = p__83478;
var map__83480__$1 = cljs.core.__destructure_map(map__83480);
var run_next = cljs.core.get.cljs$core$IFn$_invoke$arity$2(map__83480__$1,new cljs.core.Keyword("com.wsscode.pathom3.connect.planner","run-next","com.wsscode.pathom3.connect.planner/run-next",285457140));
if(cljs.core.truth_(run_next)){
var G__83481 = env;
var G__83482 = com.wsscode.pathom3.connect.planner.get_node.cljs$core$IFn$_invoke$arity$2(graph,run_next);
return (com.wsscode.pathom3.connect.runner.run_node_BANG_.cljs$core$IFn$_invoke$arity$2 ? com.wsscode.pathom3.connect.runner.run_node_BANG_.cljs$core$IFn$_invoke$arity$2(G__83481,G__83482) : com.wsscode.pathom3.connect.runner.run_node_BANG_.call(null,G__83481,G__83482));
} else {
return null;
}
});
com.wsscode.pathom3.connect.runner.merge_node_stats_BANG_ = (function com$wsscode$pathom3$connect$runner$merge_node_stats_BANG_(p__83483,p__83484,data){
var map__83485 = p__83483;
var map__83485__$1 = cljs.core.__destructure_map(map__83485);
var node_run_stats_STAR_ = cljs.core.get.cljs$core$IFn$_invoke$arity$2(map__83485__$1,new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","node-run-stats*","com.wsscode.pathom3.connect.runner/node-run-stats*",453579030));
var map__83486 = p__83484;
var map__83486__$1 = cljs.core.__destructure_map(map__83486);
var node_id = cljs.core.get.cljs$core$IFn$_invoke$arity$2(map__83486__$1,new cljs.core.Keyword("com.wsscode.pathom3.connect.planner","node-id","com.wsscode.pathom3.connect.planner/node-id",1696523707));
if(cljs.core.truth_(node_run_stats_STAR_)){
return com.wsscode.misc.refs.gswap_BANG_.cljs$core$IFn$_invoke$arity$variadic(node_run_stats_STAR_,cljs.core.update,node_id,com.wsscode.misc.coll.merge_defaults,cljs.core.prim_seq.cljs$core$IFn$_invoke$arity$2([data], 0));
} else {
return null;
}
});
com.wsscode.pathom3.connect.runner.merge_mutation_stats_BANG_ = (function com$wsscode$pathom3$connect$runner$merge_mutation_stats_BANG_(p__83488,p__83489,data){
var map__83490 = p__83488;
var map__83490__$1 = cljs.core.__destructure_map(map__83490);
var node_run_stats_STAR_ = cljs.core.get.cljs$core$IFn$_invoke$arity$2(map__83490__$1,new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","node-run-stats*","com.wsscode.pathom3.connect.runner/node-run-stats*",453579030));
var map__83491 = p__83489;
var map__83491__$1 = cljs.core.__destructure_map(map__83491);
var op_name = cljs.core.get.cljs$core$IFn$_invoke$arity$2(map__83491__$1,new cljs.core.Keyword("com.wsscode.pathom3.connect.operation","op-name","com.wsscode.pathom3.connect.operation/op-name",-1249801049));
if(cljs.core.truth_(node_run_stats_STAR_)){
return com.wsscode.misc.refs.gswap_BANG_.cljs$core$IFn$_invoke$arity$variadic(node_run_stats_STAR_,cljs.core.update,op_name,com.wsscode.misc.coll.merge_defaults,cljs.core.prim_seq.cljs$core$IFn$_invoke$arity$2([data], 0));
} else {
return null;
}
});
com.wsscode.pathom3.connect.runner.mark_resolver_error = (function com$wsscode$pathom3$connect$runner$mark_resolver_error(p__83492,p__83493,error){
var map__83494 = p__83492;
var map__83494__$1 = cljs.core.__destructure_map(map__83494);
var node_run_stats_STAR_ = cljs.core.get.cljs$core$IFn$_invoke$arity$2(map__83494__$1,new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","node-run-stats*","com.wsscode.pathom3.connect.runner/node-run-stats*",453579030));
var map__83495 = p__83493;
var map__83495__$1 = cljs.core.__destructure_map(map__83495);
var node_id = cljs.core.get.cljs$core$IFn$_invoke$arity$2(map__83495__$1,new cljs.core.Keyword("com.wsscode.pathom3.connect.planner","node-id","com.wsscode.pathom3.connect.planner/node-id",1696523707));
if(cljs.core.truth_(node_run_stats_STAR_)){
var G__83496 = node_run_stats_STAR_;
com.wsscode.misc.refs.gswap_BANG_.cljs$core$IFn$_invoke$arity$4(G__83496,cljs.core.assoc_in,new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [node_id,new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","node-error","com.wsscode.pathom3.connect.runner/node-error",890120380)], null),error);

com.wsscode.misc.refs.gswap_BANG_.cljs$core$IFn$_invoke$arity$variadic(G__83496,cljs.core.update,new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","nodes-with-error","com.wsscode.pathom3.connect.runner/nodes-with-error",-1230963295),com.wsscode.misc.coll.sconj,cljs.core.prim_seq.cljs$core$IFn$_invoke$arity$2([node_id], 0));

return G__83496;
} else {
return null;
}
});
com.wsscode.pathom3.connect.runner.mark_resolver_error_with_plugins = (function com$wsscode$pathom3$connect$runner$mark_resolver_error_with_plugins(env,node,e){
return com.wsscode.pathom3.plugin.run_with_plugins.cljs$core$IFn$_invoke$arity$6(env,new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","wrap-resolver-error","com.wsscode.pathom3.connect.runner/wrap-resolver-error",-1230614515),com.wsscode.pathom3.connect.runner.mark_resolver_error,env,node,e);
});
com.wsscode.pathom3.connect.runner.choose_cache_store = (function com$wsscode$pathom3$connect$runner$choose_cache_store(env,cache_store){
if(cljs.core.truth_(cache_store)){
if(cljs.core.contains_QMARK_(env,cache_store)){
return cache_store;
} else {
com.wsscode.log.log_event(com.wsscode.log._STAR_active_logger_STAR_,com.wsscode.log.make_event(new cljs.core.Keyword("com.wsscode.log","level-warn","com.wsscode.log/level-warn",312686542),new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","event-attempt-use-undefined-cache-store","com.wsscode.pathom3.connect.runner/event-attempt-use-undefined-cache-store",1467123936),new cljs.core.PersistentArrayMap(null, 1, [new cljs.core.Keyword("com.wsscode.pathom3.connect.operation","cache-store","com.wsscode.pathom3.connect.operation/cache-store",1503197377),cache_store], null)));

return new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","resolver-cache*","com.wsscode.pathom3.connect.runner/resolver-cache*",334664084);
}
} else {
return new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","resolver-cache*","com.wsscode.pathom3.connect.runner/resolver-cache*",334664084);
}
});
com.wsscode.pathom3.connect.runner.report_resolver_io_stats = (function com$wsscode$pathom3$connect$runner$report_resolver_io_stats(p__83501,input_data,result){
var map__83502 = p__83501;
var map__83502__$1 = cljs.core.__destructure_map(map__83502);
var run_stats_omit_resolver_io_QMARK_ = cljs.core.get.cljs$core$IFn$_invoke$arity$2(map__83502__$1,new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","run-stats-omit-resolver-io?","com.wsscode.pathom3.connect.runner/run-stats-omit-resolver-io?",743939109));
if(cljs.core.truth_(run_stats_omit_resolver_io_QMARK_)){
return new cljs.core.PersistentArrayMap(null, 2, [new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","node-resolver-input-shape","com.wsscode.pathom3.connect.runner/node-resolver-input-shape",470286423),com.wsscode.pathom3.format.shape_descriptor.data__GT_shape_descriptor(input_data),new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","node-resolver-output-shape","com.wsscode.pathom3.connect.runner/node-resolver-output-shape",1837913870),com.wsscode.pathom3.format.shape_descriptor.data__GT_shape_descriptor(result)], null);
} else {
return new cljs.core.PersistentArrayMap(null, 2, [new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","node-resolver-input","com.wsscode.pathom3.connect.runner/node-resolver-input",-1558799633),input_data,new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","node-resolver-output","com.wsscode.pathom3.connect.runner/node-resolver-output",800199202),(cljs.core.truth_(new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","batch-hold","com.wsscode.pathom3.connect.runner/batch-hold",-364021743).cljs$core$IFn$_invoke$arity$1(result))?new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","batch-hold","com.wsscode.pathom3.connect.runner/batch-hold",-364021743):result)], null);
}
});
com.wsscode.pathom3.connect.runner.missing_maybe_in_pending_batch_QMARK_ = (function com$wsscode$pathom3$connect$runner$missing_maybe_in_pending_batch_QMARK_(p__83508,input){
var map__83509 = p__83508;
var map__83509__$1 = cljs.core.__destructure_map(map__83509);
var env = map__83509__$1;
var path = cljs.core.get.cljs$core$IFn$_invoke$arity$2(map__83509__$1,new cljs.core.Keyword("com.wsscode.pathom3.path","path","com.wsscode.pathom3.path/path",1029673558));
var nested_inputs = com.wsscode.misc.coll.filter_vals(cljs.core.seq,input);
if(cljs.core.seq(nested_inputs)){
var pending_nested_QMARK_ = cljs.core.some((function (path_SINGLEQUOTE_){
return cljs.core.contains_QMARK_(nested_inputs,cljs.core.first(path_SINGLEQUOTE_));
}),cljs.core.map.cljs$core$IFn$_invoke$arity$2(cljs.core.comp.cljs$core$IFn$_invoke$arity$3((function (p1__83503_SHARP_){
return cljs.core.subvec.cljs$core$IFn$_invoke$arity$2(p1__83503_SHARP_,cljs.core.count(path));
}),new cljs.core.Keyword("com.wsscode.pathom3.path","path","com.wsscode.pathom3.path/path",1029673558),new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","env","com.wsscode.pathom3.connect.runner/env",-1421599428)),cljs.core.into.cljs$core$IFn$_invoke$arity$3(cljs.core.PersistentVector.EMPTY,cljs.core.cat,cljs.core.vals(cljs.core.deref(new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","batch-pending*","com.wsscode.pathom3.connect.runner/batch-pending*",898520706).cljs$core$IFn$_invoke$arity$1(env))))));
return pending_nested_QMARK_;
} else {
return false;
}
});
com.wsscode.pathom3.connect.runner.wait_batch_response = (function com$wsscode$pathom3$connect$runner$wait_batch_response(env,node){
return new cljs.core.PersistentArrayMap(null, 1, [new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","batch-hold","com.wsscode.pathom3.connect.runner/batch-hold",-364021743),new cljs.core.PersistentArrayMap(null, 3, [new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","env","com.wsscode.pathom3.connect.runner/env",-1421599428),env,new cljs.core.Keyword("com.wsscode.pathom3.connect.planner","node","com.wsscode.pathom3.connect.planner/node",325156565),node,new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","nested-waiting?","com.wsscode.pathom3.connect.runner/nested-waiting?",820889396),true], null)], null);
});
com.wsscode.pathom3.connect.runner.invoke_resolver_cached = (function com$wsscode$pathom3$connect$runner$invoke_resolver_cached(env,cache_QMARK_,op_name,resolver,cache_store,input_data,params){
if(cljs.core.truth_(cache_QMARK_)){
return com.wsscode.pathom3.cache.cached(cache_store,env,new cljs.core.PersistentVector(null, 3, 5, cljs.core.PersistentVector.EMPTY_NODE, [op_name,input_data,params], null),(function (){
return com.wsscode.pathom3.connect.operation.protocols._resolve(resolver,env,input_data);
}));
} else {
return com.wsscode.pathom3.connect.operation.protocols._resolve(resolver,env,input_data);
}
});
com.wsscode.pathom3.connect.runner.warn_batch_unsupported = (function com$wsscode$pathom3$connect$runner$warn_batch_unsupported(env,op_name){
return com.wsscode.log.log_event(com.wsscode.log._STAR_active_logger_STAR_,com.wsscode.log.make_event(new cljs.core.Keyword("com.wsscode.log","level-warn","com.wsscode.log/level-warn",312686542),new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","event-batch-unsupported","com.wsscode.pathom3.connect.runner/event-batch-unsupported",1324438337),new cljs.core.PersistentArrayMap(null, 2, [new cljs.core.Keyword("com.wsscode.pathom3.path","path","com.wsscode.pathom3.path/path",1029673558),new cljs.core.Keyword("com.wsscode.pathom3.path","path","com.wsscode.pathom3.path/path",1029673558).cljs$core$IFn$_invoke$arity$1(env),new cljs.core.Keyword("com.wsscode.pathom3.connect.operation","op-name","com.wsscode.pathom3.connect.operation/op-name",-1249801049),op_name], null)));
});
com.wsscode.pathom3.connect.runner.invoke_resolver_cached_batch = (function com$wsscode$pathom3$connect$runner$invoke_resolver_cached_batch(env,cache_QMARK_,op_name,resolver,cache_store,input_data,params){
com.wsscode.pathom3.connect.runner.warn_batch_unsupported(env,op_name);

if(cljs.core.truth_(cache_QMARK_)){
return com.wsscode.pathom3.cache.cached(cache_store,env,new cljs.core.PersistentVector(null, 3, 5, cljs.core.PersistentVector.EMPTY_NODE, [op_name,input_data,params], null),(function (){
return cljs.core.first(com.wsscode.pathom3.connect.operation.protocols._resolve(resolver,env,new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [input_data], null)));
}));
} else {
return cljs.core.first(com.wsscode.pathom3.connect.operation.protocols._resolve(resolver,env,new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [input_data], null)));
}
});
com.wsscode.pathom3.connect.runner.batch_hold_token = (function com$wsscode$pathom3$connect$runner$batch_hold_token(env,cache_QMARK_,op_name,node,cache_store,input_data){
return new cljs.core.PersistentArrayMap(null, 1, [new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","batch-hold","com.wsscode.pathom3.connect.runner/batch-hold",-364021743),new cljs.core.PersistentArrayMap(null, 6, [new cljs.core.Keyword("com.wsscode.pathom3.connect.operation","op-name","com.wsscode.pathom3.connect.operation/op-name",-1249801049),op_name,new cljs.core.Keyword("com.wsscode.pathom3.connect.planner","node","com.wsscode.pathom3.connect.planner/node",325156565),node,new cljs.core.Keyword("com.wsscode.pathom3.connect.operation","cache?","com.wsscode.pathom3.connect.operation/cache?",575940493),cache_QMARK_,new cljs.core.Keyword("com.wsscode.pathom3.connect.operation","cache-store","com.wsscode.pathom3.connect.operation/cache-store",1503197377),cache_store,new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","node-resolver-input","com.wsscode.pathom3.connect.runner/node-resolver-input",-1558799633),input_data,new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","env","com.wsscode.pathom3.connect.runner/env",-1421599428),env], null)], null);
});
com.wsscode.pathom3.connect.runner.valid_response_QMARK_ = (function com$wsscode$pathom3$connect$runner$valid_response_QMARK_(x){
return ((cljs.core.map_QMARK_(x)) || ((((x == null)) || (com.wsscode.misc.refs.kw_identical_QMARK_(x,new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","node-error","com.wsscode.pathom3.connect.runner/node-error",890120380))))));
});
/**
 * Evaluates a resolver using node information.
 * 
 *   When this function runs the resolver, if filters the data to only include the keys
 *   mentioned by the resolver input. This is important to ensure that the resolver is
 *   not using some key that came accidentally due to execution order, that would lead to
 *   brittle executions.
 */
com.wsscode.pathom3.connect.runner.invoke_resolver_from_node = (function com$wsscode$pathom3$connect$runner$invoke_resolver_from_node(env,p__83511){
var map__83512 = p__83511;
var map__83512__$1 = cljs.core.__destructure_map(map__83512);
var node = map__83512__$1;
var op_name = cljs.core.get.cljs$core$IFn$_invoke$arity$2(map__83512__$1,new cljs.core.Keyword("com.wsscode.pathom3.connect.operation","op-name","com.wsscode.pathom3.connect.operation/op-name",-1249801049));
var input = cljs.core.get.cljs$core$IFn$_invoke$arity$2(map__83512__$1,new cljs.core.Keyword("com.wsscode.pathom3.connect.planner","input","com.wsscode.pathom3.connect.planner/input",1912157524));
var resolver = com.wsscode.pathom3.connect.indexes.resolver(env,op_name);
var map__83513 = com.wsscode.pathom3.connect.operation.operation_config(resolver);
var map__83513__$1 = cljs.core.__destructure_map(map__83513);
var op_name__$1 = cljs.core.get.cljs$core$IFn$_invoke$arity$2(map__83513__$1,new cljs.core.Keyword("com.wsscode.pathom3.connect.operation","op-name","com.wsscode.pathom3.connect.operation/op-name",-1249801049));
var batch_QMARK_ = cljs.core.get.cljs$core$IFn$_invoke$arity$2(map__83513__$1,new cljs.core.Keyword("com.wsscode.pathom3.connect.operation","batch?","com.wsscode.pathom3.connect.operation/batch?",1500979317));
var cache_QMARK_ = cljs.core.get.cljs$core$IFn$_invoke$arity$3(map__83513__$1,new cljs.core.Keyword("com.wsscode.pathom3.connect.operation","cache?","com.wsscode.pathom3.connect.operation/cache?",575940493),true);
var cache_store = cljs.core.get.cljs$core$IFn$_invoke$arity$2(map__83513__$1,new cljs.core.Keyword("com.wsscode.pathom3.connect.operation","cache-store","com.wsscode.pathom3.connect.operation/cache-store",1503197377));
var optionals = cljs.core.get.cljs$core$IFn$_invoke$arity$2(map__83513__$1,new cljs.core.Keyword("com.wsscode.pathom3.connect.operation","optionals","com.wsscode.pathom3.connect.operation/optionals",1880951663));
var env__$1 = cljs.core.assoc.cljs$core$IFn$_invoke$arity$3(env,new cljs.core.Keyword("com.wsscode.pathom3.connect.planner","node","com.wsscode.pathom3.connect.planner/node",325156565),node);
var entity = com.wsscode.pathom3.entity_tree.entity(env__$1);
var input_data = com.wsscode.pathom3.format.shape_descriptor.select_shape_filtering.cljs$core$IFn$_invoke$arity$3(entity,com.wsscode.pathom3.format.shape_descriptor.merge_shapes.cljs$core$IFn$_invoke$arity$2(input,optionals),input);
var input_shape = com.wsscode.pathom3.format.shape_descriptor.data__GT_shape_descriptor(input_data);
var params = com.wsscode.pathom3.connect.operation.params(env__$1);
var cache_store__$1 = com.wsscode.pathom3.connect.runner.choose_cache_store(env__$1,cache_store);
var resolver_cache_STAR_ = cljs.core.get.cljs$core$IFn$_invoke$arity$2(env__$1,cache_store__$1);
var _ = com.wsscode.pathom3.connect.runner.merge_node_stats_BANG_(env__$1,node,new cljs.core.PersistentArrayMap(null, 1, [new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","resolver-run-start-ms","com.wsscode.pathom3.connect.runner/resolver-run-start-ms",213921287),com.wsscode.misc.time.now_ms()], null));
var result = (function (){try{if(cljs.core.truth_(com.wsscode.pathom3.format.shape_descriptor.missing.cljs$core$IFn$_invoke$arity$3(input_shape,input,entity))){
if(cljs.core.truth_(com.wsscode.pathom3.connect.runner.missing_maybe_in_pending_batch_QMARK_(env__$1,input))){
return com.wsscode.pathom3.connect.runner.wait_batch_response(env__$1,node);
} else {
throw cljs.core.ex_info.cljs$core$IFn$_invoke$arity$2("Insufficient data",new cljs.core.PersistentArrayMap(null, 2, [new cljs.core.Keyword(null,"required","required",1807647006),input,new cljs.core.Keyword(null,"available","available",-1470697127),input_shape], null));
}
} else {
if(cljs.core.truth_(batch_QMARK_)){
var temp__5751__auto__ = com.wsscode.pathom3.cache.cache_find(resolver_cache_STAR_,new cljs.core.PersistentVector(null, 3, 5, cljs.core.PersistentVector.EMPTY_NODE, [op_name__$1,input_data,params], null));
if(cljs.core.truth_(temp__5751__auto__)){
var x = temp__5751__auto__;
return cljs.core.val(x);
} else {
if(cljs.core.truth_(new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","unsupported-batch?","com.wsscode.pathom3.connect.runner/unsupported-batch?",-826939500).cljs$core$IFn$_invoke$arity$1(env__$1))){
return com.wsscode.pathom3.connect.runner.invoke_resolver_cached_batch(env__$1,cache_QMARK_,op_name__$1,resolver,cache_store__$1,input_data,params);
} else {
return com.wsscode.pathom3.connect.runner.batch_hold_token(env__$1,cache_QMARK_,op_name__$1,node,cache_store__$1,input_data);
}
}
} else {
return com.wsscode.pathom3.connect.runner.invoke_resolver_cached(env__$1,cache_QMARK_,op_name__$1,resolver,cache_store__$1,input_data,params);

}
}
}catch (e83514){var e = e83514;
com.wsscode.pathom3.connect.runner.mark_resolver_error_with_plugins(env__$1,node,e);

return new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","node-error","com.wsscode.pathom3.connect.runner/node-error",890120380);
}})();
var finish = com.wsscode.misc.time.now_ms();
if((!(com.wsscode.pathom3.connect.runner.valid_response_QMARK_(result)))){
com.wsscode.log.log_event(com.wsscode.log._STAR_active_logger_STAR_,com.wsscode.log.make_event(new cljs.core.Keyword("com.wsscode.log","level-warn","com.wsscode.log/level-warn",312686542),new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","invalid-resolver-response","com.wsscode.pathom3.connect.runner/invalid-resolver-response",-1719231556),new cljs.core.PersistentArrayMap(null, 2, [new cljs.core.Keyword("com.wsscode.pathom3.connect.operation","op-name","com.wsscode.pathom3.connect.operation/op-name",-1249801049),op_name__$1,new cljs.core.Keyword(null,"response","response",-1068424192),result], null)));
} else {
}

com.wsscode.pathom3.connect.runner.merge_node_stats_BANG_(env__$1,node,(function (){var G__83515 = new cljs.core.PersistentArrayMap(null, 1, [new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","resolver-run-finish-ms","com.wsscode.pathom3.connect.runner/resolver-run-finish-ms",375193860),finish], null);
if(cljs.core.not(new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","batch-hold","com.wsscode.pathom3.connect.runner/batch-hold",-364021743).cljs$core$IFn$_invoke$arity$1(result))){
return cljs.core.merge.cljs$core$IFn$_invoke$arity$variadic(cljs.core.prim_seq.cljs$core$IFn$_invoke$arity$2([G__83515,com.wsscode.pathom3.connect.runner.report_resolver_io_stats(env__$1,input_data,result)], 0));
} else {
return G__83515;
}
})());

return result;
});
/**
 * This function evaluates the resolver associated with the node.
 * 
 *   First it checks if the expected results from the resolver are already available. In
 *   case they are, the resolver call is skipped.
 */
com.wsscode.pathom3.connect.runner.run_resolver_node_BANG_ = (function com$wsscode$pathom3$connect$runner$run_resolver_node_BANG_(env,node){
if(com.wsscode.pathom3.connect.runner.all_requires_ready_QMARK_(env,node)){
return com.wsscode.pathom3.connect.runner.run_next_node_BANG_(env,node);
} else {
var _ = com.wsscode.pathom3.connect.runner.merge_node_stats_BANG_(env,node,new cljs.core.PersistentArrayMap(null, 1, [new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","node-run-start-ms","com.wsscode.pathom3.connect.runner/node-run-start-ms",-2130582528),com.wsscode.misc.time.now_ms()], null));
var map__83516 = com.wsscode.pathom3.plugin.run_with_plugins.cljs$core$IFn$_invoke$arity$5(env,new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","wrap-resolve","com.wsscode.pathom3.connect.runner/wrap-resolve",-1315168003),com.wsscode.pathom3.connect.runner.invoke_resolver_from_node,env,node);
var map__83516__$1 = cljs.core.__destructure_map(map__83516);
var response = map__83516__$1;
var batch_hold = cljs.core.get.cljs$core$IFn$_invoke$arity$2(map__83516__$1,new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","batch-hold","com.wsscode.pathom3.connect.runner/batch-hold",-364021743));
if(cljs.core.truth_(batch_hold)){
return response;
} else {
if((!(com.wsscode.misc.refs.kw_identical_QMARK_(new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","node-error","com.wsscode.pathom3.connect.runner/node-error",890120380),response)))){
com.wsscode.pathom3.connect.runner.merge_resolver_response_BANG_(env,response);

com.wsscode.pathom3.connect.runner.merge_node_stats_BANG_(env,node,new cljs.core.PersistentArrayMap(null, 1, [new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","node-run-finish-ms","com.wsscode.pathom3.connect.runner/node-run-finish-ms",1292429944),com.wsscode.misc.time.now_ms()], null));

return com.wsscode.pathom3.connect.runner.run_next_node_BANG_(env,node);
} else {
com.wsscode.pathom3.connect.runner.merge_node_stats_BANG_(env,node,new cljs.core.PersistentArrayMap(null, 1, [new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","node-run-finish-ms","com.wsscode.pathom3.connect.runner/node-run-finish-ms",1292429944),com.wsscode.misc.time.now_ms()], null));

return null;

}
}
}
});
/**
 * Sort nodes based on the priority of the node successors. This scans all successors
 *   and choose which one has a node with the highest priority number.
 * 
 *   Returns the paths and their highest priority, in order with the highest priority as
 *   first. For example:
 * 
 *    [[4 [2 1]] [6 [1]]]
 * 
 *   Means the first path is choosing node-id 4, and highest priority is 2.
 */
com.wsscode.pathom3.connect.runner.priority_sort = (function com$wsscode$pathom3$connect$runner$priority_sort(p__83523,node_ids){
var map__83524 = p__83523;
var map__83524__$1 = cljs.core.__destructure_map(map__83524);
var env = map__83524__$1;
var graph = cljs.core.get.cljs$core$IFn$_invoke$arity$2(map__83524__$1,new cljs.core.Keyword("com.wsscode.pathom3.connect.planner","graph","com.wsscode.pathom3.connect.planner/graph",-1915509744));
var paths = cljs.core.mapv.cljs$core$IFn$_invoke$arity$2((function (nid){
return new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [nid,cljs.core.vec(cljs.core.sort.cljs$core$IFn$_invoke$arity$2((function (p1__83520_SHARP_,p2__83519_SHARP_){
return cljs.core.compare(p2__83519_SHARP_,p1__83520_SHARP_);
}),cljs.core.distinct.cljs$core$IFn$_invoke$arity$1(cljs.core.map.cljs$core$IFn$_invoke$arity$2((function (p1__83518_SHARP_){
var or__4223__auto__ = new cljs.core.Keyword("com.wsscode.pathom3.connect.operation","priority","com.wsscode.pathom3.connect.operation/priority",-813904543).cljs$core$IFn$_invoke$arity$1(p1__83518_SHARP_);
if(cljs.core.truth_(or__4223__auto__)){
return or__4223__auto__;
} else {
return (0);
}
}),cljs.core.keep.cljs$core$IFn$_invoke$arity$2((function (p1__83517_SHARP_){
return com.wsscode.pathom3.connect.planner.node_with_resolver_config(graph,env,p1__83517_SHARP_);
}),com.wsscode.pathom3.connect.planner.node_successors(graph,nid))))))], null);
}),node_ids);
return cljs.core.sort_by.cljs$core$IFn$_invoke$arity$3(cljs.core.second,(function (p1__83522_SHARP_,p2__83521_SHARP_){
return com.wsscode.misc.coll.vector_compare(p2__83521_SHARP_,p1__83522_SHARP_);
}),paths);
});
com.wsscode.pathom3.connect.runner.default_choose_path = (function com$wsscode$pathom3$connect$runner$default_choose_path(env,_or_node,node_ids){
return cljs.core.ffirst(com.wsscode.pathom3.connect.runner.priority_sort(env,node_ids));
});
com.wsscode.pathom3.connect.runner.add_taken_path_BANG_ = (function com$wsscode$pathom3$connect$runner$add_taken_path_BANG_(p__83525,p__83526,taken_path_id){
var map__83527 = p__83525;
var map__83527__$1 = cljs.core.__destructure_map(map__83527);
var node_run_stats_STAR_ = cljs.core.get.cljs$core$IFn$_invoke$arity$2(map__83527__$1,new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","node-run-stats*","com.wsscode.pathom3.connect.runner/node-run-stats*",453579030));
var map__83528 = p__83526;
var map__83528__$1 = cljs.core.__destructure_map(map__83528);
var node_id = cljs.core.get.cljs$core$IFn$_invoke$arity$2(map__83528__$1,new cljs.core.Keyword("com.wsscode.pathom3.connect.planner","node-id","com.wsscode.pathom3.connect.planner/node-id",1696523707));
return com.wsscode.misc.refs.gswap_BANG_.cljs$core$IFn$_invoke$arity$variadic(node_run_stats_STAR_,cljs.core.update_in,new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [node_id,new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","taken-paths","com.wsscode.pathom3.connect.runner/taken-paths",-1349641664)], null),com.wsscode.misc.coll.vconj,cljs.core.prim_seq.cljs$core$IFn$_invoke$arity$2([taken_path_id], 0));
});
com.wsscode.pathom3.connect.runner.run_or_node_BANG_ = (function com$wsscode$pathom3$connect$runner$run_or_node_BANG_(p__83529,p__83530){
var map__83531 = p__83529;
var map__83531__$1 = cljs.core.__destructure_map(map__83531);
var env = map__83531__$1;
var graph = cljs.core.get.cljs$core$IFn$_invoke$arity$2(map__83531__$1,new cljs.core.Keyword("com.wsscode.pathom3.connect.planner","graph","com.wsscode.pathom3.connect.planner/graph",-1915509744));
var choose_path = cljs.core.get.cljs$core$IFn$_invoke$arity$3(map__83531__$1,new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","choose-path","com.wsscode.pathom3.connect.runner/choose-path",-251774625),com.wsscode.pathom3.connect.runner.default_choose_path);
var map__83532 = p__83530;
var map__83532__$1 = cljs.core.__destructure_map(map__83532);
var or_node = map__83532__$1;
var run_or = cljs.core.get.cljs$core$IFn$_invoke$arity$2(map__83532__$1,new cljs.core.Keyword("com.wsscode.pathom3.connect.planner","run-or","com.wsscode.pathom3.connect.planner/run-or",-672801891));
com.wsscode.pathom3.connect.runner.merge_node_stats_BANG_(env,or_node,new cljs.core.PersistentArrayMap(null, 1, [new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","node-run-start-ms","com.wsscode.pathom3.connect.runner/node-run-start-ms",-2130582528),com.wsscode.misc.time.now_ms()], null));

var res = (((!(com.wsscode.pathom3.connect.runner.all_requires_ready_QMARK_(env,or_node))))?(function (){var nodes = run_or;
while(true){
if(cljs.core.seq(nodes)){
var picked_node_id = (choose_path.cljs$core$IFn$_invoke$arity$3 ? choose_path.cljs$core$IFn$_invoke$arity$3(env,or_node,nodes) : choose_path.call(null,env,or_node,nodes));
var node_id = ((cljs.core.contains_QMARK_(nodes,picked_node_id))?picked_node_id:(function (){
com.wsscode.log.log_event(com.wsscode.log._STAR_active_logger_STAR_,com.wsscode.log.make_event(new cljs.core.Keyword("com.wsscode.log","level-warn","com.wsscode.log/level-warn",312686542),new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","event-invalid-chosen-path","com.wsscode.pathom3.connect.runner/event-invalid-chosen-path",646160441),new cljs.core.PersistentArrayMap(null, 3, [new cljs.core.Keyword(null,"expected-one-of","expected-one-of",2046658893),nodes,new cljs.core.Keyword(null,"chosen-attempt","chosen-attempt",-1651171103),picked_node_id,new cljs.core.Keyword(null,"actual-used","actual-used",-2136040608),cljs.core.first(nodes)], null)));

return cljs.core.first(nodes);
})()
);
com.wsscode.pathom3.connect.runner.add_taken_path_BANG_(env,or_node,node_id);

var res = (function (){var G__83535 = env;
var G__83536 = com.wsscode.pathom3.connect.planner.get_node.cljs$core$IFn$_invoke$arity$2(graph,node_id);
return (com.wsscode.pathom3.connect.runner.run_node_BANG_.cljs$core$IFn$_invoke$arity$2 ? com.wsscode.pathom3.connect.runner.run_node_BANG_.cljs$core$IFn$_invoke$arity$2(G__83535,G__83536) : com.wsscode.pathom3.connect.runner.run_node_BANG_.call(null,G__83535,G__83536));
})();
if(cljs.core.truth_(new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","batch-hold","com.wsscode.pathom3.connect.runner/batch-hold",-364021743).cljs$core$IFn$_invoke$arity$1(res))){
return res;
} else {
if(com.wsscode.pathom3.connect.runner.all_requires_ready_QMARK_(env,or_node)){
return com.wsscode.pathom3.connect.runner.merge_node_stats_BANG_(env,or_node,new cljs.core.PersistentArrayMap(null, 1, [new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","success-path","com.wsscode.pathom3.connect.runner/success-path",1003623091),node_id], null));
} else {
var G__83728 = cljs.core.disj.cljs$core$IFn$_invoke$arity$2(nodes,node_id);
nodes = G__83728;
continue;
}
}
} else {
return null;
}
break;
}
})():null);
if(cljs.core.truth_(new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","batch-hold","com.wsscode.pathom3.connect.runner/batch-hold",-364021743).cljs$core$IFn$_invoke$arity$1(res))){
return res;
} else {
com.wsscode.pathom3.connect.runner.merge_node_stats_BANG_(env,or_node,new cljs.core.PersistentArrayMap(null, 1, [new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","node-run-finish-ms","com.wsscode.pathom3.connect.runner/node-run-finish-ms",1292429944),com.wsscode.misc.time.now_ms()], null));

return com.wsscode.pathom3.connect.runner.run_next_node_BANG_(env,or_node);
}
});
/**
 * Given an AND node, runs every attached node, then runs the attached next.
 */
com.wsscode.pathom3.connect.runner.run_and_node_BANG_ = (function com$wsscode$pathom3$connect$runner$run_and_node_BANG_(p__83537,p__83538){
var map__83539 = p__83537;
var map__83539__$1 = cljs.core.__destructure_map(map__83539);
var env = map__83539__$1;
var graph = cljs.core.get.cljs$core$IFn$_invoke$arity$2(map__83539__$1,new cljs.core.Keyword("com.wsscode.pathom3.connect.planner","graph","com.wsscode.pathom3.connect.planner/graph",-1915509744));
var map__83540 = p__83538;
var map__83540__$1 = cljs.core.__destructure_map(map__83540);
var and_node = map__83540__$1;
var run_and = cljs.core.get.cljs$core$IFn$_invoke$arity$2(map__83540__$1,new cljs.core.Keyword("com.wsscode.pathom3.connect.planner","run-and","com.wsscode.pathom3.connect.planner/run-and",-1356844884));
com.wsscode.pathom3.connect.runner.merge_node_stats_BANG_(env,and_node,new cljs.core.PersistentArrayMap(null, 1, [new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","node-run-start-ms","com.wsscode.pathom3.connect.runner/node-run-start-ms",-2130582528),com.wsscode.misc.time.now_ms()], null));

var res = cljs.core.reduce.cljs$core$IFn$_invoke$arity$3((function (_,node_id){
var node_res = (function (){var G__83541 = env;
var G__83542 = com.wsscode.pathom3.connect.planner.get_node.cljs$core$IFn$_invoke$arity$2(graph,node_id);
return (com.wsscode.pathom3.connect.runner.run_node_BANG_.cljs$core$IFn$_invoke$arity$2 ? com.wsscode.pathom3.connect.runner.run_node_BANG_.cljs$core$IFn$_invoke$arity$2(G__83541,G__83542) : com.wsscode.pathom3.connect.runner.run_node_BANG_.call(null,G__83541,G__83542));
})();
if(cljs.core.truth_(new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","batch-hold","com.wsscode.pathom3.connect.runner/batch-hold",-364021743).cljs$core$IFn$_invoke$arity$1(node_res))){
return cljs.core.reduced(node_res);
} else {
return null;
}
}),null,run_and);
if(cljs.core.truth_(new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","batch-hold","com.wsscode.pathom3.connect.runner/batch-hold",-364021743).cljs$core$IFn$_invoke$arity$1(res))){
return res;
} else {
com.wsscode.pathom3.connect.runner.merge_node_stats_BANG_(env,and_node,new cljs.core.PersistentArrayMap(null, 1, [new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","node-run-finish-ms","com.wsscode.pathom3.connect.runner/node-run-finish-ms",1292429944),com.wsscode.misc.time.now_ms()], null));

return com.wsscode.pathom3.connect.runner.run_next_node_BANG_(env,and_node);
}
});
/**
 * Run a node from the compute graph. This will start the processing on the sent node
 *   and them will run everything that's connected to this node as sequences of it.
 * 
 *   The result is going to build up at ::p.ent/cache-tree*, after the run is concluded
 *   the output will be there.
 */
com.wsscode.pathom3.connect.runner.run_node_BANG_ = (function com$wsscode$pathom3$connect$runner$run_node_BANG_(env,node){
var G__83543 = com.wsscode.pathom3.connect.planner.node_kind(node);
var G__83543__$1 = (((G__83543 instanceof cljs.core.Keyword))?G__83543.fqn:null);
switch (G__83543__$1) {
case "com.wsscode.pathom3.connect.planner/node-resolver":
return com.wsscode.pathom3.connect.runner.run_resolver_node_BANG_(env,node);

break;
case "com.wsscode.pathom3.connect.planner/node-and":
return com.wsscode.pathom3.connect.runner.run_and_node_BANG_(env,node);

break;
case "com.wsscode.pathom3.connect.planner/node-or":
return com.wsscode.pathom3.connect.runner.run_or_node_BANG_(env,node);

break;
default:
throw (new Error(["No matching clause: ",cljs.core.str.cljs$core$IFn$_invoke$arity$1(G__83543__$1)].join('')));

}
});
/**
 * Create an entity to process the placeholder demands. This consider if the placeholder
 *   has params, params in placeholders means that you want some specific data at that
 *   point.
 */
com.wsscode.pathom3.connect.runner.placeholder_merge_entity = (function com$wsscode$pathom3$connect$runner$placeholder_merge_entity(p__83544,source_ent){
var map__83545 = p__83544;
var map__83545__$1 = cljs.core.__destructure_map(map__83545);
var graph = cljs.core.get.cljs$core$IFn$_invoke$arity$2(map__83545__$1,new cljs.core.Keyword("com.wsscode.pathom3.connect.planner","graph","com.wsscode.pathom3.connect.planner/graph",-1915509744));
return cljs.core.reduce.cljs$core$IFn$_invoke$arity$3((function (out,ph){
var data = new cljs.core.Keyword(null,"params","params",710516235).cljs$core$IFn$_invoke$arity$1(com.wsscode.pathom3.connect.planner.entry_ast(graph,ph));
return cljs.core.assoc.cljs$core$IFn$_invoke$arity$3(out,ph,cljs.core.merge.cljs$core$IFn$_invoke$arity$variadic(cljs.core.prim_seq.cljs$core$IFn$_invoke$arity$2([source_ent,data], 0)));
}),cljs.core.PersistentArrayMap.EMPTY,new cljs.core.Keyword("com.wsscode.pathom3.connect.planner","placeholders","com.wsscode.pathom3.connect.planner/placeholders",-1690563362).cljs$core$IFn$_invoke$arity$1(graph));
});
/**
 * Run mutation from AST.
 */
com.wsscode.pathom3.connect.runner.invoke_mutation_BANG_ = (function com$wsscode$pathom3$connect$runner$invoke_mutation_BANG_(env,p__83548){
var map__83549 = p__83548;
var map__83549__$1 = cljs.core.__destructure_map(map__83549);
var ast = map__83549__$1;
var key = cljs.core.get.cljs$core$IFn$_invoke$arity$2(map__83549__$1,new cljs.core.Keyword(null,"key","key",-1516042587));
var mutation = com.wsscode.pathom3.connect.indexes.mutation(env,key);
var start = com.wsscode.misc.time.now_ms();
var _ = com.wsscode.pathom3.connect.runner.merge_mutation_stats_BANG_(env,new cljs.core.PersistentArrayMap(null, 1, [new cljs.core.Keyword("com.wsscode.pathom3.connect.operation","op-name","com.wsscode.pathom3.connect.operation/op-name",-1249801049),key], null),new cljs.core.PersistentArrayMap(null, 2, [new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","node-run-start-ms","com.wsscode.pathom3.connect.runner/node-run-start-ms",-2130582528),start,new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","mutation-run-start-ms","com.wsscode.pathom3.connect.runner/mutation-run-start-ms",2017573501),start], null));
var result = (function (){try{if(cljs.core.truth_(mutation)){
return com.wsscode.pathom3.plugin.run_with_plugins.cljs$core$IFn$_invoke$arity$5(env,new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","wrap-mutate","com.wsscode.pathom3.connect.runner/wrap-mutate",-1277033248),(function (p1__83546_SHARP_,p2__83547_SHARP_){
return com.wsscode.pathom3.connect.operation.protocols._mutate(mutation,p1__83546_SHARP_,new cljs.core.Keyword(null,"params","params",710516235).cljs$core$IFn$_invoke$arity$1(p2__83547_SHARP_));
}),env,ast);
} else {
throw cljs.core.ex_info.cljs$core$IFn$_invoke$arity$2("Mutation not found",new cljs.core.PersistentArrayMap(null, 1, [new cljs.core.Keyword("com.wsscode.pathom3.connect.operation","op-name","com.wsscode.pathom3.connect.operation/op-name",-1249801049),key], null));
}
}catch (e83550){var e = e83550;
com.wsscode.pathom3.plugin.run_with_plugins.cljs$core$IFn$_invoke$arity$6(env,new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","wrap-mutation-error","com.wsscode.pathom3.connect.runner/wrap-mutation-error",-1155458602),(function (___$1,___$2,___$3){
return null;
}),env,ast,e);

return new cljs.core.PersistentArrayMap(null, 1, [new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","mutation-error","com.wsscode.pathom3.connect.runner/mutation-error",1516517468),e], null);
}})();
com.wsscode.pathom3.connect.runner.merge_mutation_stats_BANG_(env,new cljs.core.PersistentArrayMap(null, 1, [new cljs.core.Keyword("com.wsscode.pathom3.connect.operation","op-name","com.wsscode.pathom3.connect.operation/op-name",-1249801049),key], null),new cljs.core.PersistentArrayMap(null, 1, [new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","mutation-run-finish-ms","com.wsscode.pathom3.connect.runner/mutation-run-finish-ms",394220236),com.wsscode.misc.time.now_ms()], null));

if(cljs.core.truth_(new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","mutation-error","com.wsscode.pathom3.connect.runner/mutation-error",1516517468).cljs$core$IFn$_invoke$arity$1(result))){
com.wsscode.pathom3.entity_tree.swap_entity_BANG_.cljs$core$IFn$_invoke$arity$4(env,cljs.core.assoc,key,result);
} else {
com.wsscode.pathom3.entity_tree.swap_entity_BANG_.cljs$core$IFn$_invoke$arity$4(env,cljs.core.assoc,key,com.wsscode.pathom3.connect.runner.process_attr_subquery(env,cljs.core.PersistentArrayMap.EMPTY,key,result));
}

return com.wsscode.pathom3.connect.runner.merge_mutation_stats_BANG_(env,new cljs.core.PersistentArrayMap(null, 1, [new cljs.core.Keyword("com.wsscode.pathom3.connect.operation","op-name","com.wsscode.pathom3.connect.operation/op-name",-1249801049),key], null),new cljs.core.PersistentArrayMap(null, 1, [new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","node-run-finish-ms","com.wsscode.pathom3.connect.runner/node-run-finish-ms",1292429944),com.wsscode.misc.time.now_ms()], null));
});
/**
 * Runs the mutations gathered by the planner.
 */
com.wsscode.pathom3.connect.runner.process_mutations_BANG_ = (function com$wsscode$pathom3$connect$runner$process_mutations_BANG_(p__83551){
var map__83552 = p__83551;
var map__83552__$1 = cljs.core.__destructure_map(map__83552);
var env = map__83552__$1;
var graph = cljs.core.get.cljs$core$IFn$_invoke$arity$2(map__83552__$1,new cljs.core.Keyword("com.wsscode.pathom3.connect.planner","graph","com.wsscode.pathom3.connect.planner/graph",-1915509744));
var seq__83553 = cljs.core.seq(new cljs.core.Keyword("com.wsscode.pathom3.connect.planner","mutations","com.wsscode.pathom3.connect.planner/mutations",-1571107042).cljs$core$IFn$_invoke$arity$1(graph));
var chunk__83554 = null;
var count__83555 = (0);
var i__83556 = (0);
while(true){
if((i__83556 < count__83555)){
var key = chunk__83554.cljs$core$IIndexed$_nth$arity$2(null,i__83556);
com.wsscode.pathom3.connect.runner.invoke_mutation_BANG_(env,com.wsscode.pathom3.connect.runner.entry_ast(graph,key));


var G__83739 = seq__83553;
var G__83740 = chunk__83554;
var G__83741 = count__83555;
var G__83742 = (i__83556 + (1));
seq__83553 = G__83739;
chunk__83554 = G__83740;
count__83555 = G__83741;
i__83556 = G__83742;
continue;
} else {
var temp__5753__auto__ = cljs.core.seq(seq__83553);
if(temp__5753__auto__){
var seq__83553__$1 = temp__5753__auto__;
if(cljs.core.chunked_seq_QMARK_(seq__83553__$1)){
var c__4649__auto__ = cljs.core.chunk_first(seq__83553__$1);
var G__83744 = cljs.core.chunk_rest(seq__83553__$1);
var G__83745 = c__4649__auto__;
var G__83746 = cljs.core.count(c__4649__auto__);
var G__83747 = (0);
seq__83553 = G__83744;
chunk__83554 = G__83745;
count__83555 = G__83746;
i__83556 = G__83747;
continue;
} else {
var key = cljs.core.first(seq__83553__$1);
com.wsscode.pathom3.connect.runner.invoke_mutation_BANG_(env,com.wsscode.pathom3.connect.runner.entry_ast(graph,key));


var G__83748 = cljs.core.next(seq__83553__$1);
var G__83749 = null;
var G__83750 = (0);
var G__83751 = (0);
seq__83553 = G__83748;
chunk__83554 = G__83749;
count__83555 = G__83750;
i__83556 = G__83751;
continue;
}
} else {
return null;
}
}
break;
}
});
com.wsscode.pathom3.connect.runner.run_root_node_BANG_ = (function com$wsscode$pathom3$connect$runner$run_root_node_BANG_(p__83557){
var map__83558 = p__83557;
var map__83558__$1 = cljs.core.__destructure_map(map__83558);
var env = map__83558__$1;
var graph = cljs.core.get.cljs$core$IFn$_invoke$arity$2(map__83558__$1,new cljs.core.Keyword("com.wsscode.pathom3.connect.planner","graph","com.wsscode.pathom3.connect.planner/graph",-1915509744));
var temp__5751__auto__ = com.wsscode.pathom3.connect.planner.get_root_node(graph);
if(cljs.core.truth_(temp__5751__auto__)){
var root = temp__5751__auto__;
var map__83559 = com.wsscode.pathom3.connect.runner.run_node_BANG_(env,root);
var map__83559__$1 = cljs.core.__destructure_map(map__83559);
var batch_hold = cljs.core.get.cljs$core$IFn$_invoke$arity$2(map__83559__$1,new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","batch-hold","com.wsscode.pathom3.connect.runner/batch-hold",-364021743));
if(cljs.core.truth_(batch_hold)){
if(cljs.core.truth_(new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","nested-waiting?","com.wsscode.pathom3.connect.runner/nested-waiting?",820889396).cljs$core$IFn$_invoke$arity$1(batch_hold))){
return com.wsscode.misc.refs.gswap_BANG_.cljs$core$IFn$_invoke$arity$3(new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","batch-waiting*","com.wsscode.pathom3.connect.runner/batch-waiting*",-950834195).cljs$core$IFn$_invoke$arity$1(env),com.wsscode.misc.coll.vconj,batch_hold);
} else {
return com.wsscode.misc.refs.gswap_BANG_.cljs$core$IFn$_invoke$arity$variadic(new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","batch-pending*","com.wsscode.pathom3.connect.runner/batch-pending*",898520706).cljs$core$IFn$_invoke$arity$1(env),cljs.core.update,new cljs.core.Keyword("com.wsscode.pathom3.connect.operation","op-name","com.wsscode.pathom3.connect.operation/op-name",-1249801049).cljs$core$IFn$_invoke$arity$1(batch_hold),com.wsscode.misc.coll.vconj,cljs.core.prim_seq.cljs$core$IFn$_invoke$arity$2([batch_hold], 0));
}
} else {
return null;
}
} else {
return null;
}
});
/**
 * Run the root node of the graph. As resolvers run, the result will be add to the
 *   entity cache tree.
 */
com.wsscode.pathom3.connect.runner.run_graph_BANG__STAR_ = (function com$wsscode$pathom3$connect$runner$run_graph_BANG__STAR_(p__83560){
var map__83561 = p__83560;
var map__83561__$1 = cljs.core.__destructure_map(map__83561);
var env = map__83561__$1;
var graph = cljs.core.get.cljs$core$IFn$_invoke$arity$2(map__83561__$1,new cljs.core.Keyword("com.wsscode.pathom3.connect.planner","graph","com.wsscode.pathom3.connect.planner/graph",-1915509744));
var source_ent = com.wsscode.pathom3.entity_tree.entity(env);
com.wsscode.pathom3.connect.runner.process_mutations_BANG_(env);

var temp__5751__auto___83752 = new cljs.core.Keyword("com.wsscode.pathom3.connect.planner","nested-process","com.wsscode.pathom3.connect.planner/nested-process",-35632382).cljs$core$IFn$_invoke$arity$1(graph);
if(cljs.core.truth_(temp__5751__auto___83752)){
var nested_83753 = temp__5751__auto___83752;
com.wsscode.pathom3.connect.runner.merge_resolver_response_BANG_(env,cljs.core.select_keys(com.wsscode.pathom3.entity_tree.entity(env),nested_83753));
} else {
}

var temp__5751__auto___83754 = new cljs.core.Keyword("com.wsscode.pathom3.connect.planner","idents","com.wsscode.pathom3.connect.planner/idents",-1156950100).cljs$core$IFn$_invoke$arity$1(graph);
if(cljs.core.truth_(temp__5751__auto___83754)){
var idents_83755 = temp__5751__auto___83754;
com.wsscode.pathom3.connect.runner.process_idents_BANG_(env,idents_83755);
} else {
}

com.wsscode.pathom3.connect.runner.run_root_node_BANG_(env);

com.wsscode.pathom3.connect.runner.merge_resolver_response_BANG_(env,com.wsscode.pathom3.connect.runner.placeholder_merge_entity(env,source_ent));

return graph;
});
com.wsscode.pathom3.connect.runner.plan_and_run_BANG_ = (function com$wsscode$pathom3$connect$runner$plan_and_run_BANG_(env,ast_or_graph,entity_tree_STAR_){
var graph = (cljs.core.truth_(new cljs.core.Keyword("com.wsscode.pathom3.connect.planner","nodes","com.wsscode.pathom3.connect.planner/nodes",873592574).cljs$core$IFn$_invoke$arity$1(ast_or_graph))?ast_or_graph:(function (){var start_plan = com.wsscode.misc.time.now_ms();
var plan = com.wsscode.pathom3.connect.planner.compute_run_graph.cljs$core$IFn$_invoke$arity$1(cljs.core.assoc.cljs$core$IFn$_invoke$arity$variadic(env,new cljs.core.Keyword("edn-query-language.ast","node","edn-query-language.ast/node",-1614840957),ast_or_graph,cljs.core.prim_seq.cljs$core$IFn$_invoke$arity$2([new cljs.core.Keyword("com.wsscode.pathom3.connect.planner","available-data","com.wsscode.pathom3.connect.planner/available-data",727921292),com.wsscode.pathom3.format.shape_descriptor.data__GT_shape_descriptor(cljs.core.deref(entity_tree_STAR_))], 0)));
var finish_plan = com.wsscode.misc.time.now_ms();
return cljs.core.assoc.cljs$core$IFn$_invoke$arity$variadic(plan,new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","compute-plan-run-start-ms","com.wsscode.pathom3.connect.runner/compute-plan-run-start-ms",1143271592),start_plan,cljs.core.prim_seq.cljs$core$IFn$_invoke$arity$2([new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","compute-plan-run-finish-ms","com.wsscode.pathom3.connect.runner/compute-plan-run-finish-ms",-1603607227),finish_plan], 0));
})());
return com.wsscode.pathom3.connect.runner.run_graph_BANG__STAR_(cljs.core.assoc.cljs$core$IFn$_invoke$arity$variadic(env,new cljs.core.Keyword("com.wsscode.pathom3.connect.planner","graph","com.wsscode.pathom3.connect.planner/graph",-1915509744),graph,cljs.core.prim_seq.cljs$core$IFn$_invoke$arity$2([new cljs.core.Keyword("com.wsscode.pathom3.entity-tree","entity-tree*","com.wsscode.pathom3.entity-tree/entity-tree*",1259415691),entity_tree_STAR_], 0)));
});
com.wsscode.pathom3.connect.runner.assoc_end_plan_stats = (function com$wsscode$pathom3$connect$runner$assoc_end_plan_stats(env,plan){
return cljs.core.assoc.cljs$core$IFn$_invoke$arity$variadic(plan,new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","graph-run-start-ms","com.wsscode.pathom3.connect.runner/graph-run-start-ms",-954308936),new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","graph-run-start-ms","com.wsscode.pathom3.connect.runner/graph-run-start-ms",-954308936).cljs$core$IFn$_invoke$arity$1(env),cljs.core.prim_seq.cljs$core$IFn$_invoke$arity$2([new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","graph-run-finish-ms","com.wsscode.pathom3.connect.runner/graph-run-finish-ms",-1109337048),com.wsscode.misc.time.now_ms(),new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","node-run-stats","com.wsscode.pathom3.connect.runner/node-run-stats",-2036346899),(function (){var G__83562 = env;
var G__83562__$1 = (((G__83562 == null))?null:new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","node-run-stats*","com.wsscode.pathom3.connect.runner/node-run-stats*",453579030).cljs$core$IFn$_invoke$arity$1(G__83562));
if((G__83562__$1 == null)){
return null;
} else {
return cljs.core.deref(G__83562__$1);
}
})()], 0));
});
com.wsscode.pathom3.connect.runner.include_meta_stats = (function com$wsscode$pathom3$connect$runner$include_meta_stats(result,env,plan){
return cljs.core.vary_meta.cljs$core$IFn$_invoke$arity$4(result,cljs.core.assoc,new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","run-stats","com.wsscode.pathom3.connect.runner/run-stats",1718909061),com.wsscode.pathom3.connect.runner.assoc_end_plan_stats(env,plan));
});
com.wsscode.pathom3.connect.runner.mark_batch_errors = (function com$wsscode$pathom3$connect$runner$mark_batch_errors(e,env,batch_op,batch_items){
com.wsscode.pathom3.plugin.run_with_plugins.cljs$core$IFn$_invoke$arity$6(env,new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","wrap-batch-resolver-error","com.wsscode.pathom3.connect.runner/wrap-batch-resolver-error",176601916),(function (_,___$1,___$2){
return null;
}),env,new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [batch_op,batch_items], null),e);

var seq__83563_83759 = cljs.core.seq(batch_items);
var chunk__83564_83760 = null;
var count__83565_83761 = (0);
var i__83566_83762 = (0);
while(true){
if((i__83566_83762 < count__83565_83761)){
var map__83569_83763 = chunk__83564_83760.cljs$core$IIndexed$_nth$arity$2(null,i__83566_83762);
var map__83569_83764__$1 = cljs.core.__destructure_map(map__83569_83763);
var env_SINGLEQUOTE__83765 = cljs.core.get.cljs$core$IFn$_invoke$arity$2(map__83569_83764__$1,new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","env","com.wsscode.pathom3.connect.runner/env",-1421599428));
var node_83766 = cljs.core.get.cljs$core$IFn$_invoke$arity$2(map__83569_83764__$1,new cljs.core.Keyword("com.wsscode.pathom3.connect.planner","node","com.wsscode.pathom3.connect.planner/node",325156565));
com.wsscode.pathom3.plugin.run_with_plugins.cljs$core$IFn$_invoke$arity$6(env_SINGLEQUOTE__83765,new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","wrap-resolver-error","com.wsscode.pathom3.connect.runner/wrap-resolver-error",-1230614515),com.wsscode.pathom3.connect.runner.mark_resolver_error,env_SINGLEQUOTE__83765,node_83766,cljs.core.ex_info.cljs$core$IFn$_invoke$arity$3("Batch error",new cljs.core.PersistentArrayMap(null, 1, [new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","batch-error?","com.wsscode.pathom3.connect.runner/batch-error?",-244618920),true], null),e));


var G__83767 = seq__83563_83759;
var G__83768 = chunk__83564_83760;
var G__83769 = count__83565_83761;
var G__83770 = (i__83566_83762 + (1));
seq__83563_83759 = G__83767;
chunk__83564_83760 = G__83768;
count__83565_83761 = G__83769;
i__83566_83762 = G__83770;
continue;
} else {
var temp__5753__auto___83771 = cljs.core.seq(seq__83563_83759);
if(temp__5753__auto___83771){
var seq__83563_83772__$1 = temp__5753__auto___83771;
if(cljs.core.chunked_seq_QMARK_(seq__83563_83772__$1)){
var c__4649__auto___83773 = cljs.core.chunk_first(seq__83563_83772__$1);
var G__83774 = cljs.core.chunk_rest(seq__83563_83772__$1);
var G__83775 = c__4649__auto___83773;
var G__83776 = cljs.core.count(c__4649__auto___83773);
var G__83777 = (0);
seq__83563_83759 = G__83774;
chunk__83564_83760 = G__83775;
count__83565_83761 = G__83776;
i__83566_83762 = G__83777;
continue;
} else {
var map__83570_83778 = cljs.core.first(seq__83563_83772__$1);
var map__83570_83779__$1 = cljs.core.__destructure_map(map__83570_83778);
var env_SINGLEQUOTE__83780 = cljs.core.get.cljs$core$IFn$_invoke$arity$2(map__83570_83779__$1,new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","env","com.wsscode.pathom3.connect.runner/env",-1421599428));
var node_83781 = cljs.core.get.cljs$core$IFn$_invoke$arity$2(map__83570_83779__$1,new cljs.core.Keyword("com.wsscode.pathom3.connect.planner","node","com.wsscode.pathom3.connect.planner/node",325156565));
com.wsscode.pathom3.plugin.run_with_plugins.cljs$core$IFn$_invoke$arity$6(env_SINGLEQUOTE__83780,new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","wrap-resolver-error","com.wsscode.pathom3.connect.runner/wrap-resolver-error",-1230614515),com.wsscode.pathom3.connect.runner.mark_resolver_error,env_SINGLEQUOTE__83780,node_83781,cljs.core.ex_info.cljs$core$IFn$_invoke$arity$3("Batch error",new cljs.core.PersistentArrayMap(null, 1, [new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","batch-error?","com.wsscode.pathom3.connect.runner/batch-error?",-244618920),true], null),e));


var G__83782 = cljs.core.next(seq__83563_83772__$1);
var G__83783 = null;
var G__83784 = (0);
var G__83785 = (0);
seq__83563_83759 = G__83782;
chunk__83564_83760 = G__83783;
count__83565_83761 = G__83784;
i__83566_83762 = G__83785;
continue;
}
} else {
}
}
break;
}

return new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","node-error","com.wsscode.pathom3.connect.runner/node-error",890120380);
});
com.wsscode.pathom3.connect.runner.cache_batch_item = (function com$wsscode$pathom3$connect$runner$cache_batch_item(p__83571,batch_op,response){
var map__83572 = p__83571;
var map__83572__$1 = cljs.core.__destructure_map(map__83572);
var batch_item = map__83572__$1;
var env_SINGLEQUOTE_ = cljs.core.get.cljs$core$IFn$_invoke$arity$2(map__83572__$1,new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","env","com.wsscode.pathom3.connect.runner/env",-1421599428));
var node_resolver_input = cljs.core.get.cljs$core$IFn$_invoke$arity$2(map__83572__$1,new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","node-resolver-input","com.wsscode.pathom3.connect.runner/node-resolver-input",-1558799633));
var cache_QMARK_ = cljs.core.get.cljs$core$IFn$_invoke$arity$2(map__83572__$1,new cljs.core.Keyword("com.wsscode.pathom3.connect.operation","cache?","com.wsscode.pathom3.connect.operation/cache?",575940493));
var cache_store = cljs.core.get.cljs$core$IFn$_invoke$arity$2(map__83572__$1,new cljs.core.Keyword("com.wsscode.pathom3.connect.operation","cache-store","com.wsscode.pathom3.connect.operation/cache-store",1503197377));
if(cljs.core.truth_(cache_QMARK_)){
return com.wsscode.pathom3.cache.cached(cache_store,env_SINGLEQUOTE_,new cljs.core.PersistentVector(null, 3, 5, cljs.core.PersistentVector.EMPTY_NODE, [batch_op,node_resolver_input,com.wsscode.pathom3.connect.operation.params(batch_item)], null),(function (){
return response;
}));
} else {
return null;
}
});
/**
 * For batch we group the items with the same inputs so the resolver only needs to have
 *   each input once. This function is a helper to side the input batch items with the
 *   distinct list of responses.
 */
com.wsscode.pathom3.connect.runner.combine_inputs_with_responses = (function com$wsscode$pathom3$connect$runner$combine_inputs_with_responses(input_groups,inputs,responses){
return cljs.core.into.cljs$core$IFn$_invoke$arity$3(cljs.core.PersistentVector.EMPTY,cljs.core.mapcat.cljs$core$IFn$_invoke$arity$1((function (p__83576){
var vec__83577 = p__83576;
var inputs__$1 = cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__83577,(0),null);
var result = cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__83577,(1),null);
return cljs.core.mapv.cljs$core$IFn$_invoke$arity$2((function (p1__83575_SHARP_){
return (new cljs.core.PersistentVector(null,2,(5),cljs.core.PersistentVector.EMPTY_NODE,[p1__83575_SHARP_,result],null));
}),inputs__$1);
})),cljs.core.mapv.cljs$core$IFn$_invoke$arity$3((function (p1__83574_SHARP_,p2__83573_SHARP_){
return (new cljs.core.PersistentVector(null,2,(5),cljs.core.PersistentVector.EMPTY_NODE,[p2__83573_SHARP_,p1__83574_SHARP_],null));
}),responses,cljs.core.mapv.cljs$core$IFn$_invoke$arity$2(input_groups,inputs)));
});
com.wsscode.pathom3.connect.runner.merge_entity_to_root_data = (function com$wsscode$pathom3$connect$runner$merge_entity_to_root_data(env,env_SINGLEQUOTE_,node){
if(com.wsscode.pathom3.path.root_QMARK_(env_SINGLEQUOTE_)){
return null;
} else {
return com.wsscode.pathom3.entity_tree.swap_entity_BANG_.cljs$core$IFn$_invoke$arity$4(env,cljs.core.update_in,new cljs.core.Keyword("com.wsscode.pathom3.path","path","com.wsscode.pathom3.path/path",1029673558).cljs$core$IFn$_invoke$arity$1(env_SINGLEQUOTE_),(function (ent){
var ent_SINGLEQUOTE_ = com.wsscode.pathom3.entity_tree.entity(env_SINGLEQUOTE_);
return com.wsscode.pathom3.connect.runner.include_meta_stats(cljs.core.merge.cljs$core$IFn$_invoke$arity$variadic(cljs.core.prim_seq.cljs$core$IFn$_invoke$arity$2([com.wsscode.misc.coll.merge_defaults(ent,ent_SINGLEQUOTE_),com.wsscode.pathom3.format.shape_descriptor.select_shape(ent_SINGLEQUOTE_,new cljs.core.Keyword("com.wsscode.pathom3.connect.planner","expects","com.wsscode.pathom3.connect.planner/expects",2018136040).cljs$core$IFn$_invoke$arity$1(node))], 0)),env_SINGLEQUOTE_,new cljs.core.Keyword("com.wsscode.pathom3.connect.planner","graph","com.wsscode.pathom3.connect.planner/graph",-1915509744).cljs$core$IFn$_invoke$arity$1(env_SINGLEQUOTE_));
}));
}
});
com.wsscode.pathom3.connect.runner.run_batches_pending_BANG_ = (function com$wsscode$pathom3$connect$runner$run_batches_pending_BANG_(env){
var batches_STAR_ = new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","batch-pending*","com.wsscode.pathom3.connect.runner/batch-pending*",898520706).cljs$core$IFn$_invoke$arity$1(env);
var batches = cljs.core.deref(batches_STAR_);
cljs.core.vreset_BANG_(batches_STAR_,cljs.core.PersistentArrayMap.EMPTY);

var seq__83581 = cljs.core.seq(batches);
var chunk__83582 = null;
var count__83583 = (0);
var i__83584 = (0);
while(true){
if((i__83584 < count__83583)){
var vec__83635 = chunk__83582.cljs$core$IIndexed$_nth$arity$2(null,i__83584);
var batch_op = cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__83635,(0),null);
var batch_items = cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__83635,(1),null);
var input_groups_83787 = cljs.core.group_by(new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","node-resolver-input","com.wsscode.pathom3.connect.runner/node-resolver-input",-1558799633),batch_items);
var inputs_83788 = cljs.core.keys(input_groups_83787);
var resolver_83789 = com.wsscode.pathom3.connect.indexes.resolver(env,batch_op);
var batch_env_83790 = com.wsscode.misc.coll.update_if.cljs$core$IFn$_invoke$arity$3(new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","env","com.wsscode.pathom3.connect.runner/env",-1421599428).cljs$core$IFn$_invoke$arity$1(cljs.core.first(batch_items)),new cljs.core.Keyword("com.wsscode.pathom3.path","path","com.wsscode.pathom3.path/path",1029673558),((function (seq__83581,chunk__83582,count__83583,i__83584,input_groups_83787,inputs_83788,resolver_83789,vec__83635,batch_op,batch_items,batches_STAR_,batches){
return (function (p1__83580_SHARP_){
var G__83638 = p1__83580_SHARP_;
if(cljs.core.seq(p1__83580_SHARP_)){
return cljs.core.pop(G__83638);
} else {
return G__83638;
}
});})(seq__83581,chunk__83582,count__83583,i__83584,input_groups_83787,inputs_83788,resolver_83789,vec__83635,batch_op,batch_items,batches_STAR_,batches))
);
var start_83791 = com.wsscode.misc.time.now_ms();
var responses_83792 = (function (){try{return com.wsscode.pathom3.connect.operation.protocols._resolve(resolver_83789,batch_env_83790,inputs_83788);
}catch (e83639){var e = e83639;
return com.wsscode.pathom3.connect.runner.mark_batch_errors(e,env,batch_op,batch_items);
}})();
var finish_83793 = com.wsscode.misc.time.now_ms();
if(com.wsscode.misc.refs.kw_identical_QMARK_(new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","node-error","com.wsscode.pathom3.connect.runner/node-error",890120380),responses_83792)){
} else {
if(cljs.core.not_EQ_.cljs$core$IFn$_invoke$arity$2(cljs.core.count(inputs_83788),cljs.core.count(responses_83792))){
throw cljs.core.ex_info.cljs$core$IFn$_invoke$arity$2("Batch results must be a sequence and have the same length as the inputs.",cljs.core.PersistentArrayMap.EMPTY);
} else {
}

var seq__83640_83796 = cljs.core.seq(com.wsscode.pathom3.connect.runner.combine_inputs_with_responses(input_groups_83787,inputs_83788,responses_83792));
var chunk__83641_83797 = null;
var count__83642_83798 = (0);
var i__83643_83799 = (0);
while(true){
if((i__83643_83799 < count__83642_83798)){
var vec__83652_83800 = chunk__83641_83797.cljs$core$IIndexed$_nth$arity$2(null,i__83643_83799);
var map__83655_83801 = cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__83652_83800,(0),null);
var map__83655_83802__$1 = cljs.core.__destructure_map(map__83655_83801);
var batch_item_83803 = map__83655_83802__$1;
var env_SINGLEQUOTE__83804 = cljs.core.get.cljs$core$IFn$_invoke$arity$2(map__83655_83802__$1,new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","env","com.wsscode.pathom3.connect.runner/env",-1421599428));
var node_83805 = cljs.core.get.cljs$core$IFn$_invoke$arity$2(map__83655_83802__$1,new cljs.core.Keyword("com.wsscode.pathom3.connect.planner","node","com.wsscode.pathom3.connect.planner/node",325156565));
var node_resolver_input_83806 = cljs.core.get.cljs$core$IFn$_invoke$arity$2(map__83655_83802__$1,new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","node-resolver-input","com.wsscode.pathom3.connect.runner/node-resolver-input",-1558799633));
var response_83807 = cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__83652_83800,(1),null);
com.wsscode.pathom3.connect.runner.cache_batch_item(batch_item_83803,batch_op,response_83807);

com.wsscode.pathom3.connect.runner.merge_node_stats_BANG_(env_SINGLEQUOTE__83804,node_83805,cljs.core.merge.cljs$core$IFn$_invoke$arity$variadic(cljs.core.prim_seq.cljs$core$IFn$_invoke$arity$2([new cljs.core.PersistentArrayMap(null, 2, [new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","batch-run-start-ms","com.wsscode.pathom3.connect.runner/batch-run-start-ms",-1710202816),start_83791,new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","batch-run-finish-ms","com.wsscode.pathom3.connect.runner/batch-run-finish-ms",-1912626285),finish_83793], null),com.wsscode.pathom3.connect.runner.report_resolver_io_stats(env_SINGLEQUOTE__83804,node_resolver_input_83806,response_83807)], 0)));

com.wsscode.pathom3.connect.runner.merge_resolver_response_BANG_(env_SINGLEQUOTE__83804,response_83807);

com.wsscode.pathom3.connect.runner.merge_node_stats_BANG_(env_SINGLEQUOTE__83804,node_83805,new cljs.core.PersistentArrayMap(null, 1, [new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","node-run-finish-ms","com.wsscode.pathom3.connect.runner/node-run-finish-ms",1292429944),com.wsscode.misc.time.now_ms()], null));

com.wsscode.pathom3.connect.runner.run_root_node_BANG_(env_SINGLEQUOTE__83804);

com.wsscode.pathom3.connect.runner.merge_entity_to_root_data(env,env_SINGLEQUOTE__83804,node_83805);


var G__83808 = seq__83640_83796;
var G__83809 = chunk__83641_83797;
var G__83810 = count__83642_83798;
var G__83811 = (i__83643_83799 + (1));
seq__83640_83796 = G__83808;
chunk__83641_83797 = G__83809;
count__83642_83798 = G__83810;
i__83643_83799 = G__83811;
continue;
} else {
var temp__5753__auto___83812 = cljs.core.seq(seq__83640_83796);
if(temp__5753__auto___83812){
var seq__83640_83813__$1 = temp__5753__auto___83812;
if(cljs.core.chunked_seq_QMARK_(seq__83640_83813__$1)){
var c__4649__auto___83814 = cljs.core.chunk_first(seq__83640_83813__$1);
var G__83815 = cljs.core.chunk_rest(seq__83640_83813__$1);
var G__83816 = c__4649__auto___83814;
var G__83817 = cljs.core.count(c__4649__auto___83814);
var G__83818 = (0);
seq__83640_83796 = G__83815;
chunk__83641_83797 = G__83816;
count__83642_83798 = G__83817;
i__83643_83799 = G__83818;
continue;
} else {
var vec__83656_83819 = cljs.core.first(seq__83640_83813__$1);
var map__83659_83820 = cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__83656_83819,(0),null);
var map__83659_83821__$1 = cljs.core.__destructure_map(map__83659_83820);
var batch_item_83822 = map__83659_83821__$1;
var env_SINGLEQUOTE__83823 = cljs.core.get.cljs$core$IFn$_invoke$arity$2(map__83659_83821__$1,new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","env","com.wsscode.pathom3.connect.runner/env",-1421599428));
var node_83824 = cljs.core.get.cljs$core$IFn$_invoke$arity$2(map__83659_83821__$1,new cljs.core.Keyword("com.wsscode.pathom3.connect.planner","node","com.wsscode.pathom3.connect.planner/node",325156565));
var node_resolver_input_83825 = cljs.core.get.cljs$core$IFn$_invoke$arity$2(map__83659_83821__$1,new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","node-resolver-input","com.wsscode.pathom3.connect.runner/node-resolver-input",-1558799633));
var response_83826 = cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__83656_83819,(1),null);
com.wsscode.pathom3.connect.runner.cache_batch_item(batch_item_83822,batch_op,response_83826);

com.wsscode.pathom3.connect.runner.merge_node_stats_BANG_(env_SINGLEQUOTE__83823,node_83824,cljs.core.merge.cljs$core$IFn$_invoke$arity$variadic(cljs.core.prim_seq.cljs$core$IFn$_invoke$arity$2([new cljs.core.PersistentArrayMap(null, 2, [new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","batch-run-start-ms","com.wsscode.pathom3.connect.runner/batch-run-start-ms",-1710202816),start_83791,new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","batch-run-finish-ms","com.wsscode.pathom3.connect.runner/batch-run-finish-ms",-1912626285),finish_83793], null),com.wsscode.pathom3.connect.runner.report_resolver_io_stats(env_SINGLEQUOTE__83823,node_resolver_input_83825,response_83826)], 0)));

com.wsscode.pathom3.connect.runner.merge_resolver_response_BANG_(env_SINGLEQUOTE__83823,response_83826);

com.wsscode.pathom3.connect.runner.merge_node_stats_BANG_(env_SINGLEQUOTE__83823,node_83824,new cljs.core.PersistentArrayMap(null, 1, [new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","node-run-finish-ms","com.wsscode.pathom3.connect.runner/node-run-finish-ms",1292429944),com.wsscode.misc.time.now_ms()], null));

com.wsscode.pathom3.connect.runner.run_root_node_BANG_(env_SINGLEQUOTE__83823);

com.wsscode.pathom3.connect.runner.merge_entity_to_root_data(env,env_SINGLEQUOTE__83823,node_83824);


var G__83829 = cljs.core.next(seq__83640_83813__$1);
var G__83830 = null;
var G__83831 = (0);
var G__83832 = (0);
seq__83640_83796 = G__83829;
chunk__83641_83797 = G__83830;
count__83642_83798 = G__83831;
i__83643_83799 = G__83832;
continue;
}
} else {
}
}
break;
}
}


var G__83833 = seq__83581;
var G__83834 = chunk__83582;
var G__83835 = count__83583;
var G__83836 = (i__83584 + (1));
seq__83581 = G__83833;
chunk__83582 = G__83834;
count__83583 = G__83835;
i__83584 = G__83836;
continue;
} else {
var temp__5753__auto__ = cljs.core.seq(seq__83581);
if(temp__5753__auto__){
var seq__83581__$1 = temp__5753__auto__;
if(cljs.core.chunked_seq_QMARK_(seq__83581__$1)){
var c__4649__auto__ = cljs.core.chunk_first(seq__83581__$1);
var G__83837 = cljs.core.chunk_rest(seq__83581__$1);
var G__83838 = c__4649__auto__;
var G__83839 = cljs.core.count(c__4649__auto__);
var G__83840 = (0);
seq__83581 = G__83837;
chunk__83582 = G__83838;
count__83583 = G__83839;
i__83584 = G__83840;
continue;
} else {
var vec__83660 = cljs.core.first(seq__83581__$1);
var batch_op = cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__83660,(0),null);
var batch_items = cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__83660,(1),null);
var input_groups_83841 = cljs.core.group_by(new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","node-resolver-input","com.wsscode.pathom3.connect.runner/node-resolver-input",-1558799633),batch_items);
var inputs_83842 = cljs.core.keys(input_groups_83841);
var resolver_83843 = com.wsscode.pathom3.connect.indexes.resolver(env,batch_op);
var batch_env_83844 = com.wsscode.misc.coll.update_if.cljs$core$IFn$_invoke$arity$3(new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","env","com.wsscode.pathom3.connect.runner/env",-1421599428).cljs$core$IFn$_invoke$arity$1(cljs.core.first(batch_items)),new cljs.core.Keyword("com.wsscode.pathom3.path","path","com.wsscode.pathom3.path/path",1029673558),((function (seq__83581,chunk__83582,count__83583,i__83584,input_groups_83841,inputs_83842,resolver_83843,vec__83660,batch_op,batch_items,seq__83581__$1,temp__5753__auto__,batches_STAR_,batches){
return (function (p1__83580_SHARP_){
var G__83663 = p1__83580_SHARP_;
if(cljs.core.seq(p1__83580_SHARP_)){
return cljs.core.pop(G__83663);
} else {
return G__83663;
}
});})(seq__83581,chunk__83582,count__83583,i__83584,input_groups_83841,inputs_83842,resolver_83843,vec__83660,batch_op,batch_items,seq__83581__$1,temp__5753__auto__,batches_STAR_,batches))
);
var start_83845 = com.wsscode.misc.time.now_ms();
var responses_83846 = (function (){try{return com.wsscode.pathom3.connect.operation.protocols._resolve(resolver_83843,batch_env_83844,inputs_83842);
}catch (e83664){var e = e83664;
return com.wsscode.pathom3.connect.runner.mark_batch_errors(e,env,batch_op,batch_items);
}})();
var finish_83847 = com.wsscode.misc.time.now_ms();
if(com.wsscode.misc.refs.kw_identical_QMARK_(new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","node-error","com.wsscode.pathom3.connect.runner/node-error",890120380),responses_83846)){
} else {
if(cljs.core.not_EQ_.cljs$core$IFn$_invoke$arity$2(cljs.core.count(inputs_83842),cljs.core.count(responses_83846))){
throw cljs.core.ex_info.cljs$core$IFn$_invoke$arity$2("Batch results must be a sequence and have the same length as the inputs.",cljs.core.PersistentArrayMap.EMPTY);
} else {
}

var seq__83665_83850 = cljs.core.seq(com.wsscode.pathom3.connect.runner.combine_inputs_with_responses(input_groups_83841,inputs_83842,responses_83846));
var chunk__83666_83851 = null;
var count__83667_83852 = (0);
var i__83668_83853 = (0);
while(true){
if((i__83668_83853 < count__83667_83852)){
var vec__83677_83854 = chunk__83666_83851.cljs$core$IIndexed$_nth$arity$2(null,i__83668_83853);
var map__83680_83855 = cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__83677_83854,(0),null);
var map__83680_83856__$1 = cljs.core.__destructure_map(map__83680_83855);
var batch_item_83857 = map__83680_83856__$1;
var env_SINGLEQUOTE__83858 = cljs.core.get.cljs$core$IFn$_invoke$arity$2(map__83680_83856__$1,new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","env","com.wsscode.pathom3.connect.runner/env",-1421599428));
var node_83859 = cljs.core.get.cljs$core$IFn$_invoke$arity$2(map__83680_83856__$1,new cljs.core.Keyword("com.wsscode.pathom3.connect.planner","node","com.wsscode.pathom3.connect.planner/node",325156565));
var node_resolver_input_83860 = cljs.core.get.cljs$core$IFn$_invoke$arity$2(map__83680_83856__$1,new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","node-resolver-input","com.wsscode.pathom3.connect.runner/node-resolver-input",-1558799633));
var response_83861 = cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__83677_83854,(1),null);
com.wsscode.pathom3.connect.runner.cache_batch_item(batch_item_83857,batch_op,response_83861);

com.wsscode.pathom3.connect.runner.merge_node_stats_BANG_(env_SINGLEQUOTE__83858,node_83859,cljs.core.merge.cljs$core$IFn$_invoke$arity$variadic(cljs.core.prim_seq.cljs$core$IFn$_invoke$arity$2([new cljs.core.PersistentArrayMap(null, 2, [new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","batch-run-start-ms","com.wsscode.pathom3.connect.runner/batch-run-start-ms",-1710202816),start_83845,new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","batch-run-finish-ms","com.wsscode.pathom3.connect.runner/batch-run-finish-ms",-1912626285),finish_83847], null),com.wsscode.pathom3.connect.runner.report_resolver_io_stats(env_SINGLEQUOTE__83858,node_resolver_input_83860,response_83861)], 0)));

com.wsscode.pathom3.connect.runner.merge_resolver_response_BANG_(env_SINGLEQUOTE__83858,response_83861);

com.wsscode.pathom3.connect.runner.merge_node_stats_BANG_(env_SINGLEQUOTE__83858,node_83859,new cljs.core.PersistentArrayMap(null, 1, [new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","node-run-finish-ms","com.wsscode.pathom3.connect.runner/node-run-finish-ms",1292429944),com.wsscode.misc.time.now_ms()], null));

com.wsscode.pathom3.connect.runner.run_root_node_BANG_(env_SINGLEQUOTE__83858);

com.wsscode.pathom3.connect.runner.merge_entity_to_root_data(env,env_SINGLEQUOTE__83858,node_83859);


var G__83865 = seq__83665_83850;
var G__83866 = chunk__83666_83851;
var G__83867 = count__83667_83852;
var G__83868 = (i__83668_83853 + (1));
seq__83665_83850 = G__83865;
chunk__83666_83851 = G__83866;
count__83667_83852 = G__83867;
i__83668_83853 = G__83868;
continue;
} else {
var temp__5753__auto___83869__$1 = cljs.core.seq(seq__83665_83850);
if(temp__5753__auto___83869__$1){
var seq__83665_83870__$1 = temp__5753__auto___83869__$1;
if(cljs.core.chunked_seq_QMARK_(seq__83665_83870__$1)){
var c__4649__auto___83871 = cljs.core.chunk_first(seq__83665_83870__$1);
var G__83872 = cljs.core.chunk_rest(seq__83665_83870__$1);
var G__83873 = c__4649__auto___83871;
var G__83874 = cljs.core.count(c__4649__auto___83871);
var G__83875 = (0);
seq__83665_83850 = G__83872;
chunk__83666_83851 = G__83873;
count__83667_83852 = G__83874;
i__83668_83853 = G__83875;
continue;
} else {
var vec__83681_83876 = cljs.core.first(seq__83665_83870__$1);
var map__83684_83877 = cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__83681_83876,(0),null);
var map__83684_83878__$1 = cljs.core.__destructure_map(map__83684_83877);
var batch_item_83879 = map__83684_83878__$1;
var env_SINGLEQUOTE__83880 = cljs.core.get.cljs$core$IFn$_invoke$arity$2(map__83684_83878__$1,new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","env","com.wsscode.pathom3.connect.runner/env",-1421599428));
var node_83881 = cljs.core.get.cljs$core$IFn$_invoke$arity$2(map__83684_83878__$1,new cljs.core.Keyword("com.wsscode.pathom3.connect.planner","node","com.wsscode.pathom3.connect.planner/node",325156565));
var node_resolver_input_83882 = cljs.core.get.cljs$core$IFn$_invoke$arity$2(map__83684_83878__$1,new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","node-resolver-input","com.wsscode.pathom3.connect.runner/node-resolver-input",-1558799633));
var response_83883 = cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__83681_83876,(1),null);
com.wsscode.pathom3.connect.runner.cache_batch_item(batch_item_83879,batch_op,response_83883);

com.wsscode.pathom3.connect.runner.merge_node_stats_BANG_(env_SINGLEQUOTE__83880,node_83881,cljs.core.merge.cljs$core$IFn$_invoke$arity$variadic(cljs.core.prim_seq.cljs$core$IFn$_invoke$arity$2([new cljs.core.PersistentArrayMap(null, 2, [new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","batch-run-start-ms","com.wsscode.pathom3.connect.runner/batch-run-start-ms",-1710202816),start_83845,new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","batch-run-finish-ms","com.wsscode.pathom3.connect.runner/batch-run-finish-ms",-1912626285),finish_83847], null),com.wsscode.pathom3.connect.runner.report_resolver_io_stats(env_SINGLEQUOTE__83880,node_resolver_input_83882,response_83883)], 0)));

com.wsscode.pathom3.connect.runner.merge_resolver_response_BANG_(env_SINGLEQUOTE__83880,response_83883);

com.wsscode.pathom3.connect.runner.merge_node_stats_BANG_(env_SINGLEQUOTE__83880,node_83881,new cljs.core.PersistentArrayMap(null, 1, [new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","node-run-finish-ms","com.wsscode.pathom3.connect.runner/node-run-finish-ms",1292429944),com.wsscode.misc.time.now_ms()], null));

com.wsscode.pathom3.connect.runner.run_root_node_BANG_(env_SINGLEQUOTE__83880);

com.wsscode.pathom3.connect.runner.merge_entity_to_root_data(env,env_SINGLEQUOTE__83880,node_83881);


var G__83886 = cljs.core.next(seq__83665_83870__$1);
var G__83887 = null;
var G__83888 = (0);
var G__83889 = (0);
seq__83665_83850 = G__83886;
chunk__83666_83851 = G__83887;
count__83667_83852 = G__83888;
i__83668_83853 = G__83889;
continue;
}
} else {
}
}
break;
}
}


var G__83890 = cljs.core.next(seq__83581__$1);
var G__83891 = null;
var G__83892 = (0);
var G__83893 = (0);
seq__83581 = G__83890;
chunk__83582 = G__83891;
count__83583 = G__83892;
i__83584 = G__83893;
continue;
}
} else {
return null;
}
}
break;
}
});
com.wsscode.pathom3.connect.runner.run_batches_waiting_BANG_ = (function com$wsscode$pathom3$connect$runner$run_batches_waiting_BANG_(env){
var waits_STAR_ = new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","batch-waiting*","com.wsscode.pathom3.connect.runner/batch-waiting*",-950834195).cljs$core$IFn$_invoke$arity$1(env);
var waits = cljs.core.deref(waits_STAR_);
cljs.core.vreset_BANG_(waits_STAR_,cljs.core.PersistentVector.EMPTY);

var seq__83685 = cljs.core.seq(waits);
var chunk__83686 = null;
var count__83687 = (0);
var i__83688 = (0);
while(true){
if((i__83688 < count__83687)){
var map__83691 = chunk__83686.cljs$core$IIndexed$_nth$arity$2(null,i__83688);
var map__83691__$1 = cljs.core.__destructure_map(map__83691);
var env_SINGLEQUOTE_ = cljs.core.get.cljs$core$IFn$_invoke$arity$2(map__83691__$1,new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","env","com.wsscode.pathom3.connect.runner/env",-1421599428));
com.wsscode.pathom3.entity_tree.reset_entity_BANG_(env_SINGLEQUOTE_,cljs.core.get_in.cljs$core$IFn$_invoke$arity$2(com.wsscode.pathom3.entity_tree.entity(env),new cljs.core.Keyword("com.wsscode.pathom3.path","path","com.wsscode.pathom3.path/path",1029673558).cljs$core$IFn$_invoke$arity$1(env_SINGLEQUOTE_)));

com.wsscode.pathom3.connect.runner.run_root_node_BANG_(env_SINGLEQUOTE_);

if(com.wsscode.pathom3.path.root_QMARK_(env_SINGLEQUOTE_)){
} else {
com.wsscode.pathom3.entity_tree.swap_entity_BANG_.cljs$core$IFn$_invoke$arity$4(env,cljs.core.assoc_in,new cljs.core.Keyword("com.wsscode.pathom3.path","path","com.wsscode.pathom3.path/path",1029673558).cljs$core$IFn$_invoke$arity$1(env_SINGLEQUOTE_),com.wsscode.pathom3.connect.runner.include_meta_stats(com.wsscode.pathom3.entity_tree.entity(env_SINGLEQUOTE_),env_SINGLEQUOTE_,new cljs.core.Keyword("com.wsscode.pathom3.connect.planner","graph","com.wsscode.pathom3.connect.planner/graph",-1915509744).cljs$core$IFn$_invoke$arity$1(env_SINGLEQUOTE_)));
}


var G__83894 = seq__83685;
var G__83895 = chunk__83686;
var G__83896 = count__83687;
var G__83897 = (i__83688 + (1));
seq__83685 = G__83894;
chunk__83686 = G__83895;
count__83687 = G__83896;
i__83688 = G__83897;
continue;
} else {
var temp__5753__auto__ = cljs.core.seq(seq__83685);
if(temp__5753__auto__){
var seq__83685__$1 = temp__5753__auto__;
if(cljs.core.chunked_seq_QMARK_(seq__83685__$1)){
var c__4649__auto__ = cljs.core.chunk_first(seq__83685__$1);
var G__83898 = cljs.core.chunk_rest(seq__83685__$1);
var G__83899 = c__4649__auto__;
var G__83900 = cljs.core.count(c__4649__auto__);
var G__83901 = (0);
seq__83685 = G__83898;
chunk__83686 = G__83899;
count__83687 = G__83900;
i__83688 = G__83901;
continue;
} else {
var map__83692 = cljs.core.first(seq__83685__$1);
var map__83692__$1 = cljs.core.__destructure_map(map__83692);
var env_SINGLEQUOTE_ = cljs.core.get.cljs$core$IFn$_invoke$arity$2(map__83692__$1,new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","env","com.wsscode.pathom3.connect.runner/env",-1421599428));
com.wsscode.pathom3.entity_tree.reset_entity_BANG_(env_SINGLEQUOTE_,cljs.core.get_in.cljs$core$IFn$_invoke$arity$2(com.wsscode.pathom3.entity_tree.entity(env),new cljs.core.Keyword("com.wsscode.pathom3.path","path","com.wsscode.pathom3.path/path",1029673558).cljs$core$IFn$_invoke$arity$1(env_SINGLEQUOTE_)));

com.wsscode.pathom3.connect.runner.run_root_node_BANG_(env_SINGLEQUOTE_);

if(com.wsscode.pathom3.path.root_QMARK_(env_SINGLEQUOTE_)){
} else {
com.wsscode.pathom3.entity_tree.swap_entity_BANG_.cljs$core$IFn$_invoke$arity$4(env,cljs.core.assoc_in,new cljs.core.Keyword("com.wsscode.pathom3.path","path","com.wsscode.pathom3.path/path",1029673558).cljs$core$IFn$_invoke$arity$1(env_SINGLEQUOTE_),com.wsscode.pathom3.connect.runner.include_meta_stats(com.wsscode.pathom3.entity_tree.entity(env_SINGLEQUOTE_),env_SINGLEQUOTE_,new cljs.core.Keyword("com.wsscode.pathom3.connect.planner","graph","com.wsscode.pathom3.connect.planner/graph",-1915509744).cljs$core$IFn$_invoke$arity$1(env_SINGLEQUOTE_)));
}


var G__83902 = cljs.core.next(seq__83685__$1);
var G__83903 = null;
var G__83904 = (0);
var G__83905 = (0);
seq__83685 = G__83902;
chunk__83686 = G__83903;
count__83687 = G__83904;
i__83688 = G__83905;
continue;
}
} else {
return null;
}
}
break;
}
});
com.wsscode.pathom3.connect.runner.run_batches_BANG_ = (function com$wsscode$pathom3$connect$runner$run_batches_BANG_(env){
com.wsscode.pathom3.connect.runner.run_batches_pending_BANG_(env);

return com.wsscode.pathom3.connect.runner.run_batches_waiting_BANG_(env);
});
com.wsscode.pathom3.connect.runner.setup_runner_env = (function com$wsscode$pathom3$connect$runner$setup_runner_env(env,entity_tree_STAR_,cache_type){
return cljs.core.assoc.cljs$core$IFn$_invoke$arity$variadic(com.wsscode.misc.coll.merge_defaults(env,new cljs.core.PersistentArrayMap(null, 5, [new cljs.core.Keyword("com.wsscode.pathom3.connect.planner","plan-cache*","com.wsscode.pathom3.connect.planner/plan-cache*",-982885642),(function (){var G__83693 = cljs.core.PersistentArrayMap.EMPTY;
return (cache_type.cljs$core$IFn$_invoke$arity$1 ? cache_type.cljs$core$IFn$_invoke$arity$1(G__83693) : cache_type.call(null,G__83693));
})(),new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","batch-pending*","com.wsscode.pathom3.connect.runner/batch-pending*",898520706),(function (){var G__83694 = cljs.core.PersistentArrayMap.EMPTY;
return (cache_type.cljs$core$IFn$_invoke$arity$1 ? cache_type.cljs$core$IFn$_invoke$arity$1(G__83694) : cache_type.call(null,G__83694));
})(),new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","batch-waiting*","com.wsscode.pathom3.connect.runner/batch-waiting*",-950834195),(function (){var G__83695 = cljs.core.PersistentVector.EMPTY;
return (cache_type.cljs$core$IFn$_invoke$arity$1 ? cache_type.cljs$core$IFn$_invoke$arity$1(G__83695) : cache_type.call(null,G__83695));
})(),new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","resolver-cache*","com.wsscode.pathom3.connect.runner/resolver-cache*",334664084),(function (){var G__83696 = cljs.core.PersistentArrayMap.EMPTY;
return (cache_type.cljs$core$IFn$_invoke$arity$1 ? cache_type.cljs$core$IFn$_invoke$arity$1(G__83696) : cache_type.call(null,G__83696));
})(),new cljs.core.Keyword("com.wsscode.pathom3.path","path","com.wsscode.pathom3.path/path",1029673558),cljs.core.PersistentVector.EMPTY], null)),new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","graph-run-start-ms","com.wsscode.pathom3.connect.runner/graph-run-start-ms",-954308936),com.wsscode.misc.time.now_ms(),cljs.core.prim_seq.cljs$core$IFn$_invoke$arity$2([new cljs.core.Keyword("com.wsscode.pathom3.entity-tree","entity-tree*","com.wsscode.pathom3.entity-tree/entity-tree*",1259415691),entity_tree_STAR_,new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","node-run-stats*","com.wsscode.pathom3.connect.runner/node-run-stats*",453579030),(function (){var G__83697 = cljs.core.with_meta(cljs.core.PersistentArrayMap.EMPTY,new cljs.core.PersistentArrayMap(null, 1, [new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","map-container?","com.wsscode.pathom3.connect.runner/map-container?",905687545),true], null));
return (cache_type.cljs$core$IFn$_invoke$arity$1 ? cache_type.cljs$core$IFn$_invoke$arity$1(G__83697) : cache_type.call(null,G__83697));
})()], 0));
});
com.wsscode.pathom3.connect.runner.run_graph_impl_BANG_ = (function com$wsscode$pathom3$connect$runner$run_graph_impl_BANG_(env,ast_or_graph,entity_tree_STAR_){
var env__$1 = com.wsscode.pathom3.connect.runner.setup_runner_env(env,entity_tree_STAR_,cljs.core.volatile_BANG_);
var plan = com.wsscode.pathom3.connect.runner.plan_and_run_BANG_(env__$1,ast_or_graph,entity_tree_STAR_);
if(com.wsscode.pathom3.path.root_QMARK_(env__$1)){
while(true){
if(cljs.core.seq(cljs.core.deref(new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","batch-pending*","com.wsscode.pathom3.connect.runner/batch-pending*",898520706).cljs$core$IFn$_invoke$arity$1(env__$1)))){
com.wsscode.pathom3.connect.runner.run_batches_BANG_(env__$1);

continue;
} else {
}
break;
}
} else {
}

return com.wsscode.pathom3.connect.runner.include_meta_stats(com.wsscode.pathom3.entity_tree.entity(env__$1),env__$1,plan);
});
com.wsscode.pathom3.connect.runner.run_graph_with_plugins = (function com$wsscode$pathom3$connect$runner$run_graph_with_plugins(env,ast_or_graph,entity_tree_STAR_,impl_BANG_){
if(com.wsscode.pathom3.path.root_QMARK_(env)){
return com.wsscode.pathom3.plugin.run_with_plugins.cljs$core$IFn$_invoke$arity$6(env,new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","wrap-root-run-graph!","com.wsscode.pathom3.connect.runner/wrap-root-run-graph!",893721083),(function (e,a,t){
return com.wsscode.pathom3.plugin.run_with_plugins.cljs$core$IFn$_invoke$arity$6(env,new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","wrap-run-graph!","com.wsscode.pathom3.connect.runner/wrap-run-graph!",-170975775),impl_BANG_,e,a,t);
}),env,ast_or_graph,entity_tree_STAR_);
} else {
return com.wsscode.pathom3.plugin.run_with_plugins.cljs$core$IFn$_invoke$arity$6(env,new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","wrap-run-graph!","com.wsscode.pathom3.connect.runner/wrap-run-graph!",-170975775),impl_BANG_,env,ast_or_graph,entity_tree_STAR_);
}
});
/**
 * Plan and execute a request, given an environment (with indexes), the request AST
 *   and the entity-tree*.
 */
com.wsscode.pathom3.connect.runner.run_graph_BANG_ = (function com$wsscode$pathom3$connect$runner$run_graph_BANG_(env,ast_or_graph,entity_tree_STAR_){
return com.wsscode.pathom3.connect.runner.run_graph_with_plugins(env,ast_or_graph,entity_tree_STAR_,com.wsscode.pathom3.connect.runner.run_graph_impl_BANG_);
});
com.wsscode.pathom3.connect.runner.with_resolver_cache = (function com$wsscode$pathom3$connect$runner$with_resolver_cache(var_args){
var G__83699 = arguments.length;
switch (G__83699) {
case 1:
return com.wsscode.pathom3.connect.runner.with_resolver_cache.cljs$core$IFn$_invoke$arity$1((arguments[(0)]));

break;
case 2:
return com.wsscode.pathom3.connect.runner.with_resolver_cache.cljs$core$IFn$_invoke$arity$2((arguments[(0)]),(arguments[(1)]));

break;
default:
throw (new Error(["Invalid arity: ",cljs.core.str.cljs$core$IFn$_invoke$arity$1(arguments.length)].join('')));

}
});

(com.wsscode.pathom3.connect.runner.with_resolver_cache.cljs$core$IFn$_invoke$arity$1 = (function (env){
return com.wsscode.pathom3.connect.runner.with_resolver_cache.cljs$core$IFn$_invoke$arity$2(env,cljs.core.atom.cljs$core$IFn$_invoke$arity$1(cljs.core.PersistentArrayMap.EMPTY));
}));

(com.wsscode.pathom3.connect.runner.with_resolver_cache.cljs$core$IFn$_invoke$arity$2 = (function (env,cache_STAR_){
return cljs.core.assoc.cljs$core$IFn$_invoke$arity$3(env,new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","resolver-cache*","com.wsscode.pathom3.connect.runner/resolver-cache*",334664084),cache_STAR_);
}));

(com.wsscode.pathom3.connect.runner.with_resolver_cache.cljs$lang$maxFixedArity = 2);


//# sourceMappingURL=com.wsscode.pathom3.connect.runner.js.map

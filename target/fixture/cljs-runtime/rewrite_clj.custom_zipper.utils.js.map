{"version":3,"sources":["rewrite_clj/custom_zipper/utils.cljc"],"mappings":"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","names":["p__151880","vec__151881","cljs.core.nth","rewrite-clj.custom-zipper.utils/update-in-path","node","path","loc","k","f","v","cljs.core.get","cljs.core/seq","cljs.core/with-meta","cljs.core.assoc","cljs.core/meta","rewrite-clj.custom-zipper.utils/remove-right","rewrite-clj.custom-zipper.core/custom-zipper?","map__151887","cljs.core/--destructure-map","vec__151888","seq__151889","first__151890","cljs.core/first","cljs.core/next","_r","rs","rewrite-clj.custom-zipper.utils/remove-left","map__151895","left","temp__5751__auto__","vec__151896","_","lpos","cljs.core/peek","cljs.core/pop","rewrite-clj.custom-zipper.utils/remove-right-while","zloc","p?","rloc","rewrite-clj.custom-zipper.core/right","rewrite-clj.custom-zipper.utils/remove-left-while","lloc","rewrite-clj.custom-zipper.core/left","rewrite-clj.custom-zipper.utils/remove-and-move-left","map__151903","vec__151904","lnode","vec__151907","map__151910","l","cljs.core.update_in","rewrite-clj.custom-zipper.utils/remove-and-move-right","map__151911","right","vec__151912","map__151915","r","rewrite-clj.custom-zipper.utils/remove-and-move-up","map__151916","rewrite-clj.custom-zipper.core/remove","rewrite-clj.custom-zipper.core/up","vec__151917","map__151920","_node","ppath","pnodes","cljs.core.ex_info","cljs.core/count","rewrite-clj.custom-zipper.core/make-node","and__4221__auto__"],"sourcesContent":["(ns ^:no-doc rewrite-clj.custom-zipper.utils\n  (:require [rewrite-clj.custom-zipper.core :as zraw]))\n\n#?(:clj (set! *warn-on-reflection* true))\n\n;; ## Remove\n\n(defn- update-in-path\n  [[node path :as loc] k f]\n  (let [v (get path k)]\n    (if (seq v)\n      (with-meta\n        [node (assoc path k (f v) :changed? true)]\n        (meta loc))\n      loc)))\n\n(defn remove-right\n  \"Remove right sibling of the current node (if there is one).\"\n  [loc]\n  (if (zraw/custom-zipper? loc)\n    (let [{[_r & rs] :right} loc]\n      (assoc loc\n             :right rs\n             :changed? true))\n    (update-in-path loc :r next)))\n\n(defn remove-left\n  \"Remove left sibling of the current node (if there is one).\"\n  [loc]\n  (if (zraw/custom-zipper? loc)\n    (let [{:keys [left]} loc]\n      (if-let [[_ lpos] (peek left)]\n        (assoc loc\n               :left (pop left)\n               :position lpos\n               :changed? true)\n        loc))\n    (update-in-path loc :l pop)))\n\n(defn remove-right-while\n  \"Remove elements to the right of the current zipper location as long as\n   the given predicate matches.\"\n  [zloc p?]\n  (loop [zloc zloc]\n    (if-let [rloc (zraw/right zloc)]\n      (if (p? rloc)\n        (recur (remove-right zloc))\n        zloc)\n      zloc)))\n\n(defn remove-left-while\n  \"Remove elements to the left of the current zipper location as long as\n   the given predicate matches.\"\n  [zloc p?]\n  (loop [zloc zloc]\n    (if-let [lloc (zraw/left zloc)]\n      (if (p? lloc)\n        (recur (remove-left zloc))\n        zloc)\n      zloc)))\n\n;; ## Remove and Move\n\n(defn remove-and-move-left\n  \"Remove current node and move left. If current node is at the leftmost\n   location, returns `nil`.\"\n  [loc]\n  (if (zraw/custom-zipper? loc)\n    (let [{:keys [left]} loc]\n      (when (seq left)\n        (let [[lnode lpos] (peek left)]\n          (assoc loc\n                 :changed? true\n                 :node lnode\n                 :position lpos\n                 :left (pop left)))))\n    (let [[_ {:keys [l] :as path}] loc]\n      (when (seq l)\n        (with-meta\n          [(peek l) (-> path\n                        (update-in [:l] pop)\n                        (assoc :changed? true))]\n          (meta loc))))))\n\n(defn remove-and-move-right\n  \"Remove current node and move right. If current node is at the rightmost\n   location, returns `nil`.\"\n  [loc]\n  (if (zraw/custom-zipper? loc)\n    (let [{:keys [right]} loc]\n      (when (seq right)\n        (assoc loc\n               :changed? true\n               :node (first right)\n               :right (next right))))\n\n    (let [[_ {:keys [r] :as path}] loc]\n      (when (seq r)\n        (with-meta\n          [(first r) (-> path\n                         (update-in [:r] next)\n                         (assoc :changed? true))]\n          (meta loc))))))\n\n(defn remove-and-move-up\n  \"Remove the current node and move up.\n    `[a [b |c d]] -> [a |[b d]]`\n    `[a [|b c d]] -> [a |[c d]]`\"\n  [loc]\n  (if (zraw/custom-zipper? loc)\n    (let [{:keys [left]} loc]\n      (if (seq left)\n        (-> loc zraw/remove zraw/up)\n        (zraw/remove loc)))\n    (let [[_node {l :l, ppath :ppath, pnodes :pnodes, rs :r, :as path}] loc]\n      (if (nil? ppath)\n        (throw (ex-info \"cannot remove at top\" {}))\n        (if (pos? (count l))\n          (zraw/up (with-meta [(peek l)\n                            (assoc path :l (pop l) :changed? true)]\n                  (meta loc)))\n          (with-meta [(zraw/make-node loc (peek pnodes) rs)\n                      (and ppath (assoc ppath :changed? true))]\n            (meta loc)))))))\n"]}
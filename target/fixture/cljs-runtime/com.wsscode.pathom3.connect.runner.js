goog.provide('com.wsscode.pathom3.connect.runner');
cljs.spec.alpha.def_impl(new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","attribute-errors","com.wsscode.pathom3.connect.runner/attribute-errors",723532527),cljs.core.list(new cljs.core.Symbol("cljs.spec.alpha","map-of","cljs.spec.alpha/map-of",153715093,null),new cljs.core.Keyword("com.wsscode.pathom3.attribute","attribute","com.wsscode.pathom3.attribute/attribute",1003469786),new cljs.core.Symbol("cljs.core","any?","cljs.core/any?",-2068111842,null)),cljs.spec.alpha.every_impl.cljs$core$IFn$_invoke$arity$4(cljs.core.list(new cljs.core.Symbol("cljs.spec.alpha","tuple","cljs.spec.alpha/tuple",-415901908,null),new cljs.core.Keyword("com.wsscode.pathom3.attribute","attribute","com.wsscode.pathom3.attribute/attribute",1003469786),new cljs.core.Symbol(null,"any?","any?",-318999933,null)),cljs.spec.alpha.tuple_impl.cljs$core$IFn$_invoke$arity$2(new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword("com.wsscode.pathom3.attribute","attribute","com.wsscode.pathom3.attribute/attribute",1003469786),new cljs.core.Symbol("cljs.core","any?","cljs.core/any?",-2068111842,null)], null),new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword("com.wsscode.pathom3.attribute","attribute","com.wsscode.pathom3.attribute/attribute",1003469786),cljs.core.any_QMARK_], null)),new cljs.core.PersistentArrayMap(null, 7, [new cljs.core.Keyword(null,"into","into",-150836029),cljs.core.PersistentArrayMap.EMPTY,new cljs.core.Keyword("cljs.spec.alpha","kind-form","cljs.spec.alpha/kind-form",-1047104697),new cljs.core.Symbol("cljs.core","map?","cljs.core/map?",-1390345523,null),new cljs.core.Keyword("cljs.spec.alpha","cpred","cljs.spec.alpha/cpred",-693471218),(function (G__158456){
return cljs.core.map_QMARK_(G__158456);
}),new cljs.core.Keyword(null,"kind","kind",-717265803),cljs.core.map_QMARK_,new cljs.core.Keyword("cljs.spec.alpha","kfn","cljs.spec.alpha/kfn",672643897),(function (i__11949__auto__,v__11950__auto__){
return cljs.core.nth.cljs$core$IFn$_invoke$arity$2(v__11950__auto__,(0));
}),new cljs.core.Keyword("cljs.spec.alpha","conform-all","cljs.spec.alpha/conform-all",45201917),true,new cljs.core.Keyword("cljs.spec.alpha","describe","cljs.spec.alpha/describe",1883026911),cljs.core.list(new cljs.core.Symbol("cljs.spec.alpha","map-of","cljs.spec.alpha/map-of",153715093,null),new cljs.core.Keyword("com.wsscode.pathom3.attribute","attribute","com.wsscode.pathom3.attribute/attribute",1003469786),new cljs.core.Symbol("cljs.core","any?","cljs.core/any?",-2068111842,null))], null),null));
cljs.spec.alpha.def_impl(new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","choose-path","com.wsscode.pathom3.connect.runner/choose-path",-251774625),new cljs.core.Symbol("cljs.core","fn?","cljs.core/fn?",71876239,null),cljs.core.fn_QMARK_);
cljs.spec.alpha.def_impl(new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","batch-error?","com.wsscode.pathom3.connect.runner/batch-error?",-244618920),new cljs.core.Symbol("cljs.core","boolean?","cljs.core/boolean?",1400713761,null),cljs.core.boolean_QMARK_);
cljs.spec.alpha.def_impl(new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","batch-hold","com.wsscode.pathom3.connect.runner/batch-hold",-364021743),cljs.core.list(new cljs.core.Symbol("cljs.spec.alpha","keys","cljs.spec.alpha/keys",1109346032,null)),cljs.spec.alpha.map_spec_impl(cljs.core.PersistentHashMap.fromArrays([new cljs.core.Keyword(null,"req-un","req-un",1074571008),new cljs.core.Keyword(null,"opt-un","opt-un",883442496),new cljs.core.Keyword(null,"gfn","gfn",791517474),new cljs.core.Keyword(null,"pred-exprs","pred-exprs",1792271395),new cljs.core.Keyword(null,"keys-pred","keys-pred",858984739),new cljs.core.Keyword(null,"opt-keys","opt-keys",1262688261),new cljs.core.Keyword(null,"req-specs","req-specs",553962313),new cljs.core.Keyword(null,"req","req",-326448303),new cljs.core.Keyword(null,"req-keys","req-keys",514319221),new cljs.core.Keyword(null,"opt-specs","opt-specs",-384905450),new cljs.core.Keyword(null,"pred-forms","pred-forms",172611832),new cljs.core.Keyword(null,"opt","opt",-794706369)],[null,null,null,new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [(function (G__158459){
return cljs.core.map_QMARK_(G__158459);
})], null),(function (G__158459){
return cljs.core.map_QMARK_(G__158459);
}),cljs.core.PersistentVector.EMPTY,cljs.core.PersistentVector.EMPTY,null,cljs.core.PersistentVector.EMPTY,cljs.core.PersistentVector.EMPTY,new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [cljs.core.list(new cljs.core.Symbol("cljs.core","fn","cljs.core/fn",-1065745098,null),new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Symbol(null,"%","%",-950237169,null)], null),cljs.core.list(new cljs.core.Symbol("cljs.core","map?","cljs.core/map?",-1390345523,null),new cljs.core.Symbol(null,"%","%",-950237169,null)))], null),null])));
cljs.spec.alpha.def_impl(new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","batch-pending*","com.wsscode.pathom3.connect.runner/batch-pending*",898520706),new cljs.core.Symbol("cljs.core","any?","cljs.core/any?",-2068111842,null),cljs.core.any_QMARK_);
cljs.spec.alpha.def_impl(new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","batch-waiting*","com.wsscode.pathom3.connect.runner/batch-waiting*",-950834195),new cljs.core.Symbol("cljs.core","any?","cljs.core/any?",-2068111842,null),cljs.core.any_QMARK_);
cljs.spec.alpha.def_impl(new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","batch-run-duration-ms","com.wsscode.pathom3.connect.runner/batch-run-duration-ms",-591544025),new cljs.core.Symbol("cljs.core","number?","cljs.core/number?",-811857295,null),cljs.core.number_QMARK_);
cljs.spec.alpha.def_impl(new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","batch-run-finish-ms","com.wsscode.pathom3.connect.runner/batch-run-finish-ms",-1912626285),new cljs.core.Symbol("cljs.core","number?","cljs.core/number?",-811857295,null),cljs.core.number_QMARK_);
cljs.spec.alpha.def_impl(new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","batch-run-start-ms","com.wsscode.pathom3.connect.runner/batch-run-start-ms",-1710202816),new cljs.core.Symbol("cljs.core","number?","cljs.core/number?",-811857295,null),cljs.core.number_QMARK_);
cljs.spec.alpha.def_impl(new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","compute-plan-run-duration-ms","com.wsscode.pathom3.connect.runner/compute-plan-run-duration-ms",-404774312),new cljs.core.Symbol("cljs.core","number?","cljs.core/number?",-811857295,null),cljs.core.number_QMARK_);
cljs.spec.alpha.def_impl(new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","compute-plan-run-start-ms","com.wsscode.pathom3.connect.runner/compute-plan-run-start-ms",1143271592),new cljs.core.Symbol("cljs.core","number?","cljs.core/number?",-811857295,null),cljs.core.number_QMARK_);
cljs.spec.alpha.def_impl(new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","compute-plan-run-finish-ms","com.wsscode.pathom3.connect.runner/compute-plan-run-finish-ms",-1603607227),new cljs.core.Symbol("cljs.core","number?","cljs.core/number?",-811857295,null),cljs.core.number_QMARK_);
cljs.spec.alpha.def_impl(new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","mutation-run-duration-ms","com.wsscode.pathom3.connect.runner/mutation-run-duration-ms",979834),new cljs.core.Symbol("cljs.core","number?","cljs.core/number?",-811857295,null),cljs.core.number_QMARK_);
cljs.spec.alpha.def_impl(new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","mutation-run-start-ms","com.wsscode.pathom3.connect.runner/mutation-run-start-ms",2017573501),new cljs.core.Symbol("cljs.core","number?","cljs.core/number?",-811857295,null),cljs.core.number_QMARK_);
cljs.spec.alpha.def_impl(new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","mutation-run-finish-ms","com.wsscode.pathom3.connect.runner/mutation-run-finish-ms",394220236),new cljs.core.Symbol("cljs.core","number?","cljs.core/number?",-811857295,null),cljs.core.number_QMARK_);
cljs.spec.alpha.def_impl(new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","env","com.wsscode.pathom3.connect.runner/env",-1421599428),new cljs.core.Symbol("cljs.core","map?","cljs.core/map?",-1390345523,null),cljs.core.map_QMARK_);
cljs.spec.alpha.def_impl(new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","graph-run-duration-ms","com.wsscode.pathom3.connect.runner/graph-run-duration-ms",-1215124488),new cljs.core.Symbol("cljs.core","number?","cljs.core/number?",-811857295,null),cljs.core.number_QMARK_);
cljs.spec.alpha.def_impl(new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","graph-run-start-ms","com.wsscode.pathom3.connect.runner/graph-run-start-ms",-954308936),new cljs.core.Symbol("cljs.core","number?","cljs.core/number?",-811857295,null),cljs.core.number_QMARK_);
cljs.spec.alpha.def_impl(new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","graph-run-finish-ms","com.wsscode.pathom3.connect.runner/graph-run-finish-ms",-1109337048),new cljs.core.Symbol("cljs.core","number?","cljs.core/number?",-811857295,null),cljs.core.number_QMARK_);
cljs.spec.alpha.def_impl(new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","map-container?","com.wsscode.pathom3.connect.runner/map-container?",905687545),new cljs.core.Symbol("cljs.core","boolean?","cljs.core/boolean?",1400713761,null),cljs.core.boolean_QMARK_);
cljs.spec.alpha.def_impl(new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","merge-attribute","com.wsscode.pathom3.connect.runner/merge-attribute",-5247203),new cljs.core.Symbol("cljs.core","fn?","cljs.core/fn?",71876239,null),cljs.core.fn_QMARK_);
cljs.spec.alpha.def_impl(new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","node-error","com.wsscode.pathom3.connect.runner/node-error",890120380),new cljs.core.Symbol("cljs.core","any?","cljs.core/any?",-2068111842,null),cljs.core.any_QMARK_);
cljs.spec.alpha.def_impl(new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","node-run-duration-ms","com.wsscode.pathom3.connect.runner/node-run-duration-ms",-1113275696),new cljs.core.Symbol("cljs.core","number?","cljs.core/number?",-811857295,null),cljs.core.number_QMARK_);
cljs.spec.alpha.def_impl(new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","node-run-start-ms","com.wsscode.pathom3.connect.runner/node-run-start-ms",-2130582528),new cljs.core.Symbol("cljs.core","number?","cljs.core/number?",-811857295,null),cljs.core.number_QMARK_);
cljs.spec.alpha.def_impl(new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","node-run-finish-ms","com.wsscode.pathom3.connect.runner/node-run-finish-ms",1292429944),new cljs.core.Symbol("cljs.core","number?","cljs.core/number?",-811857295,null),cljs.core.number_QMARK_);
cljs.spec.alpha.def_impl(new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","node-resolver-input","com.wsscode.pathom3.connect.runner/node-resolver-input",-1558799633),new cljs.core.Symbol("cljs.core","map?","cljs.core/map?",-1390345523,null),cljs.core.map_QMARK_);
cljs.spec.alpha.def_impl(new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","node-resolver-output","com.wsscode.pathom3.connect.runner/node-resolver-output",800199202),new cljs.core.Symbol("cljs.core","map?","cljs.core/map?",-1390345523,null),cljs.core.map_QMARK_);
cljs.spec.alpha.def_impl(new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","node-run-stats","com.wsscode.pathom3.connect.runner/node-run-stats",-2036346899),new cljs.core.Symbol("cljs.core","map?","cljs.core/map?",-1390345523,null),cljs.core.map_QMARK_);
cljs.spec.alpha.def_impl(new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","node-run-stats*","com.wsscode.pathom3.connect.runner/node-run-stats*",453579030),new cljs.core.Symbol("cljs.core","any?","cljs.core/any?",-2068111842,null),cljs.core.any_QMARK_);
cljs.spec.alpha.def_impl(new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","nodes-with-error","com.wsscode.pathom3.connect.runner/nodes-with-error",-1230963295),new cljs.core.Keyword("com.wsscode.pathom3.connect.planner","node-id-set","com.wsscode.pathom3.connect.planner/node-id-set",146448050),new cljs.core.Keyword("com.wsscode.pathom3.connect.planner","node-id-set","com.wsscode.pathom3.connect.planner/node-id-set",146448050));
cljs.spec.alpha.def_impl(new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","resolver-cache*","com.wsscode.pathom3.connect.runner/resolver-cache*",334664084),new cljs.core.Symbol("cljs.core","any?","cljs.core/any?",-2068111842,null),cljs.core.any_QMARK_);
cljs.spec.alpha.def_impl(new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","resolver-run-duration-ms","com.wsscode.pathom3.connect.runner/resolver-run-duration-ms",-1533273691),new cljs.core.Symbol("cljs.core","number?","cljs.core/number?",-811857295,null),cljs.core.number_QMARK_);
cljs.spec.alpha.def_impl(new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","resolver-run-start-ms","com.wsscode.pathom3.connect.runner/resolver-run-start-ms",213921287),new cljs.core.Symbol("cljs.core","number?","cljs.core/number?",-811857295,null),cljs.core.number_QMARK_);
cljs.spec.alpha.def_impl(new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","resolver-run-finish-ms","com.wsscode.pathom3.connect.runner/resolver-run-finish-ms",375193860),new cljs.core.Symbol("cljs.core","number?","cljs.core/number?",-811857295,null),cljs.core.number_QMARK_);
cljs.spec.alpha.def_impl(new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","run-stats","com.wsscode.pathom3.connect.runner/run-stats",1718909061),new cljs.core.Symbol("cljs.core","map?","cljs.core/map?",-1390345523,null),cljs.core.map_QMARK_);
cljs.spec.alpha.def_impl(new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","run-stats-omit-resolver-io?","com.wsscode.pathom3.connect.runner/run-stats-omit-resolver-io?",743939109),new cljs.core.Symbol("cljs.core","boolean?","cljs.core/boolean?",1400713761,null),cljs.core.boolean_QMARK_);
cljs.spec.alpha.def_impl(new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","source-node-id","com.wsscode.pathom3.connect.runner/source-node-id",-124882568),new cljs.core.Keyword("com.wsscode.pathom3.connect.planner","node-id","com.wsscode.pathom3.connect.planner/node-id",1696523707),new cljs.core.Keyword("com.wsscode.pathom3.connect.planner","node-id","com.wsscode.pathom3.connect.planner/node-id",1696523707));
cljs.spec.alpha.def_impl(new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","taken-paths","com.wsscode.pathom3.connect.runner/taken-paths",-1349641664),cljs.core.list(new cljs.core.Symbol("cljs.spec.alpha","coll-of","cljs.spec.alpha/coll-of",1019430407,null),new cljs.core.Keyword("com.wsscode.pathom3.connect.planner","node-id","com.wsscode.pathom3.connect.planner/node-id",1696523707),new cljs.core.Keyword(null,"kind","kind",-717265803),new cljs.core.Symbol("cljs.core","vector?","cljs.core/vector?",-1550392028,null)),cljs.spec.alpha.every_impl.cljs$core$IFn$_invoke$arity$4(new cljs.core.Keyword("com.wsscode.pathom3.connect.planner","node-id","com.wsscode.pathom3.connect.planner/node-id",1696523707),new cljs.core.Keyword("com.wsscode.pathom3.connect.planner","node-id","com.wsscode.pathom3.connect.planner/node-id",1696523707),new cljs.core.PersistentArrayMap(null, 5, [new cljs.core.Keyword("cljs.spec.alpha","kind-form","cljs.spec.alpha/kind-form",-1047104697),new cljs.core.Symbol("cljs.core","vector?","cljs.core/vector?",-1550392028,null),new cljs.core.Keyword("cljs.spec.alpha","cpred","cljs.spec.alpha/cpred",-693471218),(function (G__158477){
return cljs.core.vector_QMARK_(G__158477);
}),new cljs.core.Keyword(null,"kind","kind",-717265803),cljs.core.vector_QMARK_,new cljs.core.Keyword("cljs.spec.alpha","conform-all","cljs.spec.alpha/conform-all",45201917),true,new cljs.core.Keyword("cljs.spec.alpha","describe","cljs.spec.alpha/describe",1883026911),cljs.core.list(new cljs.core.Symbol("cljs.spec.alpha","coll-of","cljs.spec.alpha/coll-of",1019430407,null),new cljs.core.Keyword("com.wsscode.pathom3.connect.planner","node-id","com.wsscode.pathom3.connect.planner/node-id",1696523707),new cljs.core.Keyword(null,"kind","kind",-717265803),new cljs.core.Symbol("cljs.core","vector?","cljs.core/vector?",-1550392028,null))], null),null));
cljs.spec.alpha.def_impl(new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","success-path","com.wsscode.pathom3.connect.runner/success-path",1003623091),new cljs.core.Keyword("com.wsscode.pathom3.connect.planner","node-id","com.wsscode.pathom3.connect.planner/node-id",1696523707),new cljs.core.Keyword("com.wsscode.pathom3.connect.planner","node-id","com.wsscode.pathom3.connect.planner/node-id",1696523707));
cljs.spec.alpha.def_impl(new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","root-query","com.wsscode.pathom3.connect.runner/root-query",1906324752),new cljs.core.Symbol("cljs.core","vector?","cljs.core/vector?",-1550392028,null),cljs.core.vector_QMARK_);
cljs.spec.alpha.def_impl(new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","unsupported-batch?","com.wsscode.pathom3.connect.runner/unsupported-batch?",-826939500),new cljs.core.Symbol("cljs.core","boolean?","cljs.core/boolean?",1400713761,null),cljs.core.boolean_QMARK_);
cljs.spec.alpha.def_impl(new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","wrap-batch-resolver-error","com.wsscode.pathom3.connect.runner/wrap-batch-resolver-error",176601916),new cljs.core.Symbol("cljs.core","fn?","cljs.core/fn?",71876239,null),cljs.core.fn_QMARK_);
cljs.spec.alpha.def_impl(new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","wrap-merge-attribute","com.wsscode.pathom3.connect.runner/wrap-merge-attribute",-520029320),new cljs.core.Symbol("cljs.core","fn?","cljs.core/fn?",71876239,null),cljs.core.fn_QMARK_);
cljs.spec.alpha.def_impl(new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","wrap-mutate","com.wsscode.pathom3.connect.runner/wrap-mutate",-1277033248),new cljs.core.Symbol("cljs.core","fn?","cljs.core/fn?",71876239,null),cljs.core.fn_QMARK_);
cljs.spec.alpha.def_impl(new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","wrap-resolve","com.wsscode.pathom3.connect.runner/wrap-resolve",-1315168003),new cljs.core.Symbol("cljs.core","fn?","cljs.core/fn?",71876239,null),cljs.core.fn_QMARK_);
cljs.spec.alpha.def_impl(new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","wrap-resolver-error","com.wsscode.pathom3.connect.runner/wrap-resolver-error",-1230614515),new cljs.core.Symbol("cljs.core","fn?","cljs.core/fn?",71876239,null),cljs.core.fn_QMARK_);
cljs.spec.alpha.def_impl(new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","wrap-mutation-error","com.wsscode.pathom3.connect.runner/wrap-mutation-error",-1155458602),new cljs.core.Symbol("cljs.core","fn?","cljs.core/fn?",71876239,null),cljs.core.fn_QMARK_);
cljs.spec.alpha.def_impl(new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","wrap-run-graph!","com.wsscode.pathom3.connect.runner/wrap-run-graph!",-170975775),new cljs.core.Symbol("cljs.core","fn?","cljs.core/fn?",71876239,null),cljs.core.fn_QMARK_);
cljs.spec.alpha.def_impl(new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","process-run-start-ms","com.wsscode.pathom3.connect.runner/process-run-start-ms",-360009927),new cljs.core.Symbol("cljs.core","number?","cljs.core/number?",-811857295,null),cljs.core.number_QMARK_);
cljs.spec.alpha.def_impl(new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","process-run-finish-ms","com.wsscode.pathom3.connect.runner/process-run-finish-ms",-1288047429),new cljs.core.Symbol("cljs.core","number?","cljs.core/number?",-811857295,null),cljs.core.number_QMARK_);
cljs.spec.alpha.def_impl(new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","process-run-duration-ms","com.wsscode.pathom3.connect.runner/process-run-duration-ms",2453785),new cljs.core.Symbol("cljs.core","number?","cljs.core/number?",-811857295,null),cljs.core.number_QMARK_);
cljs.spec.alpha.def_impl(new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","node-run-return","com.wsscode.pathom3.connect.runner/node-run-return",-741031913),cljs.core.list(new cljs.core.Symbol("com.fulcrologic.guardrails.core","?","com.fulcrologic.guardrails.core/?",1513394117,null),cljs.core.list(new cljs.core.Symbol("cljs.spec.alpha","keys","cljs.spec.alpha/keys",1109346032,null),new cljs.core.Keyword(null,"opt","opt",-794706369),new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","batch-hold","com.wsscode.pathom3.connect.runner/batch-hold",-364021743)], null))),cljs.spec.alpha.nilable_impl(cljs.core.list(new cljs.core.Symbol("cljs.spec.alpha","keys","cljs.spec.alpha/keys",1109346032,null),new cljs.core.Keyword(null,"opt","opt",-794706369),new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","batch-hold","com.wsscode.pathom3.connect.runner/batch-hold",-364021743)], null)),cljs.spec.alpha.map_spec_impl(cljs.core.PersistentHashMap.fromArrays([new cljs.core.Keyword(null,"req-un","req-un",1074571008),new cljs.core.Keyword(null,"opt-un","opt-un",883442496),new cljs.core.Keyword(null,"gfn","gfn",791517474),new cljs.core.Keyword(null,"pred-exprs","pred-exprs",1792271395),new cljs.core.Keyword(null,"keys-pred","keys-pred",858984739),new cljs.core.Keyword(null,"opt-keys","opt-keys",1262688261),new cljs.core.Keyword(null,"req-specs","req-specs",553962313),new cljs.core.Keyword(null,"req","req",-326448303),new cljs.core.Keyword(null,"req-keys","req-keys",514319221),new cljs.core.Keyword(null,"opt-specs","opt-specs",-384905450),new cljs.core.Keyword(null,"pred-forms","pred-forms",172611832),new cljs.core.Keyword(null,"opt","opt",-794706369)],[null,null,null,new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [(function (G__158479){
return cljs.core.map_QMARK_(G__158479);
})], null),(function (G__158479){
return cljs.core.map_QMARK_(G__158479);
}),new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","batch-hold","com.wsscode.pathom3.connect.runner/batch-hold",-364021743)], null),cljs.core.PersistentVector.EMPTY,null,cljs.core.PersistentVector.EMPTY,new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","batch-hold","com.wsscode.pathom3.connect.runner/batch-hold",-364021743)], null),new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [cljs.core.list(new cljs.core.Symbol("cljs.core","fn","cljs.core/fn",-1065745098,null),new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Symbol(null,"%","%",-950237169,null)], null),cljs.core.list(new cljs.core.Symbol("cljs.core","map?","cljs.core/map?",-1390345523,null),new cljs.core.Symbol(null,"%","%",-950237169,null)))], null),new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","batch-hold","com.wsscode.pathom3.connect.runner/batch-hold",-364021743)], null)])),null));
/**
 * Check if all requirements from the node are present in the current entity.
 */
com.wsscode.pathom3.connect.runner.all_requires_ready_QMARK_ = (function com$wsscode$pathom3$connect$runner$all_requires_ready_QMARK_(env,p__158482){
var map__158483 = p__158482;
var map__158483__$1 = cljs.core.__destructure_map(map__158483);
var expects = cljs.core.get.cljs$core$IFn$_invoke$arity$2(map__158483__$1,new cljs.core.Keyword("com.wsscode.pathom3.connect.planner","expects","com.wsscode.pathom3.connect.planner/expects",2018136040));
var entity = com.wsscode.pathom3.entity_tree.entity(env);
return cljs.core.every_QMARK_((function (p1__158481_SHARP_){
return cljs.core.contains_QMARK_(entity,p1__158481_SHARP_);
}),cljs.core.keys(expects));
});


com.wsscode.pathom3.connect.runner.union_key_on_data_QMARK_ = (function com$wsscode$pathom3$connect$runner$union_key_on_data_QMARK_(p__158486,m){
var map__158487 = p__158486;
var map__158487__$1 = cljs.core.__destructure_map(map__158487);
var union_key = cljs.core.get.cljs$core$IFn$_invoke$arity$2(map__158487__$1,new cljs.core.Keyword(null,"union-key","union-key",1529707234));
return cljs.core.contains_QMARK_(m,union_key);
});
/**
 * Check if ast children is a union type. If so, makes a decision to choose a path and
 *   return that AST.
 */
com.wsscode.pathom3.connect.runner.pick_union_entry = (function com$wsscode$pathom3$connect$runner$pick_union_entry(ast,m){
if(com.wsscode.pathom3.format.eql.union_children_QMARK_(ast)){
return cljs.core.some((function (ast_SINGLEQUOTE_){
if(com.wsscode.pathom3.connect.runner.union_key_on_data_QMARK_(ast_SINGLEQUOTE_,m)){
return com.wsscode.pathom3.format.eql.union__GT_root(ast_SINGLEQUOTE_);
} else {
return null;
}
}),com.wsscode.pathom3.format.eql.union_children(ast));
} else {
return ast;
}
});
com.wsscode.pathom3.connect.runner.process_map_subquery = (function com$wsscode$pathom3$connect$runner$process_map_subquery(env,ast,m){
if(((cljs.core.map_QMARK_(m)) && (cljs.core.not(com.wsscode.pathom3.connect.operation.final_value_QMARK_(m))))){
var cache_tree_STAR_ = com.wsscode.pathom3.entity_tree.create_entity(m);
var ast__$1 = com.wsscode.pathom3.connect.runner.pick_union_entry(ast,m);
return (com.wsscode.pathom3.connect.runner.run_graph_BANG_.cljs$core$IFn$_invoke$arity$3 ? com.wsscode.pathom3.connect.runner.run_graph_BANG_.cljs$core$IFn$_invoke$arity$3(env,ast__$1,cache_tree_STAR_) : com.wsscode.pathom3.connect.runner.run_graph_BANG_.call(null,env,ast__$1,cache_tree_STAR_));
} else {
return m;
}
});
com.wsscode.pathom3.connect.runner.process_sequence_subquery = (function com$wsscode$pathom3$connect$runner$process_sequence_subquery(env,ast,s){
if(cljs.core.truth_(com.wsscode.pathom3.connect.operation.final_value_QMARK_(s))){
return s;
} else {
return cljs.core.into.cljs$core$IFn$_invoke$arity$3(cljs.core.empty(s),cljs.core.map_indexed.cljs$core$IFn$_invoke$arity$1((function (p1__158488_SHARP_,p2__158489_SHARP_){
return com.wsscode.pathom3.connect.runner.process_map_subquery(com.wsscode.pathom3.path.append_path(env,p1__158488_SHARP_),ast,p2__158489_SHARP_);
})),(function (){var G__158490 = s;
if(com.wsscode.misc.coll.coll_append_at_head_QMARK_(s)){
return cljs.core.reverse(G__158490);
} else {
return G__158490;
}
})());
}
});
/**
 * Build a new map where the values are replaced with the map process of the subquery.
 */
com.wsscode.pathom3.connect.runner.process_map_container_subquery = (function com$wsscode$pathom3$connect$runner$process_map_container_subquery(env,ast,m){
if(cljs.core.truth_(com.wsscode.pathom3.connect.operation.final_value_QMARK_(m))){
return m;
} else {
return cljs.core.into.cljs$core$IFn$_invoke$arity$3(cljs.core.PersistentArrayMap.EMPTY,cljs.core.map.cljs$core$IFn$_invoke$arity$1((function (x){
return com.wsscode.misc.coll.make_map_entry(cljs.core.key(x),com.wsscode.pathom3.connect.runner.process_map_subquery(com.wsscode.pathom3.path.append_path(env,cljs.core.key(x)),ast,cljs.core.val(x)));
})),m);
}
});
/**
 * Check if the map should be processed as a map-container, this means the sub-query
 *   should apply to the map values instead of the map itself.
 * 
 *   This can be dictated by adding the ::pcr/map-container? meta data on the value, or
 *   requested by the query as part of the param.
 */
com.wsscode.pathom3.connect.runner.process_map_container_QMARK_ = (function com$wsscode$pathom3$connect$runner$process_map_container_QMARK_(ast,v){
var or__4223__auto__ = new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","map-container?","com.wsscode.pathom3.connect.runner/map-container?",905687545).cljs$core$IFn$_invoke$arity$1(cljs.core.meta(v));
if(cljs.core.truth_(or__4223__auto__)){
return or__4223__auto__;
} else {
return new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","map-container?","com.wsscode.pathom3.connect.runner/map-container?",905687545).cljs$core$IFn$_invoke$arity$1(new cljs.core.Keyword(null,"params","params",710516235).cljs$core$IFn$_invoke$arity$1(ast));
}
});
com.wsscode.pathom3.connect.runner.normalize_ast_recursive_query = (function com$wsscode$pathom3$connect$runner$normalize_ast_recursive_query(p__158491,graph,k){
var map__158492 = p__158491;
var map__158492__$1 = cljs.core.__destructure_map(map__158492);
var ast = map__158492__$1;
var query = cljs.core.get.cljs$core$IFn$_invoke$arity$2(map__158492__$1,new cljs.core.Keyword(null,"query","query",-1288509510));
var children = ((cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(new cljs.core.Symbol(null,"...","...",-1926939749,null),query))?cljs.core.vec(cljs.core.vals(new cljs.core.Keyword("com.wsscode.pathom3.connect.planner","index-ast","com.wsscode.pathom3.connect.planner/index-ast",905845713).cljs$core$IFn$_invoke$arity$1(graph))):((cljs.core.pos_int_QMARK_(query))?cljs.core.vec(cljs.core.vals(cljs.core.update_in.cljs$core$IFn$_invoke$arity$3(new cljs.core.Keyword("com.wsscode.pathom3.connect.planner","index-ast","com.wsscode.pathom3.connect.planner/index-ast",905845713).cljs$core$IFn$_invoke$arity$1(graph),new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [k,new cljs.core.Keyword(null,"query","query",-1288509510)], null),cljs.core.dec))):new cljs.core.Keyword(null,"children","children",-940561982).cljs$core$IFn$_invoke$arity$1(ast)
));
return cljs.core.assoc.cljs$core$IFn$_invoke$arity$3(ast,new cljs.core.Keyword(null,"children","children",-940561982),children);
});
/**
 * Get AST entry and pulls recursive query when needed.
 */
com.wsscode.pathom3.connect.runner.entry_ast = (function com$wsscode$pathom3$connect$runner$entry_ast(graph,k){
return com.wsscode.pathom3.connect.runner.normalize_ast_recursive_query(com.wsscode.pathom3.connect.planner.entry_ast(graph,k),graph,k);
});
com.wsscode.pathom3.connect.runner.process_attr_subquery = (function com$wsscode$pathom3$connect$runner$process_attr_subquery(p__158493,entity,k,v){
var map__158494 = p__158493;
var map__158494__$1 = cljs.core.__destructure_map(map__158494);
var env = map__158494__$1;
var graph = cljs.core.get.cljs$core$IFn$_invoke$arity$2(map__158494__$1,new cljs.core.Keyword("com.wsscode.pathom3.connect.planner","graph","com.wsscode.pathom3.connect.planner/graph",-1915509744));
var map__158495 = com.wsscode.pathom3.connect.runner.entry_ast(graph,k);
var map__158495__$1 = cljs.core.__destructure_map(map__158495);
var ast = map__158495__$1;
var children = cljs.core.get.cljs$core$IFn$_invoke$arity$2(map__158495__$1,new cljs.core.Keyword(null,"children","children",-940561982));
var env__$1 = com.wsscode.pathom3.path.append_path(env,k);
if(cljs.core.truth_(children)){
if(cljs.core.map_QMARK_(v)){
if(cljs.core.truth_(com.wsscode.pathom3.connect.runner.process_map_container_QMARK_(ast,v))){
return com.wsscode.pathom3.connect.runner.process_map_container_subquery(env__$1,ast,v);
} else {
return com.wsscode.pathom3.connect.runner.process_map_subquery(env__$1,ast,v);
}
} else {
if(com.wsscode.misc.coll.collection_QMARK_(v)){
return com.wsscode.pathom3.connect.runner.process_sequence_subquery((function (){var G__158496 = env__$1;
if((!(cljs.core.vector_QMARK_(v)))){
return cljs.core.assoc.cljs$core$IFn$_invoke$arity$3(G__158496,new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","unsupported-batch?","com.wsscode.pathom3.connect.runner/unsupported-batch?",-826939500),true);
} else {
return G__158496;
}
})(),ast,v);
} else {
return v;

}
}
} else {
var temp__5751__auto__ = cljs.core.find(entity,k);
if(cljs.core.truth_(temp__5751__auto__)){
var x = temp__5751__auto__;
return cljs.core.val(x);
} else {
return v;
}
}
});
/**
 * Specialized merge versions that work on entity data.
 */
com.wsscode.pathom3.connect.runner.merge_entity_data = (function com$wsscode$pathom3$connect$runner$merge_entity_data(env,entity,new_data){
return cljs.core.reduce_kv((function (out,k,v){
if(com.wsscode.misc.refs.kw_identical_QMARK_(v,new cljs.core.Keyword("com.wsscode.pathom3.connect.operation","unknown-value","com.wsscode.pathom3.connect.operation/unknown-value",1340287052))){
return out;
} else {
return com.wsscode.pathom3.plugin.run_with_plugins.cljs$core$IFn$_invoke$arity$7(env,new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","wrap-merge-attribute","com.wsscode.pathom3.connect.runner/wrap-merge-attribute",-520029320),(function (env__$1,m,k__$1,v__$1){
return cljs.core.assoc.cljs$core$IFn$_invoke$arity$3(m,k__$1,com.wsscode.pathom3.connect.runner.process_attr_subquery(env__$1,entity,k__$1,v__$1));
}),env,out,k,v);
}
}),entity,new_data);
});
/**
 * This function gets the map returned from the resolver and merge the data in the
 *   current cache-tree.
 */
com.wsscode.pathom3.connect.runner.merge_resolver_response_BANG_ = (function com$wsscode$pathom3$connect$runner$merge_resolver_response_BANG_(env,response){
if(cljs.core.map_QMARK_(response)){
com.wsscode.pathom3.entity_tree.swap_entity_BANG_.cljs$core$IFn$_invoke$arity$3(env,(function (p1__158503_SHARP_,p2__158504_SHARP_){
return com.wsscode.pathom3.connect.runner.merge_entity_data(env,p1__158503_SHARP_,p2__158504_SHARP_);
}),response);
} else {
}

return env;
});
/**
 * Process the idents from the Graph, this will add the ident data into the child.
 * 
 *   If there is ident data already, it gets merged with the ident value.
 */
com.wsscode.pathom3.connect.runner.process_idents_BANG_ = (function com$wsscode$pathom3$connect$runner$process_idents_BANG_(env,idents){
var seq__158507 = cljs.core.seq(idents);
var chunk__158508 = null;
var count__158509 = (0);
var i__158510 = (0);
while(true){
if((i__158510 < count__158509)){
var k = chunk__158508.cljs$core$IIndexed$_nth$arity$2(null,i__158510);
com.wsscode.pathom3.entity_tree.swap_entity_BANG_.cljs$core$IFn$_invoke$arity$2(env,((function (seq__158507,chunk__158508,count__158509,i__158510,k){
return (function (p1__158506_SHARP_){
return cljs.core.assoc.cljs$core$IFn$_invoke$arity$3(p1__158506_SHARP_,k,com.wsscode.pathom3.connect.runner.process_attr_subquery(env,cljs.core.PersistentArrayMap.EMPTY,k,cljs.core.assoc.cljs$core$IFn$_invoke$arity$3(cljs.core.get.cljs$core$IFn$_invoke$arity$2(p1__158506_SHARP_,k),cljs.core.first(k),cljs.core.second(k))));
});})(seq__158507,chunk__158508,count__158509,i__158510,k))
);


var G__158745 = seq__158507;
var G__158746 = chunk__158508;
var G__158747 = count__158509;
var G__158748 = (i__158510 + (1));
seq__158507 = G__158745;
chunk__158508 = G__158746;
count__158509 = G__158747;
i__158510 = G__158748;
continue;
} else {
var temp__5753__auto__ = cljs.core.seq(seq__158507);
if(temp__5753__auto__){
var seq__158507__$1 = temp__5753__auto__;
if(cljs.core.chunked_seq_QMARK_(seq__158507__$1)){
var c__4649__auto__ = cljs.core.chunk_first(seq__158507__$1);
var G__158749 = cljs.core.chunk_rest(seq__158507__$1);
var G__158750 = c__4649__auto__;
var G__158751 = cljs.core.count(c__4649__auto__);
var G__158752 = (0);
seq__158507 = G__158749;
chunk__158508 = G__158750;
count__158509 = G__158751;
i__158510 = G__158752;
continue;
} else {
var k = cljs.core.first(seq__158507__$1);
com.wsscode.pathom3.entity_tree.swap_entity_BANG_.cljs$core$IFn$_invoke$arity$2(env,((function (seq__158507,chunk__158508,count__158509,i__158510,k,seq__158507__$1,temp__5753__auto__){
return (function (p1__158506_SHARP_){
return cljs.core.assoc.cljs$core$IFn$_invoke$arity$3(p1__158506_SHARP_,k,com.wsscode.pathom3.connect.runner.process_attr_subquery(env,cljs.core.PersistentArrayMap.EMPTY,k,cljs.core.assoc.cljs$core$IFn$_invoke$arity$3(cljs.core.get.cljs$core$IFn$_invoke$arity$2(p1__158506_SHARP_,k),cljs.core.first(k),cljs.core.second(k))));
});})(seq__158507,chunk__158508,count__158509,i__158510,k,seq__158507__$1,temp__5753__auto__))
);


var G__158757 = cljs.core.next(seq__158507__$1);
var G__158758 = null;
var G__158759 = (0);
var G__158760 = (0);
seq__158507 = G__158757;
chunk__158508 = G__158758;
count__158509 = G__158759;
i__158510 = G__158760;
continue;
}
} else {
return null;
}
}
break;
}
});
/**
 * Runs the next node associated with the node, in case it exists.
 */
com.wsscode.pathom3.connect.runner.run_next_node_BANG_ = (function com$wsscode$pathom3$connect$runner$run_next_node_BANG_(p__158515,p__158516){
var map__158517 = p__158515;
var map__158517__$1 = cljs.core.__destructure_map(map__158517);
var env = map__158517__$1;
var graph = cljs.core.get.cljs$core$IFn$_invoke$arity$2(map__158517__$1,new cljs.core.Keyword("com.wsscode.pathom3.connect.planner","graph","com.wsscode.pathom3.connect.planner/graph",-1915509744));
var map__158518 = p__158516;
var map__158518__$1 = cljs.core.__destructure_map(map__158518);
var run_next = cljs.core.get.cljs$core$IFn$_invoke$arity$2(map__158518__$1,new cljs.core.Keyword("com.wsscode.pathom3.connect.planner","run-next","com.wsscode.pathom3.connect.planner/run-next",285457140));
if(cljs.core.truth_(run_next)){
var G__158519 = env;
var G__158520 = com.wsscode.pathom3.connect.planner.get_node.cljs$core$IFn$_invoke$arity$2(graph,run_next);
return (com.wsscode.pathom3.connect.runner.run_node_BANG_.cljs$core$IFn$_invoke$arity$2 ? com.wsscode.pathom3.connect.runner.run_node_BANG_.cljs$core$IFn$_invoke$arity$2(G__158519,G__158520) : com.wsscode.pathom3.connect.runner.run_node_BANG_.call(null,G__158519,G__158520));
} else {
return null;
}
});
com.wsscode.pathom3.connect.runner.merge_node_stats_BANG_ = (function com$wsscode$pathom3$connect$runner$merge_node_stats_BANG_(p__158521,p__158522,data){
var map__158523 = p__158521;
var map__158523__$1 = cljs.core.__destructure_map(map__158523);
var node_run_stats_STAR_ = cljs.core.get.cljs$core$IFn$_invoke$arity$2(map__158523__$1,new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","node-run-stats*","com.wsscode.pathom3.connect.runner/node-run-stats*",453579030));
var map__158524 = p__158522;
var map__158524__$1 = cljs.core.__destructure_map(map__158524);
var node_id = cljs.core.get.cljs$core$IFn$_invoke$arity$2(map__158524__$1,new cljs.core.Keyword("com.wsscode.pathom3.connect.planner","node-id","com.wsscode.pathom3.connect.planner/node-id",1696523707));
if(cljs.core.truth_(node_run_stats_STAR_)){
return com.wsscode.misc.refs.gswap_BANG_.cljs$core$IFn$_invoke$arity$variadic(node_run_stats_STAR_,cljs.core.update,node_id,com.wsscode.misc.coll.merge_defaults,cljs.core.prim_seq.cljs$core$IFn$_invoke$arity$2([data], 0));
} else {
return null;
}
});
com.wsscode.pathom3.connect.runner.merge_mutation_stats_BANG_ = (function com$wsscode$pathom3$connect$runner$merge_mutation_stats_BANG_(p__158525,p__158526,data){
var map__158527 = p__158525;
var map__158527__$1 = cljs.core.__destructure_map(map__158527);
var node_run_stats_STAR_ = cljs.core.get.cljs$core$IFn$_invoke$arity$2(map__158527__$1,new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","node-run-stats*","com.wsscode.pathom3.connect.runner/node-run-stats*",453579030));
var map__158528 = p__158526;
var map__158528__$1 = cljs.core.__destructure_map(map__158528);
var op_name = cljs.core.get.cljs$core$IFn$_invoke$arity$2(map__158528__$1,new cljs.core.Keyword("com.wsscode.pathom3.connect.operation","op-name","com.wsscode.pathom3.connect.operation/op-name",-1249801049));
if(cljs.core.truth_(node_run_stats_STAR_)){
return com.wsscode.misc.refs.gswap_BANG_.cljs$core$IFn$_invoke$arity$variadic(node_run_stats_STAR_,cljs.core.update,op_name,com.wsscode.misc.coll.merge_defaults,cljs.core.prim_seq.cljs$core$IFn$_invoke$arity$2([data], 0));
} else {
return null;
}
});
com.wsscode.pathom3.connect.runner.mark_resolver_error = (function com$wsscode$pathom3$connect$runner$mark_resolver_error(p__158529,p__158530,error){
var map__158531 = p__158529;
var map__158531__$1 = cljs.core.__destructure_map(map__158531);
var node_run_stats_STAR_ = cljs.core.get.cljs$core$IFn$_invoke$arity$2(map__158531__$1,new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","node-run-stats*","com.wsscode.pathom3.connect.runner/node-run-stats*",453579030));
var map__158532 = p__158530;
var map__158532__$1 = cljs.core.__destructure_map(map__158532);
var node_id = cljs.core.get.cljs$core$IFn$_invoke$arity$2(map__158532__$1,new cljs.core.Keyword("com.wsscode.pathom3.connect.planner","node-id","com.wsscode.pathom3.connect.planner/node-id",1696523707));
if(cljs.core.truth_(node_run_stats_STAR_)){
var G__158533 = node_run_stats_STAR_;
com.wsscode.misc.refs.gswap_BANG_.cljs$core$IFn$_invoke$arity$4(G__158533,cljs.core.assoc_in,new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [node_id,new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","node-error","com.wsscode.pathom3.connect.runner/node-error",890120380)], null),error);

com.wsscode.misc.refs.gswap_BANG_.cljs$core$IFn$_invoke$arity$variadic(G__158533,cljs.core.update,new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","nodes-with-error","com.wsscode.pathom3.connect.runner/nodes-with-error",-1230963295),com.wsscode.misc.coll.sconj,cljs.core.prim_seq.cljs$core$IFn$_invoke$arity$2([node_id], 0));

return G__158533;
} else {
return null;
}
});
com.wsscode.pathom3.connect.runner.mark_resolver_error_with_plugins = (function com$wsscode$pathom3$connect$runner$mark_resolver_error_with_plugins(env,node,e){
return com.wsscode.pathom3.plugin.run_with_plugins.cljs$core$IFn$_invoke$arity$6(env,new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","wrap-resolver-error","com.wsscode.pathom3.connect.runner/wrap-resolver-error",-1230614515),com.wsscode.pathom3.connect.runner.mark_resolver_error,env,node,e);
});
com.wsscode.pathom3.connect.runner.choose_cache_store = (function com$wsscode$pathom3$connect$runner$choose_cache_store(env,cache_store){
if(cljs.core.truth_(cache_store)){
if(cljs.core.contains_QMARK_(env,cache_store)){
return cache_store;
} else {
com.wsscode.log.log_event(com.wsscode.log._STAR_active_logger_STAR_,com.wsscode.log.make_event(new cljs.core.Keyword("com.wsscode.log","level-warn","com.wsscode.log/level-warn",312686542),new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","event-attempt-use-undefined-cache-store","com.wsscode.pathom3.connect.runner/event-attempt-use-undefined-cache-store",1467123936),new cljs.core.PersistentArrayMap(null, 1, [new cljs.core.Keyword("com.wsscode.pathom3.connect.operation","cache-store","com.wsscode.pathom3.connect.operation/cache-store",1503197377),cache_store], null)));

return new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","resolver-cache*","com.wsscode.pathom3.connect.runner/resolver-cache*",334664084);
}
} else {
return new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","resolver-cache*","com.wsscode.pathom3.connect.runner/resolver-cache*",334664084);
}
});
com.wsscode.pathom3.connect.runner.report_resolver_io_stats = (function com$wsscode$pathom3$connect$runner$report_resolver_io_stats(p__158534,input_data,result){
var map__158535 = p__158534;
var map__158535__$1 = cljs.core.__destructure_map(map__158535);
var run_stats_omit_resolver_io_QMARK_ = cljs.core.get.cljs$core$IFn$_invoke$arity$2(map__158535__$1,new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","run-stats-omit-resolver-io?","com.wsscode.pathom3.connect.runner/run-stats-omit-resolver-io?",743939109));
if(cljs.core.truth_(run_stats_omit_resolver_io_QMARK_)){
return new cljs.core.PersistentArrayMap(null, 2, [new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","node-resolver-input-shape","com.wsscode.pathom3.connect.runner/node-resolver-input-shape",470286423),com.wsscode.pathom3.format.shape_descriptor.data__GT_shape_descriptor(input_data),new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","node-resolver-output-shape","com.wsscode.pathom3.connect.runner/node-resolver-output-shape",1837913870),com.wsscode.pathom3.format.shape_descriptor.data__GT_shape_descriptor(result)], null);
} else {
return new cljs.core.PersistentArrayMap(null, 2, [new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","node-resolver-input","com.wsscode.pathom3.connect.runner/node-resolver-input",-1558799633),input_data,new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","node-resolver-output","com.wsscode.pathom3.connect.runner/node-resolver-output",800199202),(cljs.core.truth_(new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","batch-hold","com.wsscode.pathom3.connect.runner/batch-hold",-364021743).cljs$core$IFn$_invoke$arity$1(result))?new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","batch-hold","com.wsscode.pathom3.connect.runner/batch-hold",-364021743):result)], null);
}
});
com.wsscode.pathom3.connect.runner.missing_maybe_in_pending_batch_QMARK_ = (function com$wsscode$pathom3$connect$runner$missing_maybe_in_pending_batch_QMARK_(p__158537,input){
var map__158538 = p__158537;
var map__158538__$1 = cljs.core.__destructure_map(map__158538);
var env = map__158538__$1;
var path = cljs.core.get.cljs$core$IFn$_invoke$arity$2(map__158538__$1,new cljs.core.Keyword("com.wsscode.pathom3.path","path","com.wsscode.pathom3.path/path",1029673558));
var nested_inputs = com.wsscode.misc.coll.filter_vals(cljs.core.seq,input);
if(cljs.core.seq(nested_inputs)){
var pending_nested_QMARK_ = cljs.core.some((function (path_SINGLEQUOTE_){
return cljs.core.contains_QMARK_(nested_inputs,cljs.core.first(path_SINGLEQUOTE_));
}),cljs.core.map.cljs$core$IFn$_invoke$arity$2(cljs.core.comp.cljs$core$IFn$_invoke$arity$3((function (p1__158536_SHARP_){
return cljs.core.subvec.cljs$core$IFn$_invoke$arity$2(p1__158536_SHARP_,cljs.core.count(path));
}),new cljs.core.Keyword("com.wsscode.pathom3.path","path","com.wsscode.pathom3.path/path",1029673558),new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","env","com.wsscode.pathom3.connect.runner/env",-1421599428)),cljs.core.into.cljs$core$IFn$_invoke$arity$3(cljs.core.PersistentVector.EMPTY,cljs.core.cat,cljs.core.vals(cljs.core.deref(new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","batch-pending*","com.wsscode.pathom3.connect.runner/batch-pending*",898520706).cljs$core$IFn$_invoke$arity$1(env))))));
return pending_nested_QMARK_;
} else {
return false;
}
});
com.wsscode.pathom3.connect.runner.wait_batch_response = (function com$wsscode$pathom3$connect$runner$wait_batch_response(env,node){
return new cljs.core.PersistentArrayMap(null, 1, [new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","batch-hold","com.wsscode.pathom3.connect.runner/batch-hold",-364021743),new cljs.core.PersistentArrayMap(null, 3, [new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","env","com.wsscode.pathom3.connect.runner/env",-1421599428),env,new cljs.core.Keyword("com.wsscode.pathom3.connect.planner","node","com.wsscode.pathom3.connect.planner/node",325156565),node,new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","nested-waiting?","com.wsscode.pathom3.connect.runner/nested-waiting?",820889396),true], null)], null);
});
com.wsscode.pathom3.connect.runner.invoke_resolver_cached = (function com$wsscode$pathom3$connect$runner$invoke_resolver_cached(env,cache_QMARK_,op_name,resolver,cache_store,input_data,params){
if(cljs.core.truth_(cache_QMARK_)){
return com.wsscode.pathom3.cache.cached(cache_store,env,new cljs.core.PersistentVector(null, 3, 5, cljs.core.PersistentVector.EMPTY_NODE, [op_name,input_data,params], null),(function (){
return com.wsscode.pathom3.connect.operation.protocols._resolve(resolver,env,input_data);
}));
} else {
return com.wsscode.pathom3.connect.operation.protocols._resolve(resolver,env,input_data);
}
});
com.wsscode.pathom3.connect.runner.warn_batch_unsupported = (function com$wsscode$pathom3$connect$runner$warn_batch_unsupported(env,op_name){
return com.wsscode.log.log_event(com.wsscode.log._STAR_active_logger_STAR_,com.wsscode.log.make_event(new cljs.core.Keyword("com.wsscode.log","level-warn","com.wsscode.log/level-warn",312686542),new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","event-batch-unsupported","com.wsscode.pathom3.connect.runner/event-batch-unsupported",1324438337),new cljs.core.PersistentArrayMap(null, 2, [new cljs.core.Keyword("com.wsscode.pathom3.path","path","com.wsscode.pathom3.path/path",1029673558),new cljs.core.Keyword("com.wsscode.pathom3.path","path","com.wsscode.pathom3.path/path",1029673558).cljs$core$IFn$_invoke$arity$1(env),new cljs.core.Keyword("com.wsscode.pathom3.connect.operation","op-name","com.wsscode.pathom3.connect.operation/op-name",-1249801049),op_name], null)));
});
com.wsscode.pathom3.connect.runner.invoke_resolver_cached_batch = (function com$wsscode$pathom3$connect$runner$invoke_resolver_cached_batch(env,cache_QMARK_,op_name,resolver,cache_store,input_data,params){
com.wsscode.pathom3.connect.runner.warn_batch_unsupported(env,op_name);

if(cljs.core.truth_(cache_QMARK_)){
return com.wsscode.pathom3.cache.cached(cache_store,env,new cljs.core.PersistentVector(null, 3, 5, cljs.core.PersistentVector.EMPTY_NODE, [op_name,input_data,params], null),(function (){
return cljs.core.first(com.wsscode.pathom3.connect.operation.protocols._resolve(resolver,env,new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [input_data], null)));
}));
} else {
return cljs.core.first(com.wsscode.pathom3.connect.operation.protocols._resolve(resolver,env,new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [input_data], null)));
}
});
com.wsscode.pathom3.connect.runner.batch_hold_token = (function com$wsscode$pathom3$connect$runner$batch_hold_token(env,cache_QMARK_,op_name,node,cache_store,input_data){
return new cljs.core.PersistentArrayMap(null, 1, [new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","batch-hold","com.wsscode.pathom3.connect.runner/batch-hold",-364021743),new cljs.core.PersistentArrayMap(null, 6, [new cljs.core.Keyword("com.wsscode.pathom3.connect.operation","op-name","com.wsscode.pathom3.connect.operation/op-name",-1249801049),op_name,new cljs.core.Keyword("com.wsscode.pathom3.connect.planner","node","com.wsscode.pathom3.connect.planner/node",325156565),node,new cljs.core.Keyword("com.wsscode.pathom3.connect.operation","cache?","com.wsscode.pathom3.connect.operation/cache?",575940493),cache_QMARK_,new cljs.core.Keyword("com.wsscode.pathom3.connect.operation","cache-store","com.wsscode.pathom3.connect.operation/cache-store",1503197377),cache_store,new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","node-resolver-input","com.wsscode.pathom3.connect.runner/node-resolver-input",-1558799633),input_data,new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","env","com.wsscode.pathom3.connect.runner/env",-1421599428),env], null)], null);
});
com.wsscode.pathom3.connect.runner.valid_response_QMARK_ = (function com$wsscode$pathom3$connect$runner$valid_response_QMARK_(x){
return ((cljs.core.map_QMARK_(x)) || ((((x == null)) || (com.wsscode.misc.refs.kw_identical_QMARK_(x,new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","node-error","com.wsscode.pathom3.connect.runner/node-error",890120380))))));
});
/**
 * Evaluates a resolver using node information.
 * 
 *   When this function runs the resolver, if filters the data to only include the keys
 *   mentioned by the resolver input. This is important to ensure that the resolver is
 *   not using some key that came accidentally due to execution order, that would lead to
 *   brittle executions.
 */
com.wsscode.pathom3.connect.runner.invoke_resolver_from_node = (function com$wsscode$pathom3$connect$runner$invoke_resolver_from_node(env,p__158539){
var map__158540 = p__158539;
var map__158540__$1 = cljs.core.__destructure_map(map__158540);
var node = map__158540__$1;
var op_name = cljs.core.get.cljs$core$IFn$_invoke$arity$2(map__158540__$1,new cljs.core.Keyword("com.wsscode.pathom3.connect.operation","op-name","com.wsscode.pathom3.connect.operation/op-name",-1249801049));
var input = cljs.core.get.cljs$core$IFn$_invoke$arity$2(map__158540__$1,new cljs.core.Keyword("com.wsscode.pathom3.connect.planner","input","com.wsscode.pathom3.connect.planner/input",1912157524));
var resolver = com.wsscode.pathom3.connect.indexes.resolver(env,op_name);
var map__158541 = com.wsscode.pathom3.connect.operation.operation_config(resolver);
var map__158541__$1 = cljs.core.__destructure_map(map__158541);
var op_name__$1 = cljs.core.get.cljs$core$IFn$_invoke$arity$2(map__158541__$1,new cljs.core.Keyword("com.wsscode.pathom3.connect.operation","op-name","com.wsscode.pathom3.connect.operation/op-name",-1249801049));
var batch_QMARK_ = cljs.core.get.cljs$core$IFn$_invoke$arity$2(map__158541__$1,new cljs.core.Keyword("com.wsscode.pathom3.connect.operation","batch?","com.wsscode.pathom3.connect.operation/batch?",1500979317));
var cache_QMARK_ = cljs.core.get.cljs$core$IFn$_invoke$arity$3(map__158541__$1,new cljs.core.Keyword("com.wsscode.pathom3.connect.operation","cache?","com.wsscode.pathom3.connect.operation/cache?",575940493),true);
var cache_store = cljs.core.get.cljs$core$IFn$_invoke$arity$2(map__158541__$1,new cljs.core.Keyword("com.wsscode.pathom3.connect.operation","cache-store","com.wsscode.pathom3.connect.operation/cache-store",1503197377));
var optionals = cljs.core.get.cljs$core$IFn$_invoke$arity$2(map__158541__$1,new cljs.core.Keyword("com.wsscode.pathom3.connect.operation","optionals","com.wsscode.pathom3.connect.operation/optionals",1880951663));
var env__$1 = cljs.core.assoc.cljs$core$IFn$_invoke$arity$3(env,new cljs.core.Keyword("com.wsscode.pathom3.connect.planner","node","com.wsscode.pathom3.connect.planner/node",325156565),node);
var entity = com.wsscode.pathom3.entity_tree.entity(env__$1);
var input_data = com.wsscode.pathom3.format.shape_descriptor.select_shape_filtering.cljs$core$IFn$_invoke$arity$3(entity,com.wsscode.pathom3.format.shape_descriptor.merge_shapes.cljs$core$IFn$_invoke$arity$2(input,optionals),input);
var input_shape = com.wsscode.pathom3.format.shape_descriptor.data__GT_shape_descriptor(input_data);
var params = com.wsscode.pathom3.connect.operation.params(env__$1);
var cache_store__$1 = com.wsscode.pathom3.connect.runner.choose_cache_store(env__$1,cache_store);
var resolver_cache_STAR_ = cljs.core.get.cljs$core$IFn$_invoke$arity$2(env__$1,cache_store__$1);
var _ = com.wsscode.pathom3.connect.runner.merge_node_stats_BANG_(env__$1,node,new cljs.core.PersistentArrayMap(null, 1, [new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","resolver-run-start-ms","com.wsscode.pathom3.connect.runner/resolver-run-start-ms",213921287),com.wsscode.misc.time.now_ms()], null));
var result = (function (){try{if(cljs.core.truth_(com.wsscode.pathom3.format.shape_descriptor.missing.cljs$core$IFn$_invoke$arity$3(input_shape,input,entity))){
if(cljs.core.truth_(com.wsscode.pathom3.connect.runner.missing_maybe_in_pending_batch_QMARK_(env__$1,input))){
return com.wsscode.pathom3.connect.runner.wait_batch_response(env__$1,node);
} else {
throw cljs.core.ex_info.cljs$core$IFn$_invoke$arity$2("Insufficient data",new cljs.core.PersistentArrayMap(null, 2, [new cljs.core.Keyword(null,"required","required",1807647006),input,new cljs.core.Keyword(null,"available","available",-1470697127),input_shape], null));
}
} else {
if(cljs.core.truth_(batch_QMARK_)){
var temp__5751__auto__ = com.wsscode.pathom3.cache.cache_find(resolver_cache_STAR_,new cljs.core.PersistentVector(null, 3, 5, cljs.core.PersistentVector.EMPTY_NODE, [op_name__$1,input_data,params], null));
if(cljs.core.truth_(temp__5751__auto__)){
var x = temp__5751__auto__;
return cljs.core.val(x);
} else {
if(cljs.core.truth_(new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","unsupported-batch?","com.wsscode.pathom3.connect.runner/unsupported-batch?",-826939500).cljs$core$IFn$_invoke$arity$1(env__$1))){
return com.wsscode.pathom3.connect.runner.invoke_resolver_cached_batch(env__$1,cache_QMARK_,op_name__$1,resolver,cache_store__$1,input_data,params);
} else {
return com.wsscode.pathom3.connect.runner.batch_hold_token(env__$1,cache_QMARK_,op_name__$1,node,cache_store__$1,input_data);
}
}
} else {
return com.wsscode.pathom3.connect.runner.invoke_resolver_cached(env__$1,cache_QMARK_,op_name__$1,resolver,cache_store__$1,input_data,params);

}
}
}catch (e158542){var e = e158542;
com.wsscode.pathom3.connect.runner.mark_resolver_error_with_plugins(env__$1,node,e);

return new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","node-error","com.wsscode.pathom3.connect.runner/node-error",890120380);
}})();
var finish = com.wsscode.misc.time.now_ms();
if((!(com.wsscode.pathom3.connect.runner.valid_response_QMARK_(result)))){
com.wsscode.log.log_event(com.wsscode.log._STAR_active_logger_STAR_,com.wsscode.log.make_event(new cljs.core.Keyword("com.wsscode.log","level-warn","com.wsscode.log/level-warn",312686542),new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","invalid-resolver-response","com.wsscode.pathom3.connect.runner/invalid-resolver-response",-1719231556),new cljs.core.PersistentArrayMap(null, 2, [new cljs.core.Keyword("com.wsscode.pathom3.connect.operation","op-name","com.wsscode.pathom3.connect.operation/op-name",-1249801049),op_name__$1,new cljs.core.Keyword(null,"response","response",-1068424192),result], null)));
} else {
}

com.wsscode.pathom3.connect.runner.merge_node_stats_BANG_(env__$1,node,(function (){var G__158543 = new cljs.core.PersistentArrayMap(null, 1, [new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","resolver-run-finish-ms","com.wsscode.pathom3.connect.runner/resolver-run-finish-ms",375193860),finish], null);
if(cljs.core.not(new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","batch-hold","com.wsscode.pathom3.connect.runner/batch-hold",-364021743).cljs$core$IFn$_invoke$arity$1(result))){
return cljs.core.merge.cljs$core$IFn$_invoke$arity$variadic(cljs.core.prim_seq.cljs$core$IFn$_invoke$arity$2([G__158543,com.wsscode.pathom3.connect.runner.report_resolver_io_stats(env__$1,input_data,result)], 0));
} else {
return G__158543;
}
})());

return result;
});
/**
 * This function evaluates the resolver associated with the node.
 * 
 *   First it checks if the expected results from the resolver are already available. In
 *   case they are, the resolver call is skipped.
 */
com.wsscode.pathom3.connect.runner.run_resolver_node_BANG_ = (function com$wsscode$pathom3$connect$runner$run_resolver_node_BANG_(env,node){
if(com.wsscode.pathom3.connect.runner.all_requires_ready_QMARK_(env,node)){
return com.wsscode.pathom3.connect.runner.run_next_node_BANG_(env,node);
} else {
var _ = com.wsscode.pathom3.connect.runner.merge_node_stats_BANG_(env,node,new cljs.core.PersistentArrayMap(null, 1, [new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","node-run-start-ms","com.wsscode.pathom3.connect.runner/node-run-start-ms",-2130582528),com.wsscode.misc.time.now_ms()], null));
var map__158544 = com.wsscode.pathom3.plugin.run_with_plugins.cljs$core$IFn$_invoke$arity$5(env,new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","wrap-resolve","com.wsscode.pathom3.connect.runner/wrap-resolve",-1315168003),com.wsscode.pathom3.connect.runner.invoke_resolver_from_node,env,node);
var map__158544__$1 = cljs.core.__destructure_map(map__158544);
var response = map__158544__$1;
var batch_hold = cljs.core.get.cljs$core$IFn$_invoke$arity$2(map__158544__$1,new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","batch-hold","com.wsscode.pathom3.connect.runner/batch-hold",-364021743));
if(cljs.core.truth_(batch_hold)){
return response;
} else {
if((!(com.wsscode.misc.refs.kw_identical_QMARK_(new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","node-error","com.wsscode.pathom3.connect.runner/node-error",890120380),response)))){
com.wsscode.pathom3.connect.runner.merge_resolver_response_BANG_(env,response);

com.wsscode.pathom3.connect.runner.merge_node_stats_BANG_(env,node,new cljs.core.PersistentArrayMap(null, 1, [new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","node-run-finish-ms","com.wsscode.pathom3.connect.runner/node-run-finish-ms",1292429944),com.wsscode.misc.time.now_ms()], null));

return com.wsscode.pathom3.connect.runner.run_next_node_BANG_(env,node);
} else {
com.wsscode.pathom3.connect.runner.merge_node_stats_BANG_(env,node,new cljs.core.PersistentArrayMap(null, 1, [new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","node-run-finish-ms","com.wsscode.pathom3.connect.runner/node-run-finish-ms",1292429944),com.wsscode.misc.time.now_ms()], null));

return null;

}
}
}
});
/**
 * Sort nodes based on the priority of the node successors. This scans all successors
 *   and choose which one has a node with the highest priority number.
 * 
 *   Returns the paths and their highest priority, in order with the highest priority as
 *   first. For example:
 * 
 *    [[4 [2 1]] [6 [1]]]
 * 
 *   Means the first path is choosing node-id 4, and highest priority is 2.
 */
com.wsscode.pathom3.connect.runner.priority_sort = (function com$wsscode$pathom3$connect$runner$priority_sort(p__158551,node_ids){
var map__158552 = p__158551;
var map__158552__$1 = cljs.core.__destructure_map(map__158552);
var env = map__158552__$1;
var graph = cljs.core.get.cljs$core$IFn$_invoke$arity$2(map__158552__$1,new cljs.core.Keyword("com.wsscode.pathom3.connect.planner","graph","com.wsscode.pathom3.connect.planner/graph",-1915509744));
var paths = cljs.core.mapv.cljs$core$IFn$_invoke$arity$2((function (nid){
return new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [nid,cljs.core.vec(cljs.core.sort.cljs$core$IFn$_invoke$arity$2((function (p1__158548_SHARP_,p2__158547_SHARP_){
return cljs.core.compare(p2__158547_SHARP_,p1__158548_SHARP_);
}),cljs.core.distinct.cljs$core$IFn$_invoke$arity$1(cljs.core.map.cljs$core$IFn$_invoke$arity$2((function (p1__158546_SHARP_){
var or__4223__auto__ = new cljs.core.Keyword("com.wsscode.pathom3.connect.operation","priority","com.wsscode.pathom3.connect.operation/priority",-813904543).cljs$core$IFn$_invoke$arity$1(p1__158546_SHARP_);
if(cljs.core.truth_(or__4223__auto__)){
return or__4223__auto__;
} else {
return (0);
}
}),cljs.core.keep.cljs$core$IFn$_invoke$arity$2((function (p1__158545_SHARP_){
return com.wsscode.pathom3.connect.planner.node_with_resolver_config(graph,env,p1__158545_SHARP_);
}),com.wsscode.pathom3.connect.planner.node_successors(graph,nid))))))], null);
}),node_ids);
return cljs.core.sort_by.cljs$core$IFn$_invoke$arity$3(cljs.core.second,(function (p1__158550_SHARP_,p2__158549_SHARP_){
return com.wsscode.misc.coll.vector_compare(p2__158549_SHARP_,p1__158550_SHARP_);
}),paths);
});
com.wsscode.pathom3.connect.runner.default_choose_path = (function com$wsscode$pathom3$connect$runner$default_choose_path(env,_or_node,node_ids){
return cljs.core.ffirst(com.wsscode.pathom3.connect.runner.priority_sort(env,node_ids));
});
com.wsscode.pathom3.connect.runner.add_taken_path_BANG_ = (function com$wsscode$pathom3$connect$runner$add_taken_path_BANG_(p__158553,p__158554,taken_path_id){
var map__158555 = p__158553;
var map__158555__$1 = cljs.core.__destructure_map(map__158555);
var node_run_stats_STAR_ = cljs.core.get.cljs$core$IFn$_invoke$arity$2(map__158555__$1,new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","node-run-stats*","com.wsscode.pathom3.connect.runner/node-run-stats*",453579030));
var map__158556 = p__158554;
var map__158556__$1 = cljs.core.__destructure_map(map__158556);
var node_id = cljs.core.get.cljs$core$IFn$_invoke$arity$2(map__158556__$1,new cljs.core.Keyword("com.wsscode.pathom3.connect.planner","node-id","com.wsscode.pathom3.connect.planner/node-id",1696523707));
return com.wsscode.misc.refs.gswap_BANG_.cljs$core$IFn$_invoke$arity$variadic(node_run_stats_STAR_,cljs.core.update_in,new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [node_id,new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","taken-paths","com.wsscode.pathom3.connect.runner/taken-paths",-1349641664)], null),com.wsscode.misc.coll.vconj,cljs.core.prim_seq.cljs$core$IFn$_invoke$arity$2([taken_path_id], 0));
});
com.wsscode.pathom3.connect.runner.run_or_node_BANG_ = (function com$wsscode$pathom3$connect$runner$run_or_node_BANG_(p__158558,p__158559){
var map__158560 = p__158558;
var map__158560__$1 = cljs.core.__destructure_map(map__158560);
var env = map__158560__$1;
var graph = cljs.core.get.cljs$core$IFn$_invoke$arity$2(map__158560__$1,new cljs.core.Keyword("com.wsscode.pathom3.connect.planner","graph","com.wsscode.pathom3.connect.planner/graph",-1915509744));
var choose_path = cljs.core.get.cljs$core$IFn$_invoke$arity$3(map__158560__$1,new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","choose-path","com.wsscode.pathom3.connect.runner/choose-path",-251774625),com.wsscode.pathom3.connect.runner.default_choose_path);
var map__158561 = p__158559;
var map__158561__$1 = cljs.core.__destructure_map(map__158561);
var or_node = map__158561__$1;
var run_or = cljs.core.get.cljs$core$IFn$_invoke$arity$2(map__158561__$1,new cljs.core.Keyword("com.wsscode.pathom3.connect.planner","run-or","com.wsscode.pathom3.connect.planner/run-or",-672801891));
com.wsscode.pathom3.connect.runner.merge_node_stats_BANG_(env,or_node,new cljs.core.PersistentArrayMap(null, 1, [new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","node-run-start-ms","com.wsscode.pathom3.connect.runner/node-run-start-ms",-2130582528),com.wsscode.misc.time.now_ms()], null));

var res = (((!(com.wsscode.pathom3.connect.runner.all_requires_ready_QMARK_(env,or_node))))?(function (){var nodes = run_or;
while(true){
if(cljs.core.seq(nodes)){
var picked_node_id = (choose_path.cljs$core$IFn$_invoke$arity$3 ? choose_path.cljs$core$IFn$_invoke$arity$3(env,or_node,nodes) : choose_path.call(null,env,or_node,nodes));
var node_id = ((cljs.core.contains_QMARK_(nodes,picked_node_id))?picked_node_id:(function (){
com.wsscode.log.log_event(com.wsscode.log._STAR_active_logger_STAR_,com.wsscode.log.make_event(new cljs.core.Keyword("com.wsscode.log","level-warn","com.wsscode.log/level-warn",312686542),new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","event-invalid-chosen-path","com.wsscode.pathom3.connect.runner/event-invalid-chosen-path",646160441),new cljs.core.PersistentArrayMap(null, 3, [new cljs.core.Keyword(null,"expected-one-of","expected-one-of",2046658893),nodes,new cljs.core.Keyword(null,"chosen-attempt","chosen-attempt",-1651171103),picked_node_id,new cljs.core.Keyword(null,"actual-used","actual-used",-2136040608),cljs.core.first(nodes)], null)));

return cljs.core.first(nodes);
})()
);
com.wsscode.pathom3.connect.runner.add_taken_path_BANG_(env,or_node,node_id);

var res = (function (){var G__158568 = env;
var G__158569 = com.wsscode.pathom3.connect.planner.get_node.cljs$core$IFn$_invoke$arity$2(graph,node_id);
return (com.wsscode.pathom3.connect.runner.run_node_BANG_.cljs$core$IFn$_invoke$arity$2 ? com.wsscode.pathom3.connect.runner.run_node_BANG_.cljs$core$IFn$_invoke$arity$2(G__158568,G__158569) : com.wsscode.pathom3.connect.runner.run_node_BANG_.call(null,G__158568,G__158569));
})();
if(cljs.core.truth_(new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","batch-hold","com.wsscode.pathom3.connect.runner/batch-hold",-364021743).cljs$core$IFn$_invoke$arity$1(res))){
return res;
} else {
if(com.wsscode.pathom3.connect.runner.all_requires_ready_QMARK_(env,or_node)){
return com.wsscode.pathom3.connect.runner.merge_node_stats_BANG_(env,or_node,new cljs.core.PersistentArrayMap(null, 1, [new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","success-path","com.wsscode.pathom3.connect.runner/success-path",1003623091),node_id], null));
} else {
var G__158772 = cljs.core.disj.cljs$core$IFn$_invoke$arity$2(nodes,node_id);
nodes = G__158772;
continue;
}
}
} else {
return null;
}
break;
}
})():null);
if(cljs.core.truth_(new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","batch-hold","com.wsscode.pathom3.connect.runner/batch-hold",-364021743).cljs$core$IFn$_invoke$arity$1(res))){
return res;
} else {
com.wsscode.pathom3.connect.runner.merge_node_stats_BANG_(env,or_node,new cljs.core.PersistentArrayMap(null, 1, [new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","node-run-finish-ms","com.wsscode.pathom3.connect.runner/node-run-finish-ms",1292429944),com.wsscode.misc.time.now_ms()], null));

return com.wsscode.pathom3.connect.runner.run_next_node_BANG_(env,or_node);
}
});
/**
 * Given an AND node, runs every attached node, then runs the attached next.
 */
com.wsscode.pathom3.connect.runner.run_and_node_BANG_ = (function com$wsscode$pathom3$connect$runner$run_and_node_BANG_(p__158570,p__158571){
var map__158572 = p__158570;
var map__158572__$1 = cljs.core.__destructure_map(map__158572);
var env = map__158572__$1;
var graph = cljs.core.get.cljs$core$IFn$_invoke$arity$2(map__158572__$1,new cljs.core.Keyword("com.wsscode.pathom3.connect.planner","graph","com.wsscode.pathom3.connect.planner/graph",-1915509744));
var map__158573 = p__158571;
var map__158573__$1 = cljs.core.__destructure_map(map__158573);
var and_node = map__158573__$1;
var run_and = cljs.core.get.cljs$core$IFn$_invoke$arity$2(map__158573__$1,new cljs.core.Keyword("com.wsscode.pathom3.connect.planner","run-and","com.wsscode.pathom3.connect.planner/run-and",-1356844884));
com.wsscode.pathom3.connect.runner.merge_node_stats_BANG_(env,and_node,new cljs.core.PersistentArrayMap(null, 1, [new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","node-run-start-ms","com.wsscode.pathom3.connect.runner/node-run-start-ms",-2130582528),com.wsscode.misc.time.now_ms()], null));

var res = cljs.core.reduce.cljs$core$IFn$_invoke$arity$3((function (_,node_id){
var node_res = (function (){var G__158578 = env;
var G__158579 = com.wsscode.pathom3.connect.planner.get_node.cljs$core$IFn$_invoke$arity$2(graph,node_id);
return (com.wsscode.pathom3.connect.runner.run_node_BANG_.cljs$core$IFn$_invoke$arity$2 ? com.wsscode.pathom3.connect.runner.run_node_BANG_.cljs$core$IFn$_invoke$arity$2(G__158578,G__158579) : com.wsscode.pathom3.connect.runner.run_node_BANG_.call(null,G__158578,G__158579));
})();
if(cljs.core.truth_(new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","batch-hold","com.wsscode.pathom3.connect.runner/batch-hold",-364021743).cljs$core$IFn$_invoke$arity$1(node_res))){
return cljs.core.reduced(node_res);
} else {
return null;
}
}),null,run_and);
if(cljs.core.truth_(new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","batch-hold","com.wsscode.pathom3.connect.runner/batch-hold",-364021743).cljs$core$IFn$_invoke$arity$1(res))){
return res;
} else {
com.wsscode.pathom3.connect.runner.merge_node_stats_BANG_(env,and_node,new cljs.core.PersistentArrayMap(null, 1, [new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","node-run-finish-ms","com.wsscode.pathom3.connect.runner/node-run-finish-ms",1292429944),com.wsscode.misc.time.now_ms()], null));

return com.wsscode.pathom3.connect.runner.run_next_node_BANG_(env,and_node);
}
});
/**
 * Run a node from the compute graph. This will start the processing on the sent node
 *   and them will run everything that's connected to this node as sequences of it.
 * 
 *   The result is going to build up at ::p.ent/cache-tree*, after the run is concluded
 *   the output will be there.
 */
com.wsscode.pathom3.connect.runner.run_node_BANG_ = (function com$wsscode$pathom3$connect$runner$run_node_BANG_(env,node){
var G__158581 = com.wsscode.pathom3.connect.planner.node_kind(node);
var G__158581__$1 = (((G__158581 instanceof cljs.core.Keyword))?G__158581.fqn:null);
switch (G__158581__$1) {
case "com.wsscode.pathom3.connect.planner/node-resolver":
return com.wsscode.pathom3.connect.runner.run_resolver_node_BANG_(env,node);

break;
case "com.wsscode.pathom3.connect.planner/node-and":
return com.wsscode.pathom3.connect.runner.run_and_node_BANG_(env,node);

break;
case "com.wsscode.pathom3.connect.planner/node-or":
return com.wsscode.pathom3.connect.runner.run_or_node_BANG_(env,node);

break;
default:
throw (new Error(["No matching clause: ",cljs.core.str.cljs$core$IFn$_invoke$arity$1(G__158581__$1)].join('')));

}
});
/**
 * Create an entity to process the placeholder demands. This consider if the placeholder
 *   has params, params in placeholders means that you want some specific data at that
 *   point.
 */
com.wsscode.pathom3.connect.runner.placeholder_merge_entity = (function com$wsscode$pathom3$connect$runner$placeholder_merge_entity(p__158582,source_ent){
var map__158583 = p__158582;
var map__158583__$1 = cljs.core.__destructure_map(map__158583);
var graph = cljs.core.get.cljs$core$IFn$_invoke$arity$2(map__158583__$1,new cljs.core.Keyword("com.wsscode.pathom3.connect.planner","graph","com.wsscode.pathom3.connect.planner/graph",-1915509744));
return cljs.core.reduce.cljs$core$IFn$_invoke$arity$3((function (out,ph){
var data = new cljs.core.Keyword(null,"params","params",710516235).cljs$core$IFn$_invoke$arity$1(com.wsscode.pathom3.connect.planner.entry_ast(graph,ph));
return cljs.core.assoc.cljs$core$IFn$_invoke$arity$3(out,ph,cljs.core.merge.cljs$core$IFn$_invoke$arity$variadic(cljs.core.prim_seq.cljs$core$IFn$_invoke$arity$2([source_ent,data], 0)));
}),cljs.core.PersistentArrayMap.EMPTY,new cljs.core.Keyword("com.wsscode.pathom3.connect.planner","placeholders","com.wsscode.pathom3.connect.planner/placeholders",-1690563362).cljs$core$IFn$_invoke$arity$1(graph));
});
/**
 * Run mutation from AST.
 */
com.wsscode.pathom3.connect.runner.invoke_mutation_BANG_ = (function com$wsscode$pathom3$connect$runner$invoke_mutation_BANG_(env,p__158586){
var map__158587 = p__158586;
var map__158587__$1 = cljs.core.__destructure_map(map__158587);
var ast = map__158587__$1;
var key = cljs.core.get.cljs$core$IFn$_invoke$arity$2(map__158587__$1,new cljs.core.Keyword(null,"key","key",-1516042587));
var mutation = com.wsscode.pathom3.connect.indexes.mutation(env,key);
var start = com.wsscode.misc.time.now_ms();
var _ = com.wsscode.pathom3.connect.runner.merge_mutation_stats_BANG_(env,new cljs.core.PersistentArrayMap(null, 1, [new cljs.core.Keyword("com.wsscode.pathom3.connect.operation","op-name","com.wsscode.pathom3.connect.operation/op-name",-1249801049),key], null),new cljs.core.PersistentArrayMap(null, 2, [new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","node-run-start-ms","com.wsscode.pathom3.connect.runner/node-run-start-ms",-2130582528),start,new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","mutation-run-start-ms","com.wsscode.pathom3.connect.runner/mutation-run-start-ms",2017573501),start], null));
var result = (function (){try{if(cljs.core.truth_(mutation)){
return com.wsscode.pathom3.plugin.run_with_plugins.cljs$core$IFn$_invoke$arity$5(env,new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","wrap-mutate","com.wsscode.pathom3.connect.runner/wrap-mutate",-1277033248),(function (p1__158584_SHARP_,p2__158585_SHARP_){
return com.wsscode.pathom3.connect.operation.protocols._mutate(mutation,p1__158584_SHARP_,new cljs.core.Keyword(null,"params","params",710516235).cljs$core$IFn$_invoke$arity$1(p2__158585_SHARP_));
}),env,ast);
} else {
throw cljs.core.ex_info.cljs$core$IFn$_invoke$arity$2("Mutation not found",new cljs.core.PersistentArrayMap(null, 1, [new cljs.core.Keyword("com.wsscode.pathom3.connect.operation","op-name","com.wsscode.pathom3.connect.operation/op-name",-1249801049),key], null));
}
}catch (e158588){var e = e158588;
com.wsscode.pathom3.plugin.run_with_plugins.cljs$core$IFn$_invoke$arity$6(env,new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","wrap-mutation-error","com.wsscode.pathom3.connect.runner/wrap-mutation-error",-1155458602),(function (___$1,___$2,___$3){
return null;
}),env,ast,e);

return new cljs.core.PersistentArrayMap(null, 1, [new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","mutation-error","com.wsscode.pathom3.connect.runner/mutation-error",1516517468),e], null);
}})();
com.wsscode.pathom3.connect.runner.merge_mutation_stats_BANG_(env,new cljs.core.PersistentArrayMap(null, 1, [new cljs.core.Keyword("com.wsscode.pathom3.connect.operation","op-name","com.wsscode.pathom3.connect.operation/op-name",-1249801049),key], null),new cljs.core.PersistentArrayMap(null, 1, [new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","mutation-run-finish-ms","com.wsscode.pathom3.connect.runner/mutation-run-finish-ms",394220236),com.wsscode.misc.time.now_ms()], null));

if(cljs.core.truth_(new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","mutation-error","com.wsscode.pathom3.connect.runner/mutation-error",1516517468).cljs$core$IFn$_invoke$arity$1(result))){
com.wsscode.pathom3.entity_tree.swap_entity_BANG_.cljs$core$IFn$_invoke$arity$4(env,cljs.core.assoc,key,result);
} else {
com.wsscode.pathom3.entity_tree.swap_entity_BANG_.cljs$core$IFn$_invoke$arity$4(env,cljs.core.assoc,key,com.wsscode.pathom3.connect.runner.process_attr_subquery(env,cljs.core.PersistentArrayMap.EMPTY,key,result));
}

return com.wsscode.pathom3.connect.runner.merge_mutation_stats_BANG_(env,new cljs.core.PersistentArrayMap(null, 1, [new cljs.core.Keyword("com.wsscode.pathom3.connect.operation","op-name","com.wsscode.pathom3.connect.operation/op-name",-1249801049),key], null),new cljs.core.PersistentArrayMap(null, 1, [new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","node-run-finish-ms","com.wsscode.pathom3.connect.runner/node-run-finish-ms",1292429944),com.wsscode.misc.time.now_ms()], null));
});
/**
 * Runs the mutations gathered by the planner.
 */
com.wsscode.pathom3.connect.runner.process_mutations_BANG_ = (function com$wsscode$pathom3$connect$runner$process_mutations_BANG_(p__158589){
var map__158590 = p__158589;
var map__158590__$1 = cljs.core.__destructure_map(map__158590);
var env = map__158590__$1;
var graph = cljs.core.get.cljs$core$IFn$_invoke$arity$2(map__158590__$1,new cljs.core.Keyword("com.wsscode.pathom3.connect.planner","graph","com.wsscode.pathom3.connect.planner/graph",-1915509744));
var seq__158591 = cljs.core.seq(new cljs.core.Keyword("com.wsscode.pathom3.connect.planner","mutations","com.wsscode.pathom3.connect.planner/mutations",-1571107042).cljs$core$IFn$_invoke$arity$1(graph));
var chunk__158592 = null;
var count__158593 = (0);
var i__158594 = (0);
while(true){
if((i__158594 < count__158593)){
var key = chunk__158592.cljs$core$IIndexed$_nth$arity$2(null,i__158594);
com.wsscode.pathom3.connect.runner.invoke_mutation_BANG_(env,com.wsscode.pathom3.connect.runner.entry_ast(graph,key));


var G__158779 = seq__158591;
var G__158780 = chunk__158592;
var G__158781 = count__158593;
var G__158782 = (i__158594 + (1));
seq__158591 = G__158779;
chunk__158592 = G__158780;
count__158593 = G__158781;
i__158594 = G__158782;
continue;
} else {
var temp__5753__auto__ = cljs.core.seq(seq__158591);
if(temp__5753__auto__){
var seq__158591__$1 = temp__5753__auto__;
if(cljs.core.chunked_seq_QMARK_(seq__158591__$1)){
var c__4649__auto__ = cljs.core.chunk_first(seq__158591__$1);
var G__158784 = cljs.core.chunk_rest(seq__158591__$1);
var G__158785 = c__4649__auto__;
var G__158786 = cljs.core.count(c__4649__auto__);
var G__158787 = (0);
seq__158591 = G__158784;
chunk__158592 = G__158785;
count__158593 = G__158786;
i__158594 = G__158787;
continue;
} else {
var key = cljs.core.first(seq__158591__$1);
com.wsscode.pathom3.connect.runner.invoke_mutation_BANG_(env,com.wsscode.pathom3.connect.runner.entry_ast(graph,key));


var G__158788 = cljs.core.next(seq__158591__$1);
var G__158789 = null;
var G__158790 = (0);
var G__158791 = (0);
seq__158591 = G__158788;
chunk__158592 = G__158789;
count__158593 = G__158790;
i__158594 = G__158791;
continue;
}
} else {
return null;
}
}
break;
}
});
com.wsscode.pathom3.connect.runner.run_root_node_BANG_ = (function com$wsscode$pathom3$connect$runner$run_root_node_BANG_(p__158595){
var map__158596 = p__158595;
var map__158596__$1 = cljs.core.__destructure_map(map__158596);
var env = map__158596__$1;
var graph = cljs.core.get.cljs$core$IFn$_invoke$arity$2(map__158596__$1,new cljs.core.Keyword("com.wsscode.pathom3.connect.planner","graph","com.wsscode.pathom3.connect.planner/graph",-1915509744));
var temp__5751__auto__ = com.wsscode.pathom3.connect.planner.get_root_node(graph);
if(cljs.core.truth_(temp__5751__auto__)){
var root = temp__5751__auto__;
var map__158597 = com.wsscode.pathom3.connect.runner.run_node_BANG_(env,root);
var map__158597__$1 = cljs.core.__destructure_map(map__158597);
var batch_hold = cljs.core.get.cljs$core$IFn$_invoke$arity$2(map__158597__$1,new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","batch-hold","com.wsscode.pathom3.connect.runner/batch-hold",-364021743));
if(cljs.core.truth_(batch_hold)){
if(cljs.core.truth_(new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","nested-waiting?","com.wsscode.pathom3.connect.runner/nested-waiting?",820889396).cljs$core$IFn$_invoke$arity$1(batch_hold))){
return com.wsscode.misc.refs.gswap_BANG_.cljs$core$IFn$_invoke$arity$3(new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","batch-waiting*","com.wsscode.pathom3.connect.runner/batch-waiting*",-950834195).cljs$core$IFn$_invoke$arity$1(env),com.wsscode.misc.coll.vconj,batch_hold);
} else {
return com.wsscode.misc.refs.gswap_BANG_.cljs$core$IFn$_invoke$arity$variadic(new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","batch-pending*","com.wsscode.pathom3.connect.runner/batch-pending*",898520706).cljs$core$IFn$_invoke$arity$1(env),cljs.core.update,new cljs.core.Keyword("com.wsscode.pathom3.connect.operation","op-name","com.wsscode.pathom3.connect.operation/op-name",-1249801049).cljs$core$IFn$_invoke$arity$1(batch_hold),com.wsscode.misc.coll.vconj,cljs.core.prim_seq.cljs$core$IFn$_invoke$arity$2([batch_hold], 0));
}
} else {
return null;
}
} else {
return null;
}
});
/**
 * Run the root node of the graph. As resolvers run, the result will be add to the
 *   entity cache tree.
 */
com.wsscode.pathom3.connect.runner.run_graph_BANG__STAR_ = (function com$wsscode$pathom3$connect$runner$run_graph_BANG__STAR_(p__158598){
var map__158599 = p__158598;
var map__158599__$1 = cljs.core.__destructure_map(map__158599);
var env = map__158599__$1;
var graph = cljs.core.get.cljs$core$IFn$_invoke$arity$2(map__158599__$1,new cljs.core.Keyword("com.wsscode.pathom3.connect.planner","graph","com.wsscode.pathom3.connect.planner/graph",-1915509744));
var source_ent = com.wsscode.pathom3.entity_tree.entity(env);
com.wsscode.pathom3.connect.runner.process_mutations_BANG_(env);

var temp__5751__auto___158793 = new cljs.core.Keyword("com.wsscode.pathom3.connect.planner","nested-process","com.wsscode.pathom3.connect.planner/nested-process",-35632382).cljs$core$IFn$_invoke$arity$1(graph);
if(cljs.core.truth_(temp__5751__auto___158793)){
var nested_158794 = temp__5751__auto___158793;
com.wsscode.pathom3.connect.runner.merge_resolver_response_BANG_(env,cljs.core.select_keys(com.wsscode.pathom3.entity_tree.entity(env),nested_158794));
} else {
}

var temp__5751__auto___158795 = new cljs.core.Keyword("com.wsscode.pathom3.connect.planner","idents","com.wsscode.pathom3.connect.planner/idents",-1156950100).cljs$core$IFn$_invoke$arity$1(graph);
if(cljs.core.truth_(temp__5751__auto___158795)){
var idents_158796 = temp__5751__auto___158795;
com.wsscode.pathom3.connect.runner.process_idents_BANG_(env,idents_158796);
} else {
}

com.wsscode.pathom3.connect.runner.run_root_node_BANG_(env);

com.wsscode.pathom3.connect.runner.merge_resolver_response_BANG_(env,com.wsscode.pathom3.connect.runner.placeholder_merge_entity(env,source_ent));

return graph;
});
com.wsscode.pathom3.connect.runner.plan_and_run_BANG_ = (function com$wsscode$pathom3$connect$runner$plan_and_run_BANG_(env,ast_or_graph,entity_tree_STAR_){
var graph = (cljs.core.truth_(new cljs.core.Keyword("com.wsscode.pathom3.connect.planner","nodes","com.wsscode.pathom3.connect.planner/nodes",873592574).cljs$core$IFn$_invoke$arity$1(ast_or_graph))?ast_or_graph:(function (){var start_plan = com.wsscode.misc.time.now_ms();
var plan = com.wsscode.pathom3.connect.planner.compute_run_graph.cljs$core$IFn$_invoke$arity$1(cljs.core.assoc.cljs$core$IFn$_invoke$arity$variadic(env,new cljs.core.Keyword("edn-query-language.ast","node","edn-query-language.ast/node",-1614840957),ast_or_graph,cljs.core.prim_seq.cljs$core$IFn$_invoke$arity$2([new cljs.core.Keyword("com.wsscode.pathom3.connect.planner","available-data","com.wsscode.pathom3.connect.planner/available-data",727921292),com.wsscode.pathom3.format.shape_descriptor.data__GT_shape_descriptor(cljs.core.deref(entity_tree_STAR_))], 0)));
var finish_plan = com.wsscode.misc.time.now_ms();
return cljs.core.assoc.cljs$core$IFn$_invoke$arity$variadic(plan,new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","compute-plan-run-start-ms","com.wsscode.pathom3.connect.runner/compute-plan-run-start-ms",1143271592),start_plan,cljs.core.prim_seq.cljs$core$IFn$_invoke$arity$2([new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","compute-plan-run-finish-ms","com.wsscode.pathom3.connect.runner/compute-plan-run-finish-ms",-1603607227),finish_plan], 0));
})());
return com.wsscode.pathom3.connect.runner.run_graph_BANG__STAR_(cljs.core.assoc.cljs$core$IFn$_invoke$arity$variadic(env,new cljs.core.Keyword("com.wsscode.pathom3.connect.planner","graph","com.wsscode.pathom3.connect.planner/graph",-1915509744),graph,cljs.core.prim_seq.cljs$core$IFn$_invoke$arity$2([new cljs.core.Keyword("com.wsscode.pathom3.entity-tree","entity-tree*","com.wsscode.pathom3.entity-tree/entity-tree*",1259415691),entity_tree_STAR_], 0)));
});
com.wsscode.pathom3.connect.runner.assoc_end_plan_stats = (function com$wsscode$pathom3$connect$runner$assoc_end_plan_stats(env,plan){
return cljs.core.assoc.cljs$core$IFn$_invoke$arity$variadic(plan,new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","graph-run-start-ms","com.wsscode.pathom3.connect.runner/graph-run-start-ms",-954308936),new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","graph-run-start-ms","com.wsscode.pathom3.connect.runner/graph-run-start-ms",-954308936).cljs$core$IFn$_invoke$arity$1(env),cljs.core.prim_seq.cljs$core$IFn$_invoke$arity$2([new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","graph-run-finish-ms","com.wsscode.pathom3.connect.runner/graph-run-finish-ms",-1109337048),com.wsscode.misc.time.now_ms(),new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","node-run-stats","com.wsscode.pathom3.connect.runner/node-run-stats",-2036346899),(function (){var G__158600 = env;
var G__158600__$1 = (((G__158600 == null))?null:new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","node-run-stats*","com.wsscode.pathom3.connect.runner/node-run-stats*",453579030).cljs$core$IFn$_invoke$arity$1(G__158600));
if((G__158600__$1 == null)){
return null;
} else {
return cljs.core.deref(G__158600__$1);
}
})()], 0));
});
com.wsscode.pathom3.connect.runner.include_meta_stats = (function com$wsscode$pathom3$connect$runner$include_meta_stats(result,env,plan){
return cljs.core.vary_meta.cljs$core$IFn$_invoke$arity$4(result,cljs.core.assoc,new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","run-stats","com.wsscode.pathom3.connect.runner/run-stats",1718909061),com.wsscode.pathom3.connect.runner.assoc_end_plan_stats(env,plan));
});
com.wsscode.pathom3.connect.runner.mark_batch_errors = (function com$wsscode$pathom3$connect$runner$mark_batch_errors(e,env,batch_op,batch_items){
com.wsscode.pathom3.plugin.run_with_plugins.cljs$core$IFn$_invoke$arity$6(env,new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","wrap-batch-resolver-error","com.wsscode.pathom3.connect.runner/wrap-batch-resolver-error",176601916),(function (_,___$1,___$2){
return null;
}),env,new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [batch_op,batch_items], null),e);

var seq__158601_158798 = cljs.core.seq(batch_items);
var chunk__158602_158799 = null;
var count__158603_158800 = (0);
var i__158604_158801 = (0);
while(true){
if((i__158604_158801 < count__158603_158800)){
var map__158607_158802 = chunk__158602_158799.cljs$core$IIndexed$_nth$arity$2(null,i__158604_158801);
var map__158607_158803__$1 = cljs.core.__destructure_map(map__158607_158802);
var env_SINGLEQUOTE__158804 = cljs.core.get.cljs$core$IFn$_invoke$arity$2(map__158607_158803__$1,new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","env","com.wsscode.pathom3.connect.runner/env",-1421599428));
var node_158805 = cljs.core.get.cljs$core$IFn$_invoke$arity$2(map__158607_158803__$1,new cljs.core.Keyword("com.wsscode.pathom3.connect.planner","node","com.wsscode.pathom3.connect.planner/node",325156565));
com.wsscode.pathom3.plugin.run_with_plugins.cljs$core$IFn$_invoke$arity$6(env_SINGLEQUOTE__158804,new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","wrap-resolver-error","com.wsscode.pathom3.connect.runner/wrap-resolver-error",-1230614515),com.wsscode.pathom3.connect.runner.mark_resolver_error,env_SINGLEQUOTE__158804,node_158805,cljs.core.ex_info.cljs$core$IFn$_invoke$arity$3("Batch error",new cljs.core.PersistentArrayMap(null, 1, [new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","batch-error?","com.wsscode.pathom3.connect.runner/batch-error?",-244618920),true], null),e));


var G__158806 = seq__158601_158798;
var G__158807 = chunk__158602_158799;
var G__158808 = count__158603_158800;
var G__158809 = (i__158604_158801 + (1));
seq__158601_158798 = G__158806;
chunk__158602_158799 = G__158807;
count__158603_158800 = G__158808;
i__158604_158801 = G__158809;
continue;
} else {
var temp__5753__auto___158810 = cljs.core.seq(seq__158601_158798);
if(temp__5753__auto___158810){
var seq__158601_158811__$1 = temp__5753__auto___158810;
if(cljs.core.chunked_seq_QMARK_(seq__158601_158811__$1)){
var c__4649__auto___158812 = cljs.core.chunk_first(seq__158601_158811__$1);
var G__158813 = cljs.core.chunk_rest(seq__158601_158811__$1);
var G__158814 = c__4649__auto___158812;
var G__158815 = cljs.core.count(c__4649__auto___158812);
var G__158816 = (0);
seq__158601_158798 = G__158813;
chunk__158602_158799 = G__158814;
count__158603_158800 = G__158815;
i__158604_158801 = G__158816;
continue;
} else {
var map__158608_158817 = cljs.core.first(seq__158601_158811__$1);
var map__158608_158818__$1 = cljs.core.__destructure_map(map__158608_158817);
var env_SINGLEQUOTE__158819 = cljs.core.get.cljs$core$IFn$_invoke$arity$2(map__158608_158818__$1,new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","env","com.wsscode.pathom3.connect.runner/env",-1421599428));
var node_158820 = cljs.core.get.cljs$core$IFn$_invoke$arity$2(map__158608_158818__$1,new cljs.core.Keyword("com.wsscode.pathom3.connect.planner","node","com.wsscode.pathom3.connect.planner/node",325156565));
com.wsscode.pathom3.plugin.run_with_plugins.cljs$core$IFn$_invoke$arity$6(env_SINGLEQUOTE__158819,new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","wrap-resolver-error","com.wsscode.pathom3.connect.runner/wrap-resolver-error",-1230614515),com.wsscode.pathom3.connect.runner.mark_resolver_error,env_SINGLEQUOTE__158819,node_158820,cljs.core.ex_info.cljs$core$IFn$_invoke$arity$3("Batch error",new cljs.core.PersistentArrayMap(null, 1, [new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","batch-error?","com.wsscode.pathom3.connect.runner/batch-error?",-244618920),true], null),e));


var G__158821 = cljs.core.next(seq__158601_158811__$1);
var G__158822 = null;
var G__158823 = (0);
var G__158824 = (0);
seq__158601_158798 = G__158821;
chunk__158602_158799 = G__158822;
count__158603_158800 = G__158823;
i__158604_158801 = G__158824;
continue;
}
} else {
}
}
break;
}

return new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","node-error","com.wsscode.pathom3.connect.runner/node-error",890120380);
});
com.wsscode.pathom3.connect.runner.cache_batch_item = (function com$wsscode$pathom3$connect$runner$cache_batch_item(p__158609,batch_op,response){
var map__158610 = p__158609;
var map__158610__$1 = cljs.core.__destructure_map(map__158610);
var batch_item = map__158610__$1;
var env_SINGLEQUOTE_ = cljs.core.get.cljs$core$IFn$_invoke$arity$2(map__158610__$1,new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","env","com.wsscode.pathom3.connect.runner/env",-1421599428));
var node_resolver_input = cljs.core.get.cljs$core$IFn$_invoke$arity$2(map__158610__$1,new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","node-resolver-input","com.wsscode.pathom3.connect.runner/node-resolver-input",-1558799633));
var cache_QMARK_ = cljs.core.get.cljs$core$IFn$_invoke$arity$2(map__158610__$1,new cljs.core.Keyword("com.wsscode.pathom3.connect.operation","cache?","com.wsscode.pathom3.connect.operation/cache?",575940493));
var cache_store = cljs.core.get.cljs$core$IFn$_invoke$arity$2(map__158610__$1,new cljs.core.Keyword("com.wsscode.pathom3.connect.operation","cache-store","com.wsscode.pathom3.connect.operation/cache-store",1503197377));
if(cljs.core.truth_(cache_QMARK_)){
return com.wsscode.pathom3.cache.cached(cache_store,env_SINGLEQUOTE_,new cljs.core.PersistentVector(null, 3, 5, cljs.core.PersistentVector.EMPTY_NODE, [batch_op,node_resolver_input,com.wsscode.pathom3.connect.operation.params(batch_item)], null),(function (){
return response;
}));
} else {
return null;
}
});
/**
 * For batch we group the items with the same inputs so the resolver only needs to have
 *   each input once. This function is a helper to side the input batch items with the
 *   distinct list of responses.
 */
com.wsscode.pathom3.connect.runner.combine_inputs_with_responses = (function com$wsscode$pathom3$connect$runner$combine_inputs_with_responses(input_groups,inputs,responses){
return cljs.core.into.cljs$core$IFn$_invoke$arity$3(cljs.core.PersistentVector.EMPTY,cljs.core.mapcat.cljs$core$IFn$_invoke$arity$1((function (p__158614){
var vec__158615 = p__158614;
var inputs__$1 = cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__158615,(0),null);
var result = cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__158615,(1),null);
return cljs.core.mapv.cljs$core$IFn$_invoke$arity$2((function (p1__158613_SHARP_){
return (new cljs.core.PersistentVector(null,2,(5),cljs.core.PersistentVector.EMPTY_NODE,[p1__158613_SHARP_,result],null));
}),inputs__$1);
})),cljs.core.mapv.cljs$core$IFn$_invoke$arity$3((function (p1__158612_SHARP_,p2__158611_SHARP_){
return (new cljs.core.PersistentVector(null,2,(5),cljs.core.PersistentVector.EMPTY_NODE,[p2__158611_SHARP_,p1__158612_SHARP_],null));
}),responses,cljs.core.mapv.cljs$core$IFn$_invoke$arity$2(input_groups,inputs)));
});
com.wsscode.pathom3.connect.runner.merge_entity_to_root_data = (function com$wsscode$pathom3$connect$runner$merge_entity_to_root_data(env,env_SINGLEQUOTE_,node){
if(com.wsscode.pathom3.path.root_QMARK_(env_SINGLEQUOTE_)){
return null;
} else {
return com.wsscode.pathom3.entity_tree.swap_entity_BANG_.cljs$core$IFn$_invoke$arity$4(env,cljs.core.update_in,new cljs.core.Keyword("com.wsscode.pathom3.path","path","com.wsscode.pathom3.path/path",1029673558).cljs$core$IFn$_invoke$arity$1(env_SINGLEQUOTE_),(function (ent){
var ent_SINGLEQUOTE_ = com.wsscode.pathom3.entity_tree.entity(env_SINGLEQUOTE_);
return com.wsscode.pathom3.connect.runner.include_meta_stats(cljs.core.merge.cljs$core$IFn$_invoke$arity$variadic(cljs.core.prim_seq.cljs$core$IFn$_invoke$arity$2([com.wsscode.misc.coll.merge_defaults(ent,ent_SINGLEQUOTE_),com.wsscode.pathom3.format.shape_descriptor.select_shape(ent_SINGLEQUOTE_,new cljs.core.Keyword("com.wsscode.pathom3.connect.planner","expects","com.wsscode.pathom3.connect.planner/expects",2018136040).cljs$core$IFn$_invoke$arity$1(node))], 0)),env_SINGLEQUOTE_,new cljs.core.Keyword("com.wsscode.pathom3.connect.planner","graph","com.wsscode.pathom3.connect.planner/graph",-1915509744).cljs$core$IFn$_invoke$arity$1(env_SINGLEQUOTE_));
}));
}
});
com.wsscode.pathom3.connect.runner.run_batches_pending_BANG_ = (function com$wsscode$pathom3$connect$runner$run_batches_pending_BANG_(env){
var batches_STAR_ = new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","batch-pending*","com.wsscode.pathom3.connect.runner/batch-pending*",898520706).cljs$core$IFn$_invoke$arity$1(env);
var batches = cljs.core.deref(batches_STAR_);
cljs.core.vreset_BANG_(batches_STAR_,cljs.core.PersistentArrayMap.EMPTY);

var seq__158619 = cljs.core.seq(batches);
var chunk__158620 = null;
var count__158621 = (0);
var i__158622 = (0);
while(true){
if((i__158622 < count__158621)){
var vec__158673 = chunk__158620.cljs$core$IIndexed$_nth$arity$2(null,i__158622);
var batch_op = cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__158673,(0),null);
var batch_items = cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__158673,(1),null);
var input_groups_158827 = cljs.core.group_by(new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","node-resolver-input","com.wsscode.pathom3.connect.runner/node-resolver-input",-1558799633),batch_items);
var inputs_158828 = cljs.core.keys(input_groups_158827);
var resolver_158829 = com.wsscode.pathom3.connect.indexes.resolver(env,batch_op);
var batch_env_158830 = com.wsscode.misc.coll.update_if.cljs$core$IFn$_invoke$arity$3(new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","env","com.wsscode.pathom3.connect.runner/env",-1421599428).cljs$core$IFn$_invoke$arity$1(cljs.core.first(batch_items)),new cljs.core.Keyword("com.wsscode.pathom3.path","path","com.wsscode.pathom3.path/path",1029673558),((function (seq__158619,chunk__158620,count__158621,i__158622,input_groups_158827,inputs_158828,resolver_158829,vec__158673,batch_op,batch_items,batches_STAR_,batches){
return (function (p1__158618_SHARP_){
var G__158676 = p1__158618_SHARP_;
if(cljs.core.seq(p1__158618_SHARP_)){
return cljs.core.pop(G__158676);
} else {
return G__158676;
}
});})(seq__158619,chunk__158620,count__158621,i__158622,input_groups_158827,inputs_158828,resolver_158829,vec__158673,batch_op,batch_items,batches_STAR_,batches))
);
var start_158831 = com.wsscode.misc.time.now_ms();
var responses_158832 = (function (){try{return com.wsscode.pathom3.connect.operation.protocols._resolve(resolver_158829,batch_env_158830,inputs_158828);
}catch (e158677){var e = e158677;
return com.wsscode.pathom3.connect.runner.mark_batch_errors(e,env,batch_op,batch_items);
}})();
var finish_158833 = com.wsscode.misc.time.now_ms();
if(com.wsscode.misc.refs.kw_identical_QMARK_(new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","node-error","com.wsscode.pathom3.connect.runner/node-error",890120380),responses_158832)){
} else {
if(cljs.core.not_EQ_.cljs$core$IFn$_invoke$arity$2(cljs.core.count(inputs_158828),cljs.core.count(responses_158832))){
throw cljs.core.ex_info.cljs$core$IFn$_invoke$arity$2("Batch results must be a sequence and have the same length as the inputs.",cljs.core.PersistentArrayMap.EMPTY);
} else {
}

var seq__158678_158834 = cljs.core.seq(com.wsscode.pathom3.connect.runner.combine_inputs_with_responses(input_groups_158827,inputs_158828,responses_158832));
var chunk__158679_158835 = null;
var count__158680_158836 = (0);
var i__158681_158837 = (0);
while(true){
if((i__158681_158837 < count__158680_158836)){
var vec__158690_158839 = chunk__158679_158835.cljs$core$IIndexed$_nth$arity$2(null,i__158681_158837);
var map__158693_158840 = cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__158690_158839,(0),null);
var map__158693_158841__$1 = cljs.core.__destructure_map(map__158693_158840);
var batch_item_158842 = map__158693_158841__$1;
var env_SINGLEQUOTE__158843 = cljs.core.get.cljs$core$IFn$_invoke$arity$2(map__158693_158841__$1,new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","env","com.wsscode.pathom3.connect.runner/env",-1421599428));
var node_158844 = cljs.core.get.cljs$core$IFn$_invoke$arity$2(map__158693_158841__$1,new cljs.core.Keyword("com.wsscode.pathom3.connect.planner","node","com.wsscode.pathom3.connect.planner/node",325156565));
var node_resolver_input_158845 = cljs.core.get.cljs$core$IFn$_invoke$arity$2(map__158693_158841__$1,new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","node-resolver-input","com.wsscode.pathom3.connect.runner/node-resolver-input",-1558799633));
var response_158846 = cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__158690_158839,(1),null);
com.wsscode.pathom3.connect.runner.cache_batch_item(batch_item_158842,batch_op,response_158846);

com.wsscode.pathom3.connect.runner.merge_node_stats_BANG_(env_SINGLEQUOTE__158843,node_158844,cljs.core.merge.cljs$core$IFn$_invoke$arity$variadic(cljs.core.prim_seq.cljs$core$IFn$_invoke$arity$2([new cljs.core.PersistentArrayMap(null, 2, [new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","batch-run-start-ms","com.wsscode.pathom3.connect.runner/batch-run-start-ms",-1710202816),start_158831,new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","batch-run-finish-ms","com.wsscode.pathom3.connect.runner/batch-run-finish-ms",-1912626285),finish_158833], null),com.wsscode.pathom3.connect.runner.report_resolver_io_stats(env_SINGLEQUOTE__158843,node_resolver_input_158845,response_158846)], 0)));

com.wsscode.pathom3.connect.runner.merge_resolver_response_BANG_(env_SINGLEQUOTE__158843,response_158846);

com.wsscode.pathom3.connect.runner.merge_node_stats_BANG_(env_SINGLEQUOTE__158843,node_158844,new cljs.core.PersistentArrayMap(null, 1, [new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","node-run-finish-ms","com.wsscode.pathom3.connect.runner/node-run-finish-ms",1292429944),com.wsscode.misc.time.now_ms()], null));

com.wsscode.pathom3.connect.runner.run_root_node_BANG_(env_SINGLEQUOTE__158843);

com.wsscode.pathom3.connect.runner.merge_entity_to_root_data(env,env_SINGLEQUOTE__158843,node_158844);


var G__158848 = seq__158678_158834;
var G__158849 = chunk__158679_158835;
var G__158850 = count__158680_158836;
var G__158851 = (i__158681_158837 + (1));
seq__158678_158834 = G__158848;
chunk__158679_158835 = G__158849;
count__158680_158836 = G__158850;
i__158681_158837 = G__158851;
continue;
} else {
var temp__5753__auto___158852 = cljs.core.seq(seq__158678_158834);
if(temp__5753__auto___158852){
var seq__158678_158855__$1 = temp__5753__auto___158852;
if(cljs.core.chunked_seq_QMARK_(seq__158678_158855__$1)){
var c__4649__auto___158856 = cljs.core.chunk_first(seq__158678_158855__$1);
var G__158857 = cljs.core.chunk_rest(seq__158678_158855__$1);
var G__158858 = c__4649__auto___158856;
var G__158859 = cljs.core.count(c__4649__auto___158856);
var G__158860 = (0);
seq__158678_158834 = G__158857;
chunk__158679_158835 = G__158858;
count__158680_158836 = G__158859;
i__158681_158837 = G__158860;
continue;
} else {
var vec__158694_158861 = cljs.core.first(seq__158678_158855__$1);
var map__158697_158862 = cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__158694_158861,(0),null);
var map__158697_158863__$1 = cljs.core.__destructure_map(map__158697_158862);
var batch_item_158864 = map__158697_158863__$1;
var env_SINGLEQUOTE__158865 = cljs.core.get.cljs$core$IFn$_invoke$arity$2(map__158697_158863__$1,new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","env","com.wsscode.pathom3.connect.runner/env",-1421599428));
var node_158866 = cljs.core.get.cljs$core$IFn$_invoke$arity$2(map__158697_158863__$1,new cljs.core.Keyword("com.wsscode.pathom3.connect.planner","node","com.wsscode.pathom3.connect.planner/node",325156565));
var node_resolver_input_158867 = cljs.core.get.cljs$core$IFn$_invoke$arity$2(map__158697_158863__$1,new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","node-resolver-input","com.wsscode.pathom3.connect.runner/node-resolver-input",-1558799633));
var response_158868 = cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__158694_158861,(1),null);
com.wsscode.pathom3.connect.runner.cache_batch_item(batch_item_158864,batch_op,response_158868);

com.wsscode.pathom3.connect.runner.merge_node_stats_BANG_(env_SINGLEQUOTE__158865,node_158866,cljs.core.merge.cljs$core$IFn$_invoke$arity$variadic(cljs.core.prim_seq.cljs$core$IFn$_invoke$arity$2([new cljs.core.PersistentArrayMap(null, 2, [new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","batch-run-start-ms","com.wsscode.pathom3.connect.runner/batch-run-start-ms",-1710202816),start_158831,new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","batch-run-finish-ms","com.wsscode.pathom3.connect.runner/batch-run-finish-ms",-1912626285),finish_158833], null),com.wsscode.pathom3.connect.runner.report_resolver_io_stats(env_SINGLEQUOTE__158865,node_resolver_input_158867,response_158868)], 0)));

com.wsscode.pathom3.connect.runner.merge_resolver_response_BANG_(env_SINGLEQUOTE__158865,response_158868);

com.wsscode.pathom3.connect.runner.merge_node_stats_BANG_(env_SINGLEQUOTE__158865,node_158866,new cljs.core.PersistentArrayMap(null, 1, [new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","node-run-finish-ms","com.wsscode.pathom3.connect.runner/node-run-finish-ms",1292429944),com.wsscode.misc.time.now_ms()], null));

com.wsscode.pathom3.connect.runner.run_root_node_BANG_(env_SINGLEQUOTE__158865);

com.wsscode.pathom3.connect.runner.merge_entity_to_root_data(env,env_SINGLEQUOTE__158865,node_158866);


var G__158872 = cljs.core.next(seq__158678_158855__$1);
var G__158873 = null;
var G__158874 = (0);
var G__158875 = (0);
seq__158678_158834 = G__158872;
chunk__158679_158835 = G__158873;
count__158680_158836 = G__158874;
i__158681_158837 = G__158875;
continue;
}
} else {
}
}
break;
}
}


var G__158876 = seq__158619;
var G__158877 = chunk__158620;
var G__158878 = count__158621;
var G__158879 = (i__158622 + (1));
seq__158619 = G__158876;
chunk__158620 = G__158877;
count__158621 = G__158878;
i__158622 = G__158879;
continue;
} else {
var temp__5753__auto__ = cljs.core.seq(seq__158619);
if(temp__5753__auto__){
var seq__158619__$1 = temp__5753__auto__;
if(cljs.core.chunked_seq_QMARK_(seq__158619__$1)){
var c__4649__auto__ = cljs.core.chunk_first(seq__158619__$1);
var G__158880 = cljs.core.chunk_rest(seq__158619__$1);
var G__158881 = c__4649__auto__;
var G__158882 = cljs.core.count(c__4649__auto__);
var G__158883 = (0);
seq__158619 = G__158880;
chunk__158620 = G__158881;
count__158621 = G__158882;
i__158622 = G__158883;
continue;
} else {
var vec__158698 = cljs.core.first(seq__158619__$1);
var batch_op = cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__158698,(0),null);
var batch_items = cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__158698,(1),null);
var input_groups_158884 = cljs.core.group_by(new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","node-resolver-input","com.wsscode.pathom3.connect.runner/node-resolver-input",-1558799633),batch_items);
var inputs_158885 = cljs.core.keys(input_groups_158884);
var resolver_158886 = com.wsscode.pathom3.connect.indexes.resolver(env,batch_op);
var batch_env_158887 = com.wsscode.misc.coll.update_if.cljs$core$IFn$_invoke$arity$3(new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","env","com.wsscode.pathom3.connect.runner/env",-1421599428).cljs$core$IFn$_invoke$arity$1(cljs.core.first(batch_items)),new cljs.core.Keyword("com.wsscode.pathom3.path","path","com.wsscode.pathom3.path/path",1029673558),((function (seq__158619,chunk__158620,count__158621,i__158622,input_groups_158884,inputs_158885,resolver_158886,vec__158698,batch_op,batch_items,seq__158619__$1,temp__5753__auto__,batches_STAR_,batches){
return (function (p1__158618_SHARP_){
var G__158701 = p1__158618_SHARP_;
if(cljs.core.seq(p1__158618_SHARP_)){
return cljs.core.pop(G__158701);
} else {
return G__158701;
}
});})(seq__158619,chunk__158620,count__158621,i__158622,input_groups_158884,inputs_158885,resolver_158886,vec__158698,batch_op,batch_items,seq__158619__$1,temp__5753__auto__,batches_STAR_,batches))
);
var start_158888 = com.wsscode.misc.time.now_ms();
var responses_158889 = (function (){try{return com.wsscode.pathom3.connect.operation.protocols._resolve(resolver_158886,batch_env_158887,inputs_158885);
}catch (e158702){var e = e158702;
return com.wsscode.pathom3.connect.runner.mark_batch_errors(e,env,batch_op,batch_items);
}})();
var finish_158890 = com.wsscode.misc.time.now_ms();
if(com.wsscode.misc.refs.kw_identical_QMARK_(new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","node-error","com.wsscode.pathom3.connect.runner/node-error",890120380),responses_158889)){
} else {
if(cljs.core.not_EQ_.cljs$core$IFn$_invoke$arity$2(cljs.core.count(inputs_158885),cljs.core.count(responses_158889))){
throw cljs.core.ex_info.cljs$core$IFn$_invoke$arity$2("Batch results must be a sequence and have the same length as the inputs.",cljs.core.PersistentArrayMap.EMPTY);
} else {
}

var seq__158703_158893 = cljs.core.seq(com.wsscode.pathom3.connect.runner.combine_inputs_with_responses(input_groups_158884,inputs_158885,responses_158889));
var chunk__158704_158894 = null;
var count__158705_158895 = (0);
var i__158706_158896 = (0);
while(true){
if((i__158706_158896 < count__158705_158895)){
var vec__158715_158897 = chunk__158704_158894.cljs$core$IIndexed$_nth$arity$2(null,i__158706_158896);
var map__158718_158898 = cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__158715_158897,(0),null);
var map__158718_158899__$1 = cljs.core.__destructure_map(map__158718_158898);
var batch_item_158900 = map__158718_158899__$1;
var env_SINGLEQUOTE__158901 = cljs.core.get.cljs$core$IFn$_invoke$arity$2(map__158718_158899__$1,new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","env","com.wsscode.pathom3.connect.runner/env",-1421599428));
var node_158902 = cljs.core.get.cljs$core$IFn$_invoke$arity$2(map__158718_158899__$1,new cljs.core.Keyword("com.wsscode.pathom3.connect.planner","node","com.wsscode.pathom3.connect.planner/node",325156565));
var node_resolver_input_158903 = cljs.core.get.cljs$core$IFn$_invoke$arity$2(map__158718_158899__$1,new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","node-resolver-input","com.wsscode.pathom3.connect.runner/node-resolver-input",-1558799633));
var response_158904 = cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__158715_158897,(1),null);
com.wsscode.pathom3.connect.runner.cache_batch_item(batch_item_158900,batch_op,response_158904);

com.wsscode.pathom3.connect.runner.merge_node_stats_BANG_(env_SINGLEQUOTE__158901,node_158902,cljs.core.merge.cljs$core$IFn$_invoke$arity$variadic(cljs.core.prim_seq.cljs$core$IFn$_invoke$arity$2([new cljs.core.PersistentArrayMap(null, 2, [new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","batch-run-start-ms","com.wsscode.pathom3.connect.runner/batch-run-start-ms",-1710202816),start_158888,new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","batch-run-finish-ms","com.wsscode.pathom3.connect.runner/batch-run-finish-ms",-1912626285),finish_158890], null),com.wsscode.pathom3.connect.runner.report_resolver_io_stats(env_SINGLEQUOTE__158901,node_resolver_input_158903,response_158904)], 0)));

com.wsscode.pathom3.connect.runner.merge_resolver_response_BANG_(env_SINGLEQUOTE__158901,response_158904);

com.wsscode.pathom3.connect.runner.merge_node_stats_BANG_(env_SINGLEQUOTE__158901,node_158902,new cljs.core.PersistentArrayMap(null, 1, [new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","node-run-finish-ms","com.wsscode.pathom3.connect.runner/node-run-finish-ms",1292429944),com.wsscode.misc.time.now_ms()], null));

com.wsscode.pathom3.connect.runner.run_root_node_BANG_(env_SINGLEQUOTE__158901);

com.wsscode.pathom3.connect.runner.merge_entity_to_root_data(env,env_SINGLEQUOTE__158901,node_158902);


var G__158905 = seq__158703_158893;
var G__158906 = chunk__158704_158894;
var G__158907 = count__158705_158895;
var G__158908 = (i__158706_158896 + (1));
seq__158703_158893 = G__158905;
chunk__158704_158894 = G__158906;
count__158705_158895 = G__158907;
i__158706_158896 = G__158908;
continue;
} else {
var temp__5753__auto___158909__$1 = cljs.core.seq(seq__158703_158893);
if(temp__5753__auto___158909__$1){
var seq__158703_158910__$1 = temp__5753__auto___158909__$1;
if(cljs.core.chunked_seq_QMARK_(seq__158703_158910__$1)){
var c__4649__auto___158911 = cljs.core.chunk_first(seq__158703_158910__$1);
var G__158912 = cljs.core.chunk_rest(seq__158703_158910__$1);
var G__158913 = c__4649__auto___158911;
var G__158914 = cljs.core.count(c__4649__auto___158911);
var G__158915 = (0);
seq__158703_158893 = G__158912;
chunk__158704_158894 = G__158913;
count__158705_158895 = G__158914;
i__158706_158896 = G__158915;
continue;
} else {
var vec__158719_158916 = cljs.core.first(seq__158703_158910__$1);
var map__158722_158917 = cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__158719_158916,(0),null);
var map__158722_158918__$1 = cljs.core.__destructure_map(map__158722_158917);
var batch_item_158919 = map__158722_158918__$1;
var env_SINGLEQUOTE__158920 = cljs.core.get.cljs$core$IFn$_invoke$arity$2(map__158722_158918__$1,new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","env","com.wsscode.pathom3.connect.runner/env",-1421599428));
var node_158921 = cljs.core.get.cljs$core$IFn$_invoke$arity$2(map__158722_158918__$1,new cljs.core.Keyword("com.wsscode.pathom3.connect.planner","node","com.wsscode.pathom3.connect.planner/node",325156565));
var node_resolver_input_158922 = cljs.core.get.cljs$core$IFn$_invoke$arity$2(map__158722_158918__$1,new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","node-resolver-input","com.wsscode.pathom3.connect.runner/node-resolver-input",-1558799633));
var response_158923 = cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__158719_158916,(1),null);
com.wsscode.pathom3.connect.runner.cache_batch_item(batch_item_158919,batch_op,response_158923);

com.wsscode.pathom3.connect.runner.merge_node_stats_BANG_(env_SINGLEQUOTE__158920,node_158921,cljs.core.merge.cljs$core$IFn$_invoke$arity$variadic(cljs.core.prim_seq.cljs$core$IFn$_invoke$arity$2([new cljs.core.PersistentArrayMap(null, 2, [new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","batch-run-start-ms","com.wsscode.pathom3.connect.runner/batch-run-start-ms",-1710202816),start_158888,new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","batch-run-finish-ms","com.wsscode.pathom3.connect.runner/batch-run-finish-ms",-1912626285),finish_158890], null),com.wsscode.pathom3.connect.runner.report_resolver_io_stats(env_SINGLEQUOTE__158920,node_resolver_input_158922,response_158923)], 0)));

com.wsscode.pathom3.connect.runner.merge_resolver_response_BANG_(env_SINGLEQUOTE__158920,response_158923);

com.wsscode.pathom3.connect.runner.merge_node_stats_BANG_(env_SINGLEQUOTE__158920,node_158921,new cljs.core.PersistentArrayMap(null, 1, [new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","node-run-finish-ms","com.wsscode.pathom3.connect.runner/node-run-finish-ms",1292429944),com.wsscode.misc.time.now_ms()], null));

com.wsscode.pathom3.connect.runner.run_root_node_BANG_(env_SINGLEQUOTE__158920);

com.wsscode.pathom3.connect.runner.merge_entity_to_root_data(env,env_SINGLEQUOTE__158920,node_158921);


var G__158928 = cljs.core.next(seq__158703_158910__$1);
var G__158929 = null;
var G__158930 = (0);
var G__158931 = (0);
seq__158703_158893 = G__158928;
chunk__158704_158894 = G__158929;
count__158705_158895 = G__158930;
i__158706_158896 = G__158931;
continue;
}
} else {
}
}
break;
}
}


var G__158932 = cljs.core.next(seq__158619__$1);
var G__158933 = null;
var G__158934 = (0);
var G__158935 = (0);
seq__158619 = G__158932;
chunk__158620 = G__158933;
count__158621 = G__158934;
i__158622 = G__158935;
continue;
}
} else {
return null;
}
}
break;
}
});
com.wsscode.pathom3.connect.runner.run_batches_waiting_BANG_ = (function com$wsscode$pathom3$connect$runner$run_batches_waiting_BANG_(env){
var waits_STAR_ = new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","batch-waiting*","com.wsscode.pathom3.connect.runner/batch-waiting*",-950834195).cljs$core$IFn$_invoke$arity$1(env);
var waits = cljs.core.deref(waits_STAR_);
cljs.core.vreset_BANG_(waits_STAR_,cljs.core.PersistentVector.EMPTY);

var seq__158723 = cljs.core.seq(waits);
var chunk__158724 = null;
var count__158725 = (0);
var i__158726 = (0);
while(true){
if((i__158726 < count__158725)){
var map__158729 = chunk__158724.cljs$core$IIndexed$_nth$arity$2(null,i__158726);
var map__158729__$1 = cljs.core.__destructure_map(map__158729);
var env_SINGLEQUOTE_ = cljs.core.get.cljs$core$IFn$_invoke$arity$2(map__158729__$1,new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","env","com.wsscode.pathom3.connect.runner/env",-1421599428));
com.wsscode.pathom3.entity_tree.reset_entity_BANG_(env_SINGLEQUOTE_,cljs.core.get_in.cljs$core$IFn$_invoke$arity$2(com.wsscode.pathom3.entity_tree.entity(env),new cljs.core.Keyword("com.wsscode.pathom3.path","path","com.wsscode.pathom3.path/path",1029673558).cljs$core$IFn$_invoke$arity$1(env_SINGLEQUOTE_)));

com.wsscode.pathom3.connect.runner.run_root_node_BANG_(env_SINGLEQUOTE_);

if(com.wsscode.pathom3.path.root_QMARK_(env_SINGLEQUOTE_)){
} else {
com.wsscode.pathom3.entity_tree.swap_entity_BANG_.cljs$core$IFn$_invoke$arity$4(env,cljs.core.assoc_in,new cljs.core.Keyword("com.wsscode.pathom3.path","path","com.wsscode.pathom3.path/path",1029673558).cljs$core$IFn$_invoke$arity$1(env_SINGLEQUOTE_),com.wsscode.pathom3.connect.runner.include_meta_stats(com.wsscode.pathom3.entity_tree.entity(env_SINGLEQUOTE_),env_SINGLEQUOTE_,new cljs.core.Keyword("com.wsscode.pathom3.connect.planner","graph","com.wsscode.pathom3.connect.planner/graph",-1915509744).cljs$core$IFn$_invoke$arity$1(env_SINGLEQUOTE_)));
}


var G__158939 = seq__158723;
var G__158940 = chunk__158724;
var G__158941 = count__158725;
var G__158942 = (i__158726 + (1));
seq__158723 = G__158939;
chunk__158724 = G__158940;
count__158725 = G__158941;
i__158726 = G__158942;
continue;
} else {
var temp__5753__auto__ = cljs.core.seq(seq__158723);
if(temp__5753__auto__){
var seq__158723__$1 = temp__5753__auto__;
if(cljs.core.chunked_seq_QMARK_(seq__158723__$1)){
var c__4649__auto__ = cljs.core.chunk_first(seq__158723__$1);
var G__158947 = cljs.core.chunk_rest(seq__158723__$1);
var G__158948 = c__4649__auto__;
var G__158949 = cljs.core.count(c__4649__auto__);
var G__158950 = (0);
seq__158723 = G__158947;
chunk__158724 = G__158948;
count__158725 = G__158949;
i__158726 = G__158950;
continue;
} else {
var map__158730 = cljs.core.first(seq__158723__$1);
var map__158730__$1 = cljs.core.__destructure_map(map__158730);
var env_SINGLEQUOTE_ = cljs.core.get.cljs$core$IFn$_invoke$arity$2(map__158730__$1,new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","env","com.wsscode.pathom3.connect.runner/env",-1421599428));
com.wsscode.pathom3.entity_tree.reset_entity_BANG_(env_SINGLEQUOTE_,cljs.core.get_in.cljs$core$IFn$_invoke$arity$2(com.wsscode.pathom3.entity_tree.entity(env),new cljs.core.Keyword("com.wsscode.pathom3.path","path","com.wsscode.pathom3.path/path",1029673558).cljs$core$IFn$_invoke$arity$1(env_SINGLEQUOTE_)));

com.wsscode.pathom3.connect.runner.run_root_node_BANG_(env_SINGLEQUOTE_);

if(com.wsscode.pathom3.path.root_QMARK_(env_SINGLEQUOTE_)){
} else {
com.wsscode.pathom3.entity_tree.swap_entity_BANG_.cljs$core$IFn$_invoke$arity$4(env,cljs.core.assoc_in,new cljs.core.Keyword("com.wsscode.pathom3.path","path","com.wsscode.pathom3.path/path",1029673558).cljs$core$IFn$_invoke$arity$1(env_SINGLEQUOTE_),com.wsscode.pathom3.connect.runner.include_meta_stats(com.wsscode.pathom3.entity_tree.entity(env_SINGLEQUOTE_),env_SINGLEQUOTE_,new cljs.core.Keyword("com.wsscode.pathom3.connect.planner","graph","com.wsscode.pathom3.connect.planner/graph",-1915509744).cljs$core$IFn$_invoke$arity$1(env_SINGLEQUOTE_)));
}


var G__158951 = cljs.core.next(seq__158723__$1);
var G__158952 = null;
var G__158953 = (0);
var G__158954 = (0);
seq__158723 = G__158951;
chunk__158724 = G__158952;
count__158725 = G__158953;
i__158726 = G__158954;
continue;
}
} else {
return null;
}
}
break;
}
});
com.wsscode.pathom3.connect.runner.run_batches_BANG_ = (function com$wsscode$pathom3$connect$runner$run_batches_BANG_(env){
com.wsscode.pathom3.connect.runner.run_batches_pending_BANG_(env);

return com.wsscode.pathom3.connect.runner.run_batches_waiting_BANG_(env);
});
com.wsscode.pathom3.connect.runner.setup_runner_env = (function com$wsscode$pathom3$connect$runner$setup_runner_env(env,entity_tree_STAR_,cache_type){
return cljs.core.assoc.cljs$core$IFn$_invoke$arity$variadic(com.wsscode.misc.coll.merge_defaults(env,new cljs.core.PersistentArrayMap(null, 5, [new cljs.core.Keyword("com.wsscode.pathom3.connect.planner","plan-cache*","com.wsscode.pathom3.connect.planner/plan-cache*",-982885642),(function (){var G__158731 = cljs.core.PersistentArrayMap.EMPTY;
return (cache_type.cljs$core$IFn$_invoke$arity$1 ? cache_type.cljs$core$IFn$_invoke$arity$1(G__158731) : cache_type.call(null,G__158731));
})(),new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","batch-pending*","com.wsscode.pathom3.connect.runner/batch-pending*",898520706),(function (){var G__158732 = cljs.core.PersistentArrayMap.EMPTY;
return (cache_type.cljs$core$IFn$_invoke$arity$1 ? cache_type.cljs$core$IFn$_invoke$arity$1(G__158732) : cache_type.call(null,G__158732));
})(),new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","batch-waiting*","com.wsscode.pathom3.connect.runner/batch-waiting*",-950834195),(function (){var G__158733 = cljs.core.PersistentVector.EMPTY;
return (cache_type.cljs$core$IFn$_invoke$arity$1 ? cache_type.cljs$core$IFn$_invoke$arity$1(G__158733) : cache_type.call(null,G__158733));
})(),new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","resolver-cache*","com.wsscode.pathom3.connect.runner/resolver-cache*",334664084),(function (){var G__158734 = cljs.core.PersistentArrayMap.EMPTY;
return (cache_type.cljs$core$IFn$_invoke$arity$1 ? cache_type.cljs$core$IFn$_invoke$arity$1(G__158734) : cache_type.call(null,G__158734));
})(),new cljs.core.Keyword("com.wsscode.pathom3.path","path","com.wsscode.pathom3.path/path",1029673558),cljs.core.PersistentVector.EMPTY], null)),new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","graph-run-start-ms","com.wsscode.pathom3.connect.runner/graph-run-start-ms",-954308936),com.wsscode.misc.time.now_ms(),cljs.core.prim_seq.cljs$core$IFn$_invoke$arity$2([new cljs.core.Keyword("com.wsscode.pathom3.entity-tree","entity-tree*","com.wsscode.pathom3.entity-tree/entity-tree*",1259415691),entity_tree_STAR_,new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","node-run-stats*","com.wsscode.pathom3.connect.runner/node-run-stats*",453579030),(function (){var G__158735 = cljs.core.with_meta(cljs.core.PersistentArrayMap.EMPTY,new cljs.core.PersistentArrayMap(null, 1, [new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","map-container?","com.wsscode.pathom3.connect.runner/map-container?",905687545),true], null));
return (cache_type.cljs$core$IFn$_invoke$arity$1 ? cache_type.cljs$core$IFn$_invoke$arity$1(G__158735) : cache_type.call(null,G__158735));
})()], 0));
});
com.wsscode.pathom3.connect.runner.run_graph_impl_BANG_ = (function com$wsscode$pathom3$connect$runner$run_graph_impl_BANG_(env,ast_or_graph,entity_tree_STAR_){
var env__$1 = com.wsscode.pathom3.connect.runner.setup_runner_env(env,entity_tree_STAR_,cljs.core.volatile_BANG_);
var plan = com.wsscode.pathom3.connect.runner.plan_and_run_BANG_(env__$1,ast_or_graph,entity_tree_STAR_);
if(com.wsscode.pathom3.path.root_QMARK_(env__$1)){
while(true){
if(cljs.core.seq(cljs.core.deref(new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","batch-pending*","com.wsscode.pathom3.connect.runner/batch-pending*",898520706).cljs$core$IFn$_invoke$arity$1(env__$1)))){
com.wsscode.pathom3.connect.runner.run_batches_BANG_(env__$1);

continue;
} else {
}
break;
}
} else {
}

return com.wsscode.pathom3.connect.runner.include_meta_stats(com.wsscode.pathom3.entity_tree.entity(env__$1),env__$1,plan);
});
com.wsscode.pathom3.connect.runner.run_graph_with_plugins = (function com$wsscode$pathom3$connect$runner$run_graph_with_plugins(env,ast_or_graph,entity_tree_STAR_,impl_BANG_){
if(com.wsscode.pathom3.path.root_QMARK_(env)){
return com.wsscode.pathom3.plugin.run_with_plugins.cljs$core$IFn$_invoke$arity$6(env,new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","wrap-root-run-graph!","com.wsscode.pathom3.connect.runner/wrap-root-run-graph!",893721083),(function (e,a,t){
return com.wsscode.pathom3.plugin.run_with_plugins.cljs$core$IFn$_invoke$arity$6(env,new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","wrap-run-graph!","com.wsscode.pathom3.connect.runner/wrap-run-graph!",-170975775),impl_BANG_,e,a,t);
}),env,ast_or_graph,entity_tree_STAR_);
} else {
return com.wsscode.pathom3.plugin.run_with_plugins.cljs$core$IFn$_invoke$arity$6(env,new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","wrap-run-graph!","com.wsscode.pathom3.connect.runner/wrap-run-graph!",-170975775),impl_BANG_,env,ast_or_graph,entity_tree_STAR_);
}
});
/**
 * Plan and execute a request, given an environment (with indexes), the request AST
 *   and the entity-tree*.
 */
com.wsscode.pathom3.connect.runner.run_graph_BANG_ = (function com$wsscode$pathom3$connect$runner$run_graph_BANG_(env,ast_or_graph,entity_tree_STAR_){
return com.wsscode.pathom3.connect.runner.run_graph_with_plugins(env,ast_or_graph,entity_tree_STAR_,com.wsscode.pathom3.connect.runner.run_graph_impl_BANG_);
});
com.wsscode.pathom3.connect.runner.with_resolver_cache = (function com$wsscode$pathom3$connect$runner$with_resolver_cache(var_args){
var G__158737 = arguments.length;
switch (G__158737) {
case 1:
return com.wsscode.pathom3.connect.runner.with_resolver_cache.cljs$core$IFn$_invoke$arity$1((arguments[(0)]));

break;
case 2:
return com.wsscode.pathom3.connect.runner.with_resolver_cache.cljs$core$IFn$_invoke$arity$2((arguments[(0)]),(arguments[(1)]));

break;
default:
throw (new Error(["Invalid arity: ",cljs.core.str.cljs$core$IFn$_invoke$arity$1(arguments.length)].join('')));

}
});

(com.wsscode.pathom3.connect.runner.with_resolver_cache.cljs$core$IFn$_invoke$arity$1 = (function (env){
return com.wsscode.pathom3.connect.runner.with_resolver_cache.cljs$core$IFn$_invoke$arity$2(env,cljs.core.atom.cljs$core$IFn$_invoke$arity$1(cljs.core.PersistentArrayMap.EMPTY));
}));

(com.wsscode.pathom3.connect.runner.with_resolver_cache.cljs$core$IFn$_invoke$arity$2 = (function (env,cache_STAR_){
return cljs.core.assoc.cljs$core$IFn$_invoke$arity$3(env,new cljs.core.Keyword("com.wsscode.pathom3.connect.runner","resolver-cache*","com.wsscode.pathom3.connect.runner/resolver-cache*",334664084),cache_STAR_);
}));

(com.wsscode.pathom3.connect.runner.with_resolver_cache.cljs$lang$maxFixedArity = 2);


//# sourceMappingURL=com.wsscode.pathom3.connect.runner.js.map
